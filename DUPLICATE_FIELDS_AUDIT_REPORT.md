# –ê—É–¥–∏—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø–æ–ª–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö UniFarm
**–î–∞—Ç–∞**: 02.08.2025  
**–ê—É–¥–∏—Ç–æ—Ä**: System Analyst  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–¥–∞

## üìä –†–µ–∑—é–º–µ
–ü—Ä–æ–≤–µ–¥–µ–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞—É–¥–∏—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø–æ–ª–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ê–Ω–∞–ª–∏–∑ –≤—ã—è–≤–∏–ª:
- **103 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –≤ —Å–∏—Å—Ç–µ–º–µ
- **6 –ø–∞—Ä –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø–æ–ª–µ–π** —Å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏ –≤ –¥–∞–Ω–Ω—ã—Ö
- **–í—Å–µ –ø–æ–ª—è –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** –≤ –∫–æ–¥–µ (–æ—Ç 23 –¥–æ 644 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—è** –±–µ–∑ –º–∞—Å—à—Ç–∞–±–Ω–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

## üîç –≠—Ç–∞–ø 1: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ 191-303)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è:

| –î—É–±–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª—è | –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è | –ü—Ä–∏–º–µ—Ä—ã |
|------------------|-------------|---------|
| `balance_uni` vs `uni_farming_balance` | **50 –∏–∑ 87** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | User 191: balance_uni=31411.09, uni_farming_balance=0 |
| `balance_ton` vs `ton_farming_balance` | **36 –∏–∑ 87** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | User 191: balance_ton=0.21, ton_farming_balance=5.15 |
| `uni_deposit_amount` vs `uni_farming_deposit` | **0 –∏–∑ 87** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã |
| `ton_boost_package` vs `ton_boost_package_id` | **87 –∏–∑ 87** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | User 192: package=1, package_id=1 |
| `ton_farming_rate` vs `ton_boost_rate` | **86 –∏–∑ 87** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | User 191: farming_rate=0.001, boost_rate=0.01 |

### –°—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `uni_farming_data`: 42 –∑–∞–ø–∏—Å–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- `ton_farming_data`: 34 –∑–∞–ø–∏—Å–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- `userBalances`: –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

## üîå –≠—Ç–∞–ø 2: –ê—É–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

### –ê–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:

| –ü–æ–ª–µ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|------|----------------|-------------|
| `balance_uni` | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥—É–ª–µ–π –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ | ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û |
| `balance_ton` | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥—É–ª–µ–π –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ | ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û |
| `uni_deposit_amount` | –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ | ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ |
| `uni_farming_deposit` | UniFarmingRepository, user/service | ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û |
| `ton_boost_package` | user/controller, referral/service, boost/service | ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û |
| `ton_farming_balance` | tonFarming/model | ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ |

### –ü–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–æ–ª—å–∫–æ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö –∞—É–¥–∏—Ç–∞:
- `uni_farming_balance` - —Ç–æ–ª—å–∫–æ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö system-audit-*.ts
- –¢–∞–±–ª–∏—Ü—ã `uni_farming_data`, `ton_farming_data` - –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö –º–∏–≥—Ä–∞—Ü–∏–∏

## üîÅ –≠—Ç–∞–ø 3: –ü–ª–∞–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–°–†–û–ß–ù–û)
1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è:**
   ```sql
   -- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è balance_uni —Å uni_farming_balance
   UPDATE users SET uni_farming_balance = balance_uni 
   WHERE id BETWEEN 191 AND 303;
   
   -- –ù–ï –¢–†–û–ì–ê–¢–¨ ton_farming_balance - —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏
   ```

2. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å TON boost –ø–æ–ª—è:**
   ```sql
   -- –ó–∞–ø–æ–ª–Ω–∏—Ç—å ton_boost_package_id —Ç–∞–º –≥–¥–µ –µ—Å—Ç—å ton_boost_package
   UPDATE users SET ton_boost_package_id = ton_boost_package 
   WHERE ton_boost_package > 0 AND ton_boost_package_id IS NULL;
   ```

### –§–∞–∑–∞ 2: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞ (2-3 –Ω–µ–¥–µ–ª–∏)
1. **–ó–∞–º–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–æ–ª–µ–π:**
   - `ton_boost_package` ‚Üí `ton_boost_package_id` –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
   - `uni_farming_balance` ‚Üí `balance_uni` (–ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
   
2. **–°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:**
   ```typescript
   // –í types/user.ts –¥–æ–±–∞–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
   get ton_boost_package() { return this.ton_boost_package_id; }
   ```

### –§–∞–∑–∞ 3: –£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–µ–π (—á–µ—Ä–µ–∑ 1 –º–µ—Å—è—Ü)
–ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–¥–∞–ª–∏—Ç—å:
- `uni_farming_balance` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ)
- `ton_boost_package` (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ ton_boost_package_id)
- –¢–∞–±–ª–∏—Ü—ã `uni_farming_data`, `ton_farming_data` (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö)

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

1. **–ù–ï –£–î–ê–õ–Ø–¢–¨ –ø–æ–ª—è —Å—Ä–∞–∑—É** - –º–Ω–æ–≥–∏–µ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ production
2. **ton_farming_balance vs balance_ton** - –≤–æ–∑–º–æ–∂–Ω–æ –∏–º–µ—é—Ç —Ä–∞–∑–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ (—Ñ–∞—Ä–º–∏–Ω–≥ vs –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å)
3. **uni_farming_deposit** - –∫—Ä–∏—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UniFarmingRepository
4. **–°—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã** —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö
2. **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ**: –ù–∞—á–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞
3. **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –≤ schedulers

## üõ°Ô∏è –ü—Ä–∏–Ω—Ü–∏–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
> "–õ—É—á—à–µ –∏–º–µ—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —á–µ–º –ø–æ—Ç–µ—Ä—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ"

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–æ–¥–∏—Ç—å—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

## üìã –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ü—É—Å—Ç—ã–µ –ø–æ–ª—è (–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ!):
| –ü–æ–ª–µ | –°—Ç–∞—Ç—É—Å –¥–∞–Ω–Ω—ã—Ö | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π –≤ –∫–æ–¥–µ | –†–µ—à–µ–Ω–∏–µ |
|------|---------------|---------------------|---------|
| `uni_farming_balance` | –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è = 0 | 93 | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å balance_uni |
| `wallet` | –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö | 543 | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å ton_wallet_address |

### –ü–æ–ª—è —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç—Ä–µ–±—É—é—â–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
| –ü–æ–ª—è | –ò–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö | –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π |
|------|------------|-------------|---------------|
| balance_uni ‚Üî uni_farming_balance | 38 | 65 | 489 vs 93 |
| balance_ton ‚Üî ton_farming_balance | 58 | 45 | 644 vs 142 |
| uni_deposit_amount ‚Üî uni_farming_deposit | 97 | 6 | 294 vs 23 |
| ton_boost_package ‚Üî ton_boost_package_id | 82 | 21 | 242 vs 53 |
| ton_farming_rate ‚Üî ton_boost_rate | 1 | 102 | 46 vs 85 |
| wallet ‚Üî ton_wallet_address | 82 | 21 | 543 vs 51 |

### –°—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `uni_farming_data`: 98 –∑–∞–ø–∏—Å–µ–π (–∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- `ton_farming_data`: 44 –∑–∞–ø–∏—Å–∏ (–∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- `userBalances`: 0 –∑–∞–ø–∏—Å–µ–π (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)

## ‚úÖ –ì–û–¢–û–í–û–ï –†–ï–®–ï–ù–ò–ï

### 1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Å–∫—Ä–∏–ø—Ç –≥–æ—Ç–æ–≤):
```bash
npx tsx scripts/synchronize-duplicate-fields.ts
```
–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç uni_deposit_amount ‚Üî uni_farming_deposit
- –ó–∞–ø–æ–ª–Ω–∏—Ç ton_boost_package_id –∏–∑ ton_boost_package
- –ó–∞–ø–æ–ª–Ω–∏—Ç –ø—É—Å—Ç—ã–µ uni_farming_balance –∏–∑ balance_uni  
- –ó–∞–ø–æ–ª–Ω–∏—Ç –ø—É—Å—Ç—ã–µ wallet –∏–∑ ton_wallet_address

### 2. –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:
- **–ù–ï –£–î–ê–õ–Ø–¢–¨** –Ω–∏–∫–∞–∫–∏–µ –ø–æ–ª—è - –≤—Å–µ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- **–°–ò–ù–•–†–û–ù–ò–ó–ò–†–û–í–ê–¢–¨** –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
- **–ú–û–ù–ò–¢–û–†–ò–¢–¨** —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ schedulers
- **–ü–û–°–¢–ï–ü–ï–ù–ù–û** —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### 3. –í–∞–∂–Ω—ã–µ –≤—ã–≤–æ–¥—ã:
- ‚ùå **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å "–ø—É—Å—Ç—ã–µ" –ø–æ–ª—è** - –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ
- ‚ö†Ô∏è **ton_farming_balance vs balance_ton** - —Ä–∞–∑–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ (—Ñ–∞—Ä–º–∏–Ω–≥ vs –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å)
- ‚úÖ **uni_deposit_amount –∏ uni_farming_deposit** - –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- ‚ö†Ô∏è **ton_farming_rate vs ton_boost_rate** - —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –Ω–µ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å!