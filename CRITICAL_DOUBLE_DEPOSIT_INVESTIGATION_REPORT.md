# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø TON BOOST –ü–ê–ö–ï–¢–û–í

## ‚ùå –û–ë–ù–ê–†–£–ñ–ï–ù–ê –î–í–û–ô–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –í –ö–û–î–ï

### **–ò–°–¢–û–ß–ù–ò–ö –ü–†–û–ë–õ–ï–ú–´**: `modules/boost/service.ts`

**–ú–µ—Ç–æ–¥ `purchaseWithInternalWallet()` —Å–æ–¥–µ—Ä–∂–∏—Ç –î–£–ë–õ–ò–†–û–í–ê–ù–ù–´–ô –∫–æ–¥:**

```typescript
// 1-–π –í–´–ó–û–í –Ω–∞ —Å—Ç—Ä–æ–∫–µ 402:
const uniBonusSuccess = await this.awardUniBonus(userId, boostPackage);

// 2-–π –í–´–ó–û–í –Ω–∞ —Å—Ç—Ä–æ–∫–µ 482:
const uniBonusAwarded = await this.awardUniBonus(userId, boostPackage);

// 3-–π –í–´–ó–û–í –Ω–∞ —Å—Ç—Ä–æ–∫–µ 826:
const uniBonusAwarded = await this.awardUniBonus(userId, boostPackage);
```

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø

### **–¢–†–û–ô–ù–û–ï –ù–ê–ß–ò–°–õ–ï–ù–ò–ï UNI –ë–û–ù–£–°–ê**:
1. **–ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 402): `await this.awardUniBonus(userId, boostPackage)`  
2. **–í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 482): `await this.awardUniBonus(userId, boostPackage)`
3. **–¢—Ä–µ—Ç–∏–π –≤—ã–∑–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 826): `await this.awardUniBonus(userId, boostPackage)`

### **–ö–ê–ñ–î–´–ô –í–´–ó–û–í `awardUniBonus()` –î–ï–õ–ê–ï–¢**:
```typescript
// –û–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ BalanceManager
await balanceManager.addBalance(parseInt(userId), boostPackage.uni_bonus, 0, 'BoostService.uni_bonus');

// –°–æ–∑–¥–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
await supabase.from('transactions').insert({
    user_id: parseInt(userId),
    type: 'DAILY_BONUS',
    amount: boostPackage.uni_bonus.toString(),
    currency: 'UNI',
    status: 'completed',
    description: `UNI –±–æ–Ω—É—Å –∑–∞ –ø–æ–∫—É–ø–∫—É TON Boost "${boostPackage.name}" (+${boostPackage.uni_bonus} UNI)`
});
```

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢ –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø

### **–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ 1 TON Boost –ø–∞–∫–µ—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç**:
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**: –°–ø–∏—Å—ã–≤–∞–µ—Ç 1 TON –∏–∑ –∫–æ—à–µ–ª—å–∫–∞
- ‚ùå **–û–®–ò–ë–ö–ê**: –ù–∞—á–∏—Å–ª—è–µ—Ç UNI –±–æ–Ω—É—Å **–¢–†–ò–ñ–î–´**
- ‚ùå **–û–®–ò–ë–ö–ê**: –°–æ–∑–¥–∞–µ—Ç **–¢–†–ò —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** DAILY_BONUS 
- ‚ùå **–û–®–ò–ë–ö–ê**: –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å UNI –Ω–∞ **–¢–†–û–ô–ù–£–Æ —Å—É–º–º—É**

### **–î–í–û–ô–ù–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø TON FARMING**:
```typescript
// –¢–∞–∫–∂–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:
// 1-–π –≤—ã–∑–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 413): tonFarmingRepo.activateBoost()
// –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –µ—â–µ –æ–¥–∏–Ω –≤—ã–∑–æ–≤ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ
```

## üìä –í–õ–ò–Ø–ù–ò–ï –ù–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø #184

### **–§–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 1 TON**:
- ‚úÖ –°–ø–∏—Å–∞–Ω–æ: 1 TON (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- ‚ùå –ù–∞—á–∏—Å–ª–µ–Ω–æ UNI: –¢–†–û–ô–ù–ê–Ø —Å—É–º–º–∞ –±–æ–Ω—É—Å–∞
- ‚ùå –°–æ–∑–¥–∞–Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: 3 √ó DAILY_BONUS
- ‚ùå –í TON Farming —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ: –¥–µ–ø–æ–∑–∏—Ç —É–≤–µ–ª–∏—á–µ–Ω –Ω–∞ 2 TON (–ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –≤ TonFarmingRepository)

## üîç –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### **–ù–ê–ö–û–ü–õ–ï–ù–ò–ï –î–ï–ü–û–ó–ò–¢–û–í –≤ TonFarmingRepository**:
```typescript
// –í TonFarmingRepository.activateBoost()
const currentBalance = parseFloat(existingRecord?.farming_balance) || 0;
const depositToAdd = depositAmount || 0;
newFarmingBalance = (currentBalance + depositToAdd).toString();
```
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –¥–≤–æ–π–Ω–æ–º –≤—ã–∑–æ–≤–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–µ–ø–æ–∑–∏—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è: 0 + 1 + 1 = 2 TON

## üö® –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨ –ü–†–û–ë–õ–ï–ú–´

- **–°–¢–ê–¢–£–°**: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê –í PRODUCTION
- **–ó–ê–¢–†–û–ù–£–¢–û**: –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∫—É–ø–∞—é—â–∏–µ TON Boost –ø–∞–∫–µ—Ç—ã
- **–ü–û–¢–ï–†–ò**: –î–≤–æ–π–Ω—ã–µ UNI –±–æ–Ω—É—Å—ã = —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ —Å–∏—Å—Ç–µ–º—ã
- **–û–ë–ù–ê–†–£–ñ–ï–ù–û**: User #184, –≤—Ä–µ–º—è –ø–æ–∫—É–ø–∫–∏ —Å–µ–≥–æ–¥–Ω—è

## üìã –ü–õ–ê–ù –≠–ö–°–¢–†–ï–ù–ù–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### **–ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø**:
1. **–£–î–ê–õ–ò–¢–¨** –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–∑–æ–≤ `awardUniBonus()` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 482
2. **–ü–†–û–í–ï–†–ò–¢–¨** –Ω–∞ –¥–≤–æ–π–Ω—ã–µ –≤—ã–∑–æ–≤—ã `activateBoost()`
3. **–î–û–ë–ê–í–ò–¢–¨** –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ `TonFarmingRepository`
4. **–ö–û–ú–ü–ï–ù–°–ò–†–û–í–ê–¢–¨** –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é #184

### **–î–û–õ–ì–û–°–†–û–ß–ù–´–ï –ú–ï–†–´**:
1. –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
2. –í–Ω–µ–¥—Ä–∏—Ç—å idempotency –∫–ª—é—á–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π

## ‚ö†Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**–ù–ï –í–ù–û–°–ò–¢–¨ –ò–ó–ú–ï–ù–ï–ù–ò–Ø** –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –ª–æ–≥–∏–∫—É —Å–∏—Å—Ç–µ–º—ã.

## üßæ DIAGNOSTIC SCRIPT –ì–û–¢–û–í

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `CRITICAL_TON_BOOST_DUPLICATION_DIAGNOSIS.js` –¥–ª—è production –∞–Ω–∞–ª–∏–∑–∞:
- –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π User #184 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ DAILY_BONUS —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤  
- –ü—Ä–æ–≤–µ—Ä–∫–∞ ton_farming_data –Ω–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –±–ª–∏–∑–∫–∏—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–ø—É—Å–∫**: `node CRITICAL_TON_BOOST_DUPLICATION_DIAGNOSIS.js`

**–í—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è**: 24.07.2025 13:45 MSK  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø - –ø–æ—Ç–µ—Ä–∏ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
**–°—Ç–∞—Ç—É—Å**: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê PRODUCTION –ì–û–¢–û–í–ê - –ö–û–î –ù–ï –ò–ó–ú–ï–ù–Ø–õ–°–Ø