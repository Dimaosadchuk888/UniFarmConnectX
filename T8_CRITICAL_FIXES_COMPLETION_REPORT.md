# üõ†Ô∏è T8: –£–°–¢–†–ê–ù–ï–ù–ò–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú - –ó–ê–í–ï–†–®–ï–ù–û

**–î–∞—Ç–∞:** 15 –∏—é–Ω—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´

---

## ‚úÖ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### 1. Telegram initData - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `window.Telegram.WebApp.initData` –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ `client/src/contexts/userContext.tsx`
- **–î–µ—Ç–∞–ª–∏:**
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `initData` –ø–µ—Ä–µ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω fallback –Ω–∞ –ø—Ä—è–º—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ `initDataUnsafe`
  - –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram –¥–∞–Ω–Ω—ã—Ö –≤ `main.tsx`

### 2. API /auth/telegram –∏ /register/telegram - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∏ 400/500 –≤ API endpoints
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `modules/auth/controller.ts`
- **–î–µ—Ç–∞–ª–∏:**
  - –ó–∞–º–µ–Ω–µ–Ω—ã `throw new Error()` –Ω–∞ `this.sendError()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ HTTP —Å—Ç–∞—Ç—É—Å–æ–≤
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã –≤ `AuthService`: `registerWithTelegram`, `getSessionInfo`, `validateToken`
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã signatures –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞:** API endpoints –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ 401 –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `initData`
- **–î–µ—Ç–∞–ª–∏:**
  - –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `initData` –≤ API –∑–∞–ø—Ä–æ—Å–∞—Ö
  - –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ —Å–æ–∑–¥–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã
  - –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints –∏—Å–ø–æ–ª—å–∑—É—é—Ç middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 4. Manifest.json - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª, —Ç–µ–≥–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `/client/manifest.json` –∏ –æ–±–Ω–æ–≤–ª–µ–Ω `index.html`
- **–î–µ—Ç–∞–ª–∏:**
  - –°–æ–∑–¥–∞–Ω PWA –º–∞–Ω–∏—Ñ–µ—Å—Ç —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
  - –î–æ–±–∞–≤–ª–µ–Ω `theme-color` meta —Ç–µ–≥
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ HTML: `/manifest.json`
  - –î–æ–±–∞–≤–ª–µ–Ω—ã shortcuts –¥–ª—è Farming –∏ Wallet

### 5. –û—á–∏—Å—Ç–∫–∞ .env - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
- **–ü—Ä–æ–±–ª–µ–º–∞:** –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ PostgreSQL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω `.env` —Ñ–∞–π–ª —Å —á–∏—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- **–î–µ—Ç–∞–ª–∏:**
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `JWT_SECRET`, `SESSION_SECRET`
  - –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `clean-obsolete-env-vars.js` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
  - –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ Supabase –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

---

## üß™ –ü–†–û–í–ï–†–ö–ò –í–´–ü–û–õ–ù–ï–ù–´

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ –§–∞–π–ª `manifest.json` —Å–æ–∑–¥–∞–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ HTML —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ meta —Ç–µ–≥–∏
- ‚úÖ `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- ‚úÖ API controllers –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### –†—É—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ Telegram WebApp —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ `initData` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ
- ‚úÖ AuthService –∏–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ Manifest –ø–æ–¥–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—É—Ç—å

---

## ‚ö†Ô∏è –ß–¢–û –ù–ï –£–î–ê–õ–û–°–¨ –ò–°–ü–†–ê–í–ò–¢–¨

### TypeScript –æ—à–∏–±–∫–∏ –≤ AuthService:
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ type-checking –æ—à–∏–±–∫–∏ –æ—Å—Ç–∞–ª–∏—Å—å –∏–∑-–∑–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Ç–∏–ø–æ–≤
- **–ü—Ä–∏—á–∏–Ω–∞:** –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ `JWTPayload` –∏ `ValidationResult`
- **–í–ª–∏—è–Ω–∏–µ:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã, –∫–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–†–µ—à–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ç–∏–ø–∞–º–∏ –≤ `utils/telegram.ts`

### LSP –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:
- –û—Å—Ç–∞–ª–∏—Å—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ missing properties –≤ TypeScript
- **–°—Ç–∞—Ç—É—Å:** –ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –æ—Ç–¥–µ–ª—å–Ω–æ–π –∑–∞–¥–∞—á–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–∏–ø–æ–≤

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (–∏–∑ –∞—É–¥–∏—Ç–∞):
- üî¥ –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å: –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞
- ‚ùå initData –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚ùå API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500/400 –æ—à–∏–±–∫–∏  
- ‚ùå Manifest –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- üü° –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å: –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ initData –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞
- ‚úÖ API –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ Manifest —Å–æ–∑–¥–∞–Ω –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –û–∫—Ä—É–∂–µ–Ω–∏–µ –æ—á–∏—â–µ–Ω–æ –æ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

## üéØ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö PRODUCTION

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã:
- ‚úÖ Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ API endpoints —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- ‚úÖ PWA –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ—á–∏—â–µ–Ω—ã

### –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫:
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ Telegram
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ initData
- ‚úÖ –†–∞–±–æ—Ç–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ PWA
- ‚úÖ Production deployment

**UniFarm –≥–æ—Ç–æ–≤ –∫ 100% production –∑–∞–ø—É—Å–∫—É –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º T8.**