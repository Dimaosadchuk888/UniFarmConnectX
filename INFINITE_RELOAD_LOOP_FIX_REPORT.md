# –û–¢–ß–ï–¢: –£–°–¢–†–ê–ù–ï–ù–ò–ï –ë–ï–°–ö–û–ù–ï–ß–ù–´–• –ü–ï–†–ï–ó–ê–ì–†–£–ó–û–ö TELEGRAM WEBAPP

## ‚úÖ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê –ü–û–õ–ù–û–°–¢–¨–Æ

**–î–∞—Ç–∞:** 18 –∏—é–ª—è 2025  
**–í—Ä–µ–º—è:** 12:03 UTC  
**–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –£–°–¢–†–ê–ù–ï–ù–ê  

---

## üîç –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê

### –ù–ê–ô–î–ï–ù–û 3 –ò–°–¢–û–ß–ù–ò–ö–ê –ë–ï–°–ö–û–ù–ï–ß–ù–´–• –ü–ï–†–ï–ó–ê–ì–†–£–ó–û–ö:

1. **correctApiRequest.ts —Å—Ç—Ä–æ–∫–∞ 122**
   ```typescript
   // –ë–´–õ–û:
   window.location.reload();
   
   // –°–¢–ê–õ–û: 
   const error = new Error('Authentication required');
   (error as any).status = 401;
   throw error;
   ```

2. **App.tsx —Å—Ç—Ä–æ–∫–∞ 167**  
   ```typescript
   // –ë–´–õ–û:
   window.location.reload(); // –ü–æ—Å–ª–µ Telegram auth
   
   // –°–¢–ê–õ–û:
   setState(prev => ({ 
     ...prev, 
     isLoading: false,
     isAuthenticated: true 
   }));
   ```

3. **App.tsx —Å—Ç—Ä–æ–∫–∞ 214**
   ```typescript
   // –ë–´–õ–û:
   window.location.reload(); // –ü–æ—Å–ª–µ Preview auth
   
   // –°–¢–ê–õ–û:
   setState(prev => ({ 
     ...prev, 
     isLoading: false,
     isAuthenticated: true 
   }));
   ```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –¶–ò–ö–õ –ü–ï–†–ï–ó–ê–ì–†–£–ó–û–ö

### –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –°–û–ë–´–¢–ò–ô:
1. JWT —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç/–∏—Å—Ç–µ–∫–∞–µ—Ç ‚Üí 401 –æ—à–∏–±–∫–∞
2. `correctApiRequest` –≤—ã–∑—ã–≤–∞–µ—Ç `window.location.reload()`
3. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚Üí App.tsx –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
4. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è ‚Üí —Å–Ω–æ–≤–∞ `window.location.reload()`
5. **–ë–ï–°–ö–û–ù–ï–ß–ù–´–ô –¶–ò–ö–õ!**

### –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–ê –ò–ó –õ–û–ì–û–í:
```
[correctApiRequest] –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç: {"ok":false,"status":401}
[correctApiRequest] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...
[UserContext] –¢–æ–∫–µ–Ω –∏–∑–º–µ–Ω–∏–ª—Å—è: {"was":"existed","now":"null"}
[App] Preview –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω
[App] –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...
```

---

## üõ†Ô∏è –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í–ù–ï–°–ï–ù–´

### 1. –£–°–¢–†–ê–ù–ï–ù–´ –í–°–ï –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ò:
‚úÖ `client/src/lib/correctApiRequest.ts` - —É–±—Ä–∞–Ω reload –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ  
‚úÖ `client/src/App.tsx` - —É–±—Ä–∞–Ω—ã 2 reload –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  
‚úÖ `client/src/components/telegram/ForceRefreshButton.tsx` - —É–±—Ä–∞–Ω fallback reload  
‚úÖ `client/src/modules/dashboard/components/CompleteDashboard.tsx` - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ href redirect  
‚úÖ `client/src/pages/Home.tsx` - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ href redirect  
‚úÖ `client/src/pages/Wallet.tsx` - —É–±—Ä–∞–Ω—ã –≤—Å–µ 4 reload –∏–∑ ErrorBoundary  

### 2. –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê:
```bash
grep -r "window.location.reload" client/src/ | wc -l
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 0 ‚ùå –ù–ò –û–î–ù–û–ô –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ò –ù–ï –û–°–¢–ê–õ–û–°–¨!
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ò–ó –õ–û–ì–û–í –í–ò–î–ù–û –°–¢–ê–ë–ò–õ–¨–ù–£–Æ –†–ê–ë–û–¢–£:
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫  
‚úÖ JWT —Ç–æ–∫–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è  
‚úÖ API –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ  
‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω—ã  
‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ UNI Farming –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è  

### –ü–û–°–õ–ï–î–ù–ò–ï –õ–û–ì–ò –ü–û–ö–ê–ó–´–í–ê–Æ–¢:
```
[correctApiRequest] –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç: {"success":true,"data":{...}}
[balanceService] –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –±–∞–ª–∞–Ω—Å–∞: {"uniBalance":5434.847785}
[WebSocket] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
[useWebSocketBalanceSync] –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
```

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –î–õ–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø:
1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram:**
   ```
   https://uni-farm-connect-aab49267.replit.app
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ù–ï–¢:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫
   - –û—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –ó–∞–≤–∏—Å–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

3. **–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ï–°–¢–¨:**
   - –°—Ç–∞–±–∏–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤
   - –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö:
- 401 –æ—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- ErrorBoundary –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç –æ—à–∏–±–∫–∏ –≤–º–µ—Å—Ç–æ reload
- –ö–Ω–æ–ø–∫–∏ "–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É" –∏—Å–ø–æ–ª—å–∑—É—é—Ç href redirect

### –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø:
- –°–æ—Å—Ç–æ—è–Ω–∏–µ App.tsx –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- JWT —Ç–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –±–µ–∑ reload —Ü–∏–∫–ª–æ–≤
- Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –ü–†–û–ë–õ–ï–ú–ê –ë–´–õ–ê –í:
- **–ü–∞—Ç—Ç–µ—Ä–Ω "reload-on-error"** —Å–æ–∑–¥–∞–≤–∞–ª —Ü–∏–∫–ª—ã
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏** —É—Å–∏–ª–∏–≤–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—É
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ graceful error handling** –ø—Ä–∏ 401 –æ—à–∏–±–∫–∞—Ö

### –†–ï–®–ï–ù–ò–ï –°–û–°–¢–û–ò–¢ –í:
- **Graceful error throwing** –≤–º–µ—Å—Ç–æ reload
- **State updates** –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–∞–Ω–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫
- **Proper error boundaries** —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ë–ï–°–ö–û–ù–ï–ß–ù–´–ï –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ò TELEGRAM WEBAPP –ü–û–õ–ù–û–°–¢–¨–Æ –£–°–¢–†–ê–ù–ï–ù–´**

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ reload —Ü–∏–∫–ª–æ–≤ –Ω–∞–π–¥–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤ Telegram!**