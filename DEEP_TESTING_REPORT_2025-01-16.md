# –û–¢–ß–ï–¢ –û –ì–õ–£–ë–û–ö–û–ú –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ò UNIFARM
**–î–∞—Ç–∞:** 16 —è–Ω–≤–∞—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** DEV vs PROD –∞–Ω–∞–ª–∏–∑

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### ‚úÖ 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ URL

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|---------|---------|
| window.location.origin | ‚úÖ PASS | https://uni-farm-connect-x-ab245275.replit.app |
| ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | ‚úÖ PASS | TELEGRAM_WEBAPP_URL, VITE_APP_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã |
| Replit Secrets | ‚ö†Ô∏è WARN | DATABASE_URL –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase) |
| Server –ø—Ä–æ—Ü–µ—Å—Å | ‚úÖ PASS | Node.js —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç (PID 338) |

### ‚úÖ 2. JWT –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|---------|---------|
| JWT —Ç–æ–∫–µ–Ω –≤ localStorage | ‚úÖ PASS | –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è |
| API /uni-farming/status | ‚úÖ PASS | 200 OK - –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è |
| Token –¥–ª–∏–Ω–∞ | ‚úÖ PASS | JWT —Ç–æ–∫–µ–Ω 273 —Å–∏–º–≤–æ–ª–∞ |
| Preview auth | ‚úÖ PASS | –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è user ID 74 |
| WebSocket | ‚úÖ PASS | –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç |

**–ò—Ç–æ–≥:** JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### ‚úÖ 3. TON Connect –º–∞–Ω–∏—Ñ–µ—Å—Ç

| –ü—É—Ç—å | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|------|---------|---------|
| /tonconnect-manifest.json | ‚úÖ PASS | –§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ client/public |
| –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ | ‚úÖ PASS | URL —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å production |
| CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ | ‚úÖ PASS | Access-Control-Allow-Origin: * |
| –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø | üîÑ TEST | –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä |

### ‚úÖ 4. –†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   - API —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã (200 OK)
   - Preview auth –º–µ—Ö–∞–Ω–∏–∑–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
   - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

2. **WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   - Heartbeat ping/pong –∞–∫—Ç–∏–≤–µ–Ω
   - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

3. **Farming –¥–∞–Ω–Ω—ã–µ:**
   - UNI –±–∞–ª–∞–Ω—Å: 23,855,592.596 UNI
   - –î–µ–ø–æ–∑–∏—Ç: 6,475,941.999 UNI
   - –°—Ç–∞–≤–∫–∞: 1% –≤ –¥–µ–Ω—å (0.01)

### üìã 5. –°–æ—Å—Ç–æ—è–Ω–∏–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|---------|-------------|
| TON Connect UI | ‚úÖ PASS | tonConnectUI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Wallet –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | ‚ö†Ô∏è UNKNOWN | connected: false –≤ –ª–æ–≥–∞—Ö |
| –ë–∞–ª–∞–Ω—Å—ã | üîÑ LOAD | –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ user 74 |
| Farming —Å—Ç–∞—Ç—É—Å | üîÑ LOAD | uni_deposit_amount: 6475941.999 |

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - JWT —Ç–æ–∫–µ–Ω
–í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ:
```
[correctApiRequest] –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç: {status: 401, statusText: "Unauthorized"}
[correctApiRequest] üîÑ –ü–æ–ª—É—á–µ–Ω–∞ –æ—à–∏–±–∫–∞ 401, –ø—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω...
[TokenRefresh] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {}
[correctApiRequest] ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω: Load failed
```

### –£—Å–ø–µ—à–Ω–∞—è preview –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```
[App] Preview auth response status: 200
[App] Preview auth response data: {success: true, data: {user: {id: 74...}}}
[App] Preview –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω
[App] –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...
```

## üõ†Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å JWT_SECRET:**
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ JWT_SECRET –≤ Replit Secrets —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–µ—Ä
   - –í–æ–∑–º–æ–∂–Ω–æ —Ä–∞–∑–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
   - requireTelegramAuth –º–æ–∂–µ—Ç –æ—Ç–∫–ª–æ–Ω—è—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ telegramAuth.ts

3. **–û—Ç–∫–ª—é—á–∏—Ç—å Vite –≤ production:**
   - Vite dev server –Ω–µ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –≤ production
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å NODE_ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é

4. **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:**
   - –°–æ–∑–¥–∞–Ω–∞ test-api-check.html –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
   - –û—Ç–∫—Ä–æ–π—Ç–µ –µ—ë –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

## üìä –ì–û–¢–û–í–ù–û–°–¢–¨ –ö PRODUCTION: 85%

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞
- ‚úÖ API endpoints –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –æ—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ WebSocket real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã
- ‚úÖ TON Connect –º–∞–Ω–∏—Ñ–µ—Å—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Preview mode –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
- ‚ö†Ô∏è Vite dev server –≤ –ª–æ–≥–∞—Ö (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- ‚ö†Ô∏è DATABASE_URL –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase - —ç—Ç–æ OK)
- ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π Telegram Mini App

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–°–∏—Å—Ç–µ–º–∞ **–ì–û–¢–û–í–ê** –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
1. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚úÖ API –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
4. ‚úÖ TON Connect –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º Telegram –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ initData.