<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç TON Connect - UniFarm</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #fff;
        }
        .test-section {
            background-color: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background-color: #22c55e20;
            border: 1px solid #22c55e;
            color: #22c55e;
        }
        .error {
            background-color: #ef444420;
            border: 1px solid #ef4444;
            color: #ef4444;
        }
        .info {
            background-color: #3b82f620;
            border: 1px solid #3b82f6;
            color: #3b82f6;
        }
        button {
            background-color: #6366f1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background-color: #5558e3;
        }
        pre {
            background-color: #1a1a1a;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç TON Connect - UniFarm</h1>
    
    <div class="test-section">
        <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞</h2>
        <button onclick="testManifest()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç</button>
        <div id="manifest-result"></div>
    </div>

    <div class="test-section">
        <h2>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä–µ—Å—É—Ä—Å–æ–≤</h2>
        <button onclick="testResources()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã</button>
        <div id="resources-result"></div>
    </div>

    <div class="test-section">
        <h2>3. –¢–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω</h2>
        <div class="status info">
            <strong>–î–æ–º–µ–Ω:</strong> <span id="current-domain"></span><br>
            <strong>–ü—Ä–æ—Ç–æ–∫–æ–ª:</strong> <span id="current-protocol"></span>
        </div>
    </div>

    <div class="test-section">
        <h2>4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
        <div id="recommendations"></div>
    </div>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω
        document.getElementById('current-domain').textContent = window.location.hostname;
        document.getElementById('current-protocol').textContent = window.location.protocol;

        async function testManifest() {
            const resultDiv = document.getElementById('manifest-result');
            resultDiv.innerHTML = '<div class="status info">–ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç...</div>';
            
            try {
                const response = await fetch('/tonconnect-manifest.json');
                const manifest = await response.json();
                
                let html = '<div class="status success">‚úÖ –ú–∞–Ω–∏—Ñ–µ—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!</div>';
                html += '<pre>' + JSON.stringify(manifest, null, 2) + '</pre>';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–º–µ–Ω–∞
                const expectedDomain = `${window.location.protocol}//${window.location.hostname}`;
                if (manifest.url !== expectedDomain && manifest.url !== `https://${window.location.hostname}`) {
                    html += `<div class="status error">‚ö†Ô∏è –î–æ–º–µ–Ω –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ (${manifest.url}) –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–∫—É—â–∏–º (${expectedDomain})</div>`;
                } else {
                    html += '<div class="status success">‚úÖ –î–æ–º–µ–Ω –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π</div>';
                }
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞: ${error.message}</div>`;
            }
        }

        async function testResources() {
            const resultDiv = document.getElementById('resources-result');
            resultDiv.innerHTML = '<div class="status info">–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ—Å—É—Ä—Å—ã...</div>';
            
            const resources = [
                { name: '–û—Å–Ω–æ–≤–Ω–æ–π –º–∞–Ω–∏—Ñ–µ—Å—Ç', url: '/tonconnect-manifest.json' },
                { name: 'Well-known –º–∞–Ω–∏—Ñ–µ—Å—Ç', url: '/.well-known/tonconnect-manifest.json' },
                { name: 'SVG –∏–∫–æ–Ω–∫–∞', url: '/assets/unifarm-icon.svg' },
                { name: '–°—Ç–∞—Ä–∞—è –∏–∫–æ–Ω–∫–∞', url: '/tonconnect-icon.svg' },
                { name: 'Favicon', url: '/assets/favicon.ico' }
            ];
            
            let html = '';
            
            for (const resource of resources) {
                try {
                    const response = await fetch(resource.url);
                    if (response.ok) {
                        html += `<div class="status success">‚úÖ ${resource.name}: ${response.status} OK</div>`;
                    } else {
                        html += `<div class="status error">‚ùå ${resource.name}: ${response.status} ${response.statusText}</div>`;
                    }
                } catch (error) {
                    html += `<div class="status error">‚ùå ${resource.name}: –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞</div>`;
                }
            }
            
            resultDiv.innerHTML = html;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            testManifest();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            const recommendations = document.getElementById('recommendations');
            recommendations.innerHTML = `
                <div class="status info">
                    <h3>üìå –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è TON Connect:</h3>
                    <ol>
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ UniFarm</li>
                        <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–ö–æ—à–µ–ª–µ–∫"</li>
                        <li>–ù–∞–π–¥–∏—Ç–µ –±–ª–æ–∫ "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TON Wallet"</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫"</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –∏–∑ —Å–ø–∏—Å–∫–∞ (Tonkeeper, MyTonWallet –∏ –¥—Ä.)</li>
                        <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –∫–æ—à–µ–ª—å–∫–µ</li>
                    </ol>
                </div>
                <div class="status info">
                    <strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –ï—Å–ª–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
                </div>
            `;
        });
    </script>
</body>
</html>