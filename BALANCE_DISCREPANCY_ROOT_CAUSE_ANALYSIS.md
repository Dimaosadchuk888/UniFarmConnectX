# üîç –ê–ù–ê–õ–ò–ó –ü–†–ò–ß–ò–ù –†–ê–°–•–û–ñ–î–ï–ù–ò–ô –ë–ê–õ–ê–ù–°–û–í –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ö–û–î–ê

## üìä –û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –†–ê–°–•–û–ñ–î–ï–ù–ò–Ø –£ USER 25:

### UNI –ë–∞–ª–∞–Ω—Å:
- **–í —Ç–∞–±–ª–∏—Ü–µ users:** 75,924,566 UNI
- **–ü–æ —Å—É–º–º–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:** 29,477 UNI  
- **–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ:** 75,895,089 UNI (99.96% —Ä–∞–∑–Ω–∏—Ü–∞!)

### TON –ë–∞–ª–∞–Ω—Å:
- **–í —Ç–∞–±–ª–∏—Ü–µ users:** 0.058139 TON
- **–ü–æ —Å—É–º–º–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:** 0.005663 TON
- **–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ:** 0.052476 TON (92.7% —Ä–∞–∑–Ω–∏—Ü–∞!)

---

## üéØ –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´ –†–ê–°–•–û–ñ–î–ï–ù–ò–ô:

### 1. **–ü—Ä—è–º—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã users**
- –ö–∞–∫–æ–π-—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç `users.balance_uni/balance_ton` –Ω–∞–ø—Ä—è–º—É—é
- –ú–∏–Ω—É—è —Å–∏—Å—Ç–µ–º—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –í–æ–∑–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ admin panel, scheduler, –∏–ª–∏ migration

### 2. **–°—Ç–∞—Ä—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è**
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–≥–ª–∏ –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã –∏–∑ –±–∞–∑—ã
- –ò–ª–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –¥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 3. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å–∏—Å—Ç–µ–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞**
- –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –î—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –Ω–∏–º–∏

### 4. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–∞—Ç—á–∏–Ω–≥**
- –ë–∞–ª–∞–Ω—Å—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –±–∞—Ç—á–∞–º–∏ –∏–∑ –∫–µ—à–∞
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–∏—à—É—Ç—Å—è –ø–æ –æ–¥–Ω–æ–π
- –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–µ—à–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### 5. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö**
- –ë—ã–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–æ–≤–∏–ª–∏ –±–∞–ª–∞–Ω—Å—ã
- –ù–æ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

---

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–´–ï –†–ï–®–ï–ù–ò–Ø –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ö–û–î–ê:

### –í–ê–†–ò–ê–ù–¢ 1: DATABASE RECONCILIATION SCRIPT
```sql
-- –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –±–∞–ª–∞–Ω—Å–∞–º–∏
CREATE TEMP TABLE correct_balances AS 
SELECT 
    user_id,
    SUM(CASE WHEN currency = 'UNI' THEN amount ELSE 0 END) as correct_uni_balance,
    SUM(CASE WHEN currency = 'TON' THEN amount ELSE 0 END) as correct_ton_balance
FROM transactions 
WHERE status = 'completed'
GROUP BY user_id;

-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è (–ù–ï –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∫–∞)
SELECT 
    u.id,
    u.balance_uni as current_uni,
    c.correct_uni_balance,
    (u.balance_uni - c.correct_uni_balance) as uni_diff,
    u.balance_ton as current_ton,
    c.correct_ton_balance,
    (u.balance_ton - c.correct_ton_balance) as ton_diff
FROM users u
JOIN correct_balances c ON u.id::text = c.user_id
WHERE 
    ABS(u.balance_uni - c.correct_uni_balance) > 0.01 
    OR ABS(u.balance_ton - c.correct_ton_balance) > 0.000001
ORDER BY ABS(u.balance_uni - c.correct_uni_balance) DESC;
```

### –í–ê–†–ò–ê–ù–¢ 2: –ü–û–≠–¢–ê–ü–ù–ê–Ø –ö–û–†–†–ï–ö–¶–ò–Ø
1. **–°–Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã**
   - –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ
   - –ö–∞–∫–∏–µ —Å—É–º–º—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
   - –í –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è (–ø–ª—é—Å/–º–∏–Ω—É—Å)

2. **–°–æ–∑–¥–∞–µ–º backup –±–∞–ª–∞–Ω—Å–æ–≤**
   ```sql
   CREATE TABLE users_balance_backup_2025_07_27 AS 
   SELECT id, balance_uni, balance_ton, created_at 
   FROM users;
   ```

3. **–¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ –æ–¥–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ**
   - –ù–∞–ø—Ä–∏–º–µ—Ä –Ω–∞ User 25
   - –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –µ–≥–æ –±–∞–ª–∞–Ω—Å –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –í–ê–†–ò–ê–ù–¢ 3: –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –ü–û–°–¢–ï–ü–ï–ù–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï
1. **–î–æ–±–∞–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π**
   ```sql
   CREATE TABLE balance_discrepancies (
       id SERIAL PRIMARY KEY,
       user_id TEXT,
       currency TEXT,
       db_balance DECIMAL,
       calculated_balance DECIMAL,
       difference DECIMAL,
       detected_at TIMESTAMP DEFAULT NOW()
   );
   ```

2. **–°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç**
   - –ù–∞—Ö–æ–¥–∏—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è > –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –õ–æ–≥–∏—Ä—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–ª–µ—Ä—Ç—ã –≤ Telegram

3. **–ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º**
   - –°–Ω–∞—á–∞–ª–∞ —Å–∞–º—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ (–±–æ–ª—å—à–∏–µ —Å—É–º–º—ã)
   - –ü–æ—Ç–æ–º –º–µ–Ω–µ–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ
   - –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ—Å—Å

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –í–û–ü–†–û–°–´ –î–õ–Ø –í–´–Ø–°–ù–ï–ù–ò–Ø:

### 1. **–û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –æ–≥—Ä–æ–º–Ω—ã–µ –±–∞–ª–∞–Ω—Å—ã?**
- User 25 –∏–º–µ–µ—Ç 75+ –º–ª–Ω UNI
- –ù–æ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö —Ç–æ–ª—å–∫–æ 29–ö UNI
- –ì–¥–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 75 –º–ª–Ω?

### 2. **–ï—Å—Ç—å –ª–∏ –¥—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –±–∞–ª–∞–Ω—Å–∞–º–∏?**
- `wallet_balances`
- `user_balances` 
- `farming_balances`
- –ö–∞–∫–∏–µ-—Ç–æ —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã?

### 3. **–ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ–±–Ω–æ–≤–ª—è—é—Ç –±–∞–ª–∞–Ω—Å—ã?**
- Schedulers (farming, boost, referral)
- Admin operations
- Migration scripts
- WebSocket handlers

### 4. **–ï—Å—Ç—å –ª–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤?**
- Redis cache
- In-memory cache
- Database views
- Materialized views

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô:

### –≠–¢–ê–ü 1: –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï (–ë–ï–ó–û–ü–ê–°–ù–û)
1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–ù–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–≥—Ä–æ–º–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–æ–≤** —É User 25
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã** —Å –±–∞–ª–∞–Ω—Å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. **–ò–∑—É—á–∏—Ç—å –ª–æ–≥–∏** –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–∞–ª–∞–Ω—Å–æ–≤

### –≠–¢–ê–ü 2: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (–ù–ê –û–î–ù–û–ú –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï)
1. **–°–æ–∑–¥–∞—Ç—å backup** —Ç–µ–∫—É—â–∏—Ö –±–∞–ª–∞–Ω—Å–æ–≤
2. **–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –±–∞–ª–∞–Ω—Å User 25** –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
3. **–û–±–Ω–æ–≤–∏—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** 24 —á–∞—Å–∞
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** —Å–∏—Å—Ç–µ–º—ã

### –≠–¢–ê–ü 3: –ú–ê–°–°–û–í–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (–ï–°–õ–ò –¢–ï–°–¢ –£–°–ü–ï–®–ï–ù)
1. **Batch –∫–æ—Ä—Ä–µ–∫—Ü–∏—è** –ø–æ –≥—Ä—É–ø–ø–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ batch
3. **Rollback –ø–ª–∞–Ω** –Ω–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–±–ª–µ–º

---

## ‚ùì –ß–¢–û –ù–£–ñ–ù–û –í–´–Ø–°–ù–ò–¢–¨ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°:

1. **–ú–æ–∂–µ—Ç–µ –ª–∏ –≤—ã –Ω–∞–π—Ç–∏ –≥–¥–µ/–∫–∞–∫ User 25 –ø–æ–ª—É—á–∏–ª 75+ –º–ª–Ω UNI?**
2. **–ï—Å—Ç—å –ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –¥—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –±–∞–ª–∞–Ω—Å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?**
3. **–ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å users.balance_* –Ω–∞–ø—Ä—è–º—É—é?**
4. **–ì–æ—Ç–æ–≤—ã –ª–∏ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–∞ –æ–¥–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ?**

**–ì–ª–∞–≤–Ω–æ–µ: –ù–ï –¢–†–û–ì–ê–ï–ú –ö–û–î, —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç–∞–µ–º —Å –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ SQL —Å–∫—Ä–∏–ø—Ç—ã!**