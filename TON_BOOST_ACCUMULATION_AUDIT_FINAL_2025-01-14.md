# üîç TON Boost –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ - –§–∏–Ω–∞–ª—å–Ω—ã–π –ê—É–¥–∏—Ç

**–î–∞—Ç–∞:** 14 –∏—é–ª—è 2025
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê—É–¥–∏—Ç –∑–∞–≤–µ—Ä—à–µ–Ω  
**–ú–µ—Ç–æ–¥:** –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞

---

## üìä –°–≤–æ–¥–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

| –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å | –í–ª–∏—è–Ω–∏–µ |
|----------|--------|---------|
| –ü–æ—Ç–µ—Ä—è —Å—Ä–µ–¥—Å—Ç–≤ | ‚ùå 10 TON (3%) | 340 TON ‚Üí 330 TON |
| –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü | ‚ùå –ö—Ä–∏—Ç–∏—á–Ω–æ | ton_farming_data ‚â† users |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ cumulative_balance | ‚ùå –ù–µ—Ç –∞—É–¥–∏—Ç–∞ | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ |
| UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | ‚ùå –í–∏–∑—É–∞–ª—å–Ω—ã–π –±–∞–≥ | deposits.reduce() –≤–º–µ—Å—Ç–æ farming_balance |
| API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç tonBalance | ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç | –í–º–µ—Å—Ç–æ farming_balance |
| –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ upsert | ‚ùå –ö–†–ò–¢–ò–ß–ù–û | farming_rate –∏ farming_balance –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è |

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏

### 1. –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü ‚ùå
```sql
-- ton_farming_data (–æ—Å–Ω–æ–≤–Ω–∞—è)
farming_balance: 330 TON ‚úÖ (–ø–æ—á—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
farming_rate: 0.015
boost_package_id: 2

-- users (fallback)  
ton_farming_balance: 0 TON ‚ùå
ton_farming_rate: 0.015
ton_boost_package_id: null ‚ùå
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback, –≤–∏–¥–∏—Ç 0 TON!

### 2. –ü–æ—Ç–µ—Ä—è —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ ‚ùå
- –í—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: 37
- –°—É–º–º–∞ –¥–µ–ø–æ–∑–∏—Ç–æ–≤: 340 TON
- –í –ë–î —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ: 330 TON
- **–ü–æ—Ç–µ—Ä—è–Ω–æ: 10 TON** (–ø–æ—Å–ª–µ–¥–Ω–∏–π Advanced Boost)

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ cumulative_balance –≤ metadata ‚ùå
```javascript
// modules/boost/service.ts —Å—Ç—Ä–æ–∫–∞ 369-374
metadata: {
  original_type: 'TON_BOOST_PURCHASE',
  boost_package_id: boostPackage.id,
  package_name: boostPackage.name,
  daily_rate: boostPackage.daily_rate
  // ‚ùå –ù–ï–¢ cumulative_balance!
}
```

### 4. UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Å—Å–∏–≤ deposits ‚ùå
```typescript
// TonFarmingStatusCard.tsx —Å—Ç—Ä–æ–∫–∏ 286-292
const deposits = farmingInfo?.data?.deposits || [];
amount = deposits.reduce((sum, deposit) => {
  return sum + parseFloat(deposit.ton_amount);
}, 0);
// –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç farming_balance –∏–∑ –ë–î
```

### 5. API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚ùå
```javascript
// getTonBoostFarmingStatus –≤ service.ts
deposits: [{
  amount: tonBalance.toString(), // ‚ùå –û–±—â–∏–π –±–∞–ª–∞–Ω—Å –≤–º–µ—Å—Ç–æ farming_balance
  ...
}]
```

### 6. –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ upsert ‚ùå‚ùå‚ùå
**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:**
```
–ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–∫—É–ø–∫–∞: Advanced Boost
- –û–∂–∏–¥–∞–ª–æ—Å—å: package_id=3, rate=0.02, balance+=10
- –í –ë–î: package_id=2, rate=0.015, balance –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
```

---

## üîß –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞

**–ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ upsert –æ–ø–µ—Ä–∞—Ü–∏–∏** –≤ `TonFarmingRepository.activateBoost()`:
1. –ö–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è (`currentBalance + depositToAdd`)
2. –ù–û upsert —á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–ª–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è
3. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ:
   - `boost_package_id` –∏–Ω–æ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
   - `farming_balance` –∏ `farming_rate` - –ù–ï–¢

---

## üìã –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–¥–æ–º

### –õ–æ–≥–∏–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚úÖ
```typescript
// TonFarmingRepository.ts —Å—Ç—Ä–æ–∫–∏ 252-255
const currentBalance = parseFloat(existingRecord.farming_balance) || 0;
const depositToAdd = depositAmount || 0;
newFarmingBalance = (currentBalance + depositToAdd).toString();
```

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ ‚úÖ
```typescript
// tonBoostIncomeScheduler.ts —Å—Ç—Ä–æ–∫–∞ 117
const userDeposit = Math.max(0, parseFloat(user.farming_balance || '0'));
```

### –ù–û –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è ‚ùå
```sql
SELECT farming_balance FROM ton_farming_data WHERE user_id = 74;
-- 330 –≤–º–µ—Å—Ç–æ 340

SELECT farming_rate FROM ton_farming_data WHERE user_id = 74;  
-- 0.015 –≤–º–µ—Å—Ç–æ 0.02
```

---

## üéØ –í—ã–≤–æ–¥—ã

1. **–õ–æ–≥–∏–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞** –≤ –∫–æ–¥–µ
2. **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**
3. **–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö** - —á–∞—Å—Ç–∏—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ upsert
4. **UI –∏ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏** –¥–∞–Ω–Ω—ã—Ö
5. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—É–¥–∏—Ç-—Ç—Ä–µ–π–ª** –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –≤ metadata

**–ü–æ—Ç–µ—Ä–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 74:** 10 TON (3% –æ—Ç 340 TON)

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞)

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ upsert
2. –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ upsert
3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å UI –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è farming_balance
5. –î–æ–±–∞–≤–∏—Ç—å cumulative_balance –≤ metadata —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π