# –û–¢–ß–ï–¢: –ü–û–õ–ù–û–ï –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï –¶–ï–ü–û–ß–ö–ò UNIFARMING
**–î–∞—Ç–∞:** 12 —è–Ω–≤–∞—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

## üéØ –†–ï–ó–Æ–ú–ï –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–î–ï–ê–õ–¨–ù–û:
1. **–î–µ–ø–æ–∑–∏—Ç—ã UNI** - –ë–∞–ª–∞–Ω—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ BalanceManager
2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π FARMING_DEPOSIT** - –í–°–ï —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–Ω–∞–π–¥–µ–Ω–æ 9 –¥–µ–ø–æ–∑–∏—Ç–æ–≤)
3. **–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞** - Scheduler –Ω–∞—á–∏—Å–ª—è–µ—Ç 1% –≤ –¥–µ–Ω—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç  
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤** - BatchBalanceProcessor —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–∞—Å—Å–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
5. **WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ UI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
6. **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã** - –†–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è—Ö

### ‚ùå –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - UI –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ FARMING_DEPOSIT —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –ë–î –Ω–æ –ù–ï –û–¢–û–ë–†–ê–ñ–ê–Æ–¢–°–Ø –≤ UI**
- –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å 9 FARMING_DEPOSIT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 74
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ API –∏–ª–∏ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üìä –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –¶–ï–ü–û–ß–ö–ò

### 1. –î–ï–ü–û–ó–ò–¢ UNI (modules/farming/service.ts)

#### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–æ–∑–∏—Ç–∞:
```typescript
// –°—Ç—Ä–æ–∫–∞ 181: depositUniForFarming
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å—É–º–º—ã
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (—Å—Ç—Ä–æ–∫–∞ 235)
3. –°–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä–µ–∑ BalanceManager (—Å—Ç—Ä–æ–∫–∞ 277):
   balanceManager.subtractBalance(user.id, depositAmount, 0, 'UNI farming deposit')
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–∞ —á–µ—Ä–µ–∑ UniFarmingRepository (—Å—Ç—Ä–æ–∫–∞ 295)
5. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 336):
   type: 'FARMING_DEPOSIT'  // ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê –ó–î–ï–°–¨!
6. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ farming_sessions (—Å—Ç—Ä–æ–∫–∞ 406)
```

### 2. –ù–ê–ß–ò–°–õ–ï–ù–ò–ï –î–û–•–û–î–ê (core/scheduler/farmingScheduler.ts)

#### –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç:
```typescript
// –°—Ç—Ä–æ–∫–∞ 55: processUniFarmingIncome
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∞—Ä–º–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ UniFarmingRepository (—Å—Ç—Ä–æ–∫–∞ 63)
2. –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ (—Å—Ç—Ä–æ–∫–∞ 274: calculateUniFarmingIncome):
   - rate = 0.01 (1% –≤ –¥–µ–Ω—å)
   - income = depositAmount * rate * daysElapsed
3. Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 108):
   batchBalanceProcessor.processFarmingIncome(farmerIncomes)
4. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥ (—Å—Ç—Ä–æ–∫–∞ 180)
```

### 3. –ü–†–û–ë–õ–ï–ú–ê –° –¢–ò–ü–ê–ú–ò –¢–†–ê–ù–ó–ê–ö–¶–ò–ô

#### –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:

1. **modules/transactions/types.ts**:
   ```typescript
   export type TransactionsTransactionType = 
     | 'FARMING_REWARD'
     | 'REFERRAL_REWARD'
     | 'MISSION_REWARD'
     | 'DAILY_BONUS';
   // –ù–ï–¢ –¢–ò–ü–ê FARMING_DEPOSIT!
   ```

2. **modules/transactions/model.ts**:
   ```typescript
   FARMING_DEPOSIT: 'farming_deposit',  // –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
   ```

3. **modules/farming/service.ts**:
   ```typescript
   type: 'FARMING_DEPOSIT',  // –í–ï–†–•–ù–ò–ô —Ä–µ–≥–∏—Å—Ç—Ä
   ```

4. **core/TransactionService.ts**:
   ```typescript
   // –ù–ï–¢ –º–∞–ø–ø–∏–Ω–≥–∞ –¥–ª—è FARMING_DEPOSIT
   const TRANSACTION_TYPE_MAPPING = {
     'UNI_DEPOSIT': 'FARMING_REWARD',  // –¥–µ–ø–æ–∑–∏—Ç—ã –º–∞–ø–ø—è—Ç—Å—è –Ω–∞ FARMING_REWARD
     // ...
   };
   ```

### 4. –ü–û–¢–û–ö –î–ê–ù–ù–´–• –ü–†–ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ò –¢–†–ê–ù–ó–ê–ö–¶–ò–ô

1. **Frontend –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**:
   ```
   GET /api/v2/transactions?user_id=74
   ```

2. **TransactionsController** (—Å—Ç—Ä–æ–∫–∞ 36):
   - –í—ã–∑—ã–≤–∞–µ—Ç transactionsService.getTransactionHistory

3. **TransactionsService** (—Å—Ç—Ä–æ–∫–∞ 31):
   - –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç –Ω–∞ UnifiedTransactionService.getUserTransactions

4. **UnifiedTransactionService** (—Å—Ç—Ä–æ–∫–∞ 166):
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∏–∑ –ë–î —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
   - ‚ö†Ô∏è FARMING_DEPOSIT —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –≤—ã–±–æ—Ä–∫—É

## üîç –ö–õ–Æ–ß–ï–í–´–ï –ù–ê–•–û–î–ö–ò

### 1. –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 74:
- **UNI –±–∞–ª–∞–Ω—Å**: 1,501,100.122573
- **–î–µ–ø–æ–∑–∏—Ç –≤ —Ñ–∞—Ä–º–∏–Ω–≥–µ**: 427,589 UNI
- **–°—Ç–∞–≤–∫–∞**: 1% –≤ –¥–µ–Ω—å (0.01)
- **–ù–∞—á–∏—Å–ª–µ–Ω–∏—è**: ~4,275.89 UNI –≤ –¥–µ–Ω—å

### 2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ë–î:
- **FARMING_REWARD**: –°–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- **FARMING_DEPOSIT**: –°–æ–∑–¥–∞—é—Ç—Å—è, –Ω–æ –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å —Ç–∏–ø–∞–º–∏

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
- –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –Ω–∞–±–æ—Ä—ã —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- UnifiedTransactionService –Ω–µ –∑–Ω–∞–µ—Ç –æ —Ç–∏–ø–µ FARMING_DEPOSIT
- Frontend –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–µ–ø–æ–∑–∏—Ç–æ–≤

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–µ–ø–æ–∑–∏—Ç–æ–≤:

1. **–î–æ–±–∞–≤–∏—Ç—å FARMING_DEPOSIT –≤ types.ts**:
   ```typescript
   export type TransactionsTransactionType = 
     | 'FARMING_REWARD'
     | 'FARMING_DEPOSIT'  // –î–æ–±–∞–≤–∏—Ç—å
     | 'REFERRAL_REWARD'
     | 'MISSION_REWARD'
     | 'DAILY_BONUS';
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –≤ TransactionService.ts**:
   ```typescript
   const TRANSACTION_TYPE_MAPPING = {
     'FARMING_DEPOSIT': 'FARMING_DEPOSIT',  // –ü—Ä—è–º–æ–π –º–∞–ø–ø–∏–Ω–≥
     // ...
   };
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø –≤ –ë–î**:
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ enum –≤ –ë–î –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 'FARMING_DEPOSIT'

## üí° –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ù–ê–•–û–î–ö–ò

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π FARMING_REWARD (core/scheduler/farmingScheduler.ts)

–ü—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è—Ö –¥–æ—Ö–æ–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ù–ê–ü–†–Ø–ú–£–Æ –≤ scheduler:
```typescript
// –°—Ç—Ä–æ–∫–∞ 152: –ü–æ—Å–ª–µ batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–≤
await supabase
  .from('transactions')
  .insert({
    user_id: farmer.id,
    type: 'FARMING_REWARD',  // ‚úÖ –≠—Ç–æ—Ç —Ç–∏–ø —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
    amount: income,
    amount_uni: income,
    amount_ton: '0',
    currency: 'UNI',
    status: 'completed',
    description: `UNI farming income: ${income} UNI (rate: ${farmer.uni_farming_rate})`,
    created_at: new Date().toISOString()
  });
```

### BatchBalanceProcessor –ù–ï —Å–æ–∑–¥–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

BatchBalanceProcessor (core/BatchBalanceProcessor.ts) –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞:
- –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ users
- –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–µ—à–∞
- –û—Ç–ø—Ä–∞–≤–∫—É WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ BalanceNotificationService

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ.

## üìà –†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø 74

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
- **9 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π FARMING_DEPOSIT** (–¥–µ–ø–æ–∑–∏—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç!)
  - –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–æ–∑–∏—Ç: 10,000 UNI (12.07.2025 14:40)
  - –û–±—â–∞—è —Å—É–º–º–∞ –¥–µ–ø–æ–∑–∏—Ç–æ–≤: 427,589 UNI
- **5 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π FARMING_REWARD** (–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç)
- **6 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π DAILY_BONUS** (–±–æ–Ω—É—Å—ã –∞–∫—Ç–∏–≤–Ω—ã)

### –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- **–ë–∞–ª–∞–Ω—Å UNI**: 1,501,100.122573
- **–ë–∞–ª–∞–Ω—Å TON**: 872.118945
- **–î–µ–ø–æ–∑–∏—Ç –≤ —Ñ–∞—Ä–º–∏–Ω–≥–µ**: 427,589 UNI
- **–§–∞—Ä–º–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω**: –î–∞
- **–°—Ç–∞–≤–∫–∞**: 1% –≤ –¥–µ–Ω—å
- **–ù–∞—á–∞–ª–æ —Ñ–∞—Ä–º–∏–Ω–≥–∞**: 11.07.2025 07:59

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–°–∏—Å—Ç–µ–º–∞ UniFarming —Ä–∞–±–æ—Ç–∞–µ—Ç –ü–û–õ–ù–û–°–¢–¨–Æ –ö–û–†–†–ï–ö–¢–ù–û:
- ‚úÖ –î–µ–ø–æ–∑–∏—Ç—ã —Å–ø–∏—Å—ã–≤–∞—é—Ç –±–∞–ª–∞–Ω—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ FARMING_DEPOSIT —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –ë–î (9 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
- ‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ FARMING_REWARD —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ë–∞–ª–∞–Ω—Å—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ WebSocket
- ‚ùå –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ FARMING_DEPOSIT –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ UI

–ü—Ä–æ–±–ª–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ API —Å–ª–æ–µ:
1. UnifiedTransactionService –Ω–µ –∑–Ω–∞–µ—Ç –æ —Ç–∏–ø–µ FARMING_DEPOSIT (–Ω–µ—Ç –≤ –º–∞–ø–ø–∏–Ω–≥–µ)
2. types.ts –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç FARMING_DEPOSIT –≤ TransactionsTransactionType
3. API —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç FARMING_DEPOSIT —Ç–∏–ø—ã