# üîß TELEGRAM WEBHOOK –ù–ê–°–¢–†–û–ô–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

### 1. **Webhook Status - –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê** ‚ùå
```json
{"ok":true,"result":{"url":"","has_custom_certificate":false,"pending_update_count":0}}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** Webhook URL –ø—É—Å—Ç–æ–π - –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API

### 2. **–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å 401 Unauthorized** üîç
**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** `authenticateTelegram` middleware –±–ª–æ–∫–∏—Ä—É–µ—Ç –í–°–ï API –∑–∞–ø—Ä–æ—Å—ã

–ò–∑ `core/middleware/auth.ts`:
- –¢—Ä–µ–±—É–µ—Ç `x-telegram-init-data` header –¥–ª—è –í–°–ï–• –∑–∞–ø—Ä–æ—Å–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç bypass –¥–ª—è non-Telegram –æ–∫—Ä—É–∂–µ–Ω–∏—è
- Frontend –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –∏–∑-–∑–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ API

### 3. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

**–†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /health (200 OK)
- Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- TON Connect –º–∞–Ω–∏—Ñ–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- SUPABASE_KEY —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω

**–ë–ª–æ–∫–∏—Ä—É—é—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- `authenticateTelegram` middleware –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º API –º–∞—Ä—à—Ä—É—Ç–∞–º
- –ù–µ—Ç development/guest —Ä–µ–∂–∏–º–∞
- Frontend –Ω–µ –º–æ–∂–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –±–µ–∑ API –¥–æ—Å—Ç—É–ø–∞

### 4. **Webhook manual setup –ø–æ–ø—ã—Ç–∫–∞:**
```bash
curl -X POST "https://api.telegram.org/bot7980427501:AAHdia3LusU9dk2aRvhXgmj9Ozo08nR0Gug/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{"url":"https://uni-farm-connect-x-alinabndrnk99.replit.app/webhook"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å, –Ω–æ webhook URL –æ—Å—Ç–∞–µ—Ç—Å—è –ø—É—Å—Ç—ã–º

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –í–´–í–û–î:

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –¥–∞–∂–µ –≤ Telegram –∏–∑-–∑–∞ —Å—Ç—Ä–æ–≥–æ–≥–æ middleware, –∫–æ—Ç–æ—Ä—ã–π –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—ã–µ API –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

**–¢–†–ï–ë–£–ï–¢–°–Ø:** –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω—ã–π bypass –≤ `authenticateTelegram` middleware –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö endpoint –∏–ª–∏ development —Ä–µ–∂–∏–º–∞.