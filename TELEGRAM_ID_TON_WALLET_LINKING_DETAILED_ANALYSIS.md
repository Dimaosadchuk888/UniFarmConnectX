# üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ú–ï–•–ê–ù–ò–ó–ú–ê –°–í–Ø–ó–ö–ò TELEGRAM ID –ò TON-–ö–û–®–ï–õ–¨–ö–ê

**–î–∞—Ç–∞:** 21 —è–Ω–≤–∞—Ä—è 2025  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ TON –¥–µ–ø–æ–∑–∏—Ç–∞—Ö

---

## üìä –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

### –¢–µ–∫—É—â–∞—è —Å—Ö–µ–º–∞ –∏–º–µ–µ—Ç 3 —É—Ä–æ–≤–Ω—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```
1. JWT Token (telegram_id) ‚Üí Primary
2. TON Wallet Address ‚Üí Fallback
3. Auto-creation ‚Üí Last Resort
```

---

## üéØ 1. –ö–û–ì–î–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ü–û–î–ö–õ–Æ–ß–ê–ï–¢ –ö–û–®–ï–õ–Å–ö

### 1.1 –ò—Å—Ç–æ—á–Ω–∏–∫ telegram_id –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞

**Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:** `TonDepositCard.tsx`

```typescript
// –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è saveTonWalletAddress
const userFriendlyAddress = await getTonWalletAddress(tonConnectUI);
await saveTonWalletAddress(userFriendlyAddress);
```

**API –≤—ã–∑–æ–≤:** `client/src/services/tonConnectService.ts`

```typescript
async function saveTonWalletAddress(walletAddress: string): Promise<boolean> {
  const response = await fetch('/api/v2/wallet/connect-ton', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${localStorage.getItem('unifarm_jwt_token')}`
    },
    body: JSON.stringify({ walletAddress })
  });
}
```

### 1.2 –û—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è telegram_id?

**–ò—Å—Ç–æ—á–Ω–∏–∫:** JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization

```typescript
// modules/wallet/controller.ts - connectTonWallet
const telegram = this.validateTelegramAuth(req, res);
// telegram.user —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ JWT

const user = await userRepository.getOrCreateUserFromTelegram({
  telegram_id: telegram.user.id,  // ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è database ID!
  username: telegram.user.username,
  first_name: telegram.user.first_name
});
```

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—É—Ç–∞–Ω–∏—Ü–∞ —Å ID

–í —Å–∏—Å—Ç–µ–º–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏:

```typescript
// –í JWT —Ç–æ–∫–µ–Ω–µ:
{
  "userId": 74,          // database user ID
  "telegram_id": 999489, // –Ω–∞—Å—Ç–æ—è—â–∏–π telegram ID
}

// –ü–æ—Å–ª–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ telegramAuth.ts:
telegram.user = {
  id: 74,               // database ID (–ù–ï telegram_id!)
  telegram_id: 999489,  // –Ω–∞—Å—Ç–æ—è—â–∏–π telegram_id
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `getOrCreateUserFromTelegram` —Å `telegram.user.id` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è database ID –≤–º–µ—Å—Ç–æ telegram_id!

---

## üîê 2. –ü–†–ò –ü–û–õ–£–ß–ï–ù–ò–ò –ó–ê–ü–†–û–°–ê /ton-deposit

### 2.1 –ü–æ—á–µ–º—É getUserByTelegramId() –º–æ–∂–µ—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–µ–≤–µ—Ä–Ω—ã–π telegram_id –≤ –∑–∞–ø—Ä–æ—Å–µ**

```typescript
// modules/wallet/controller.ts - tonDeposit
let user = await userRepository.getUserByTelegramId(telegram.user.id);
// ‚ö†Ô∏è telegram.user.id = 74 (database ID), –∞ –Ω–µ 999489 (telegram_id)!
```

–°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å telegram_id = 74, –Ω–æ –≤ –±–∞–∑–µ —É –Ω–µ–≥–æ telegram_id = 999489.

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω –±–µ–∑ telegram_id**

–í–æ–∑–º–æ–∂–Ω—ã —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏ –ø–æ–ª–µ telegram_id –æ—Å—Ç–∞–ª–æ—Å—å NULL –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º.

### 2.2 –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
// –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å):
let user = await userRepository.getUserByTelegramId(telegram.user.telegram_id);

// –¢–µ–∫—É—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):
let user = await userRepository.getUserByTelegramId(telegram.user.id);
```

---

## üíº 3. FALLBACK –ü–û WALLET_ADDRESS

### 3.1 –ú–æ–∂–µ—Ç –ª–∏ –∞–¥—Ä–µ—Å –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Å –¥—Ä—É–≥–∏–º Telegram ID?

**–î–ê, —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö:**

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–µ–Ω–∏–ª Telegram –∞–∫–∫–∞—É–Ω—Ç**
   - –°—Ç–∞—Ä—ã–π –∞–∫–∫–∞—É–Ω—Ç: telegram_id = 111111, wallet = "UQxx...123"
   - –ù–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç: telegram_id = 222222, –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ wallet

2. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã**
   - –û–¥–∏–Ω –∫–æ—à–µ–ª–µ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–≤

3. **–û—à–∏–±–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏**
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–æ—à–µ–ª —Å–±–æ–π –∏ –∫–æ—à–µ–ª–µ–∫ –ø—Ä–∏–≤—è–∑–∞–ª—Å—è –∫ –Ω–µ–≤–µ—Ä–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### 3.2 –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ fallback

```typescript
// –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –ø–æ JWT
if (!user) {
  const { data: existingUser } = await supabase
    .from('users')
    .select('*')
    .eq('ton_wallet_address', wallet_address)
    .single();
    
  if (existingUser) {
    user = existingUser;
    // ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–ï–ó –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è telegram_id!
  }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø–æ –∫–æ—à–µ–ª—å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –¥–∞–∂–µ –µ—Å–ª–∏ –µ–≥–æ telegram_id –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–∫—É—â–∏–º JWT.

---

## üö® 4. –í–û–ó–ú–û–ñ–ù–´–ï –°–¶–ï–ù–ê–†–ò–ò –ö–û–ù–§–õ–ò–ö–¢–û–í

### –°—Ü–µ–Ω–∞—Ä–∏–π A: –ö–æ—à–µ–ª–µ–∫ —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –¥—Ä—É–≥–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ê (telegram_id: 111111) –ø—Ä–∏–≤—è–∑–∞–ª –∫–æ—à–µ–ª–µ–∫ "UQxx...123"
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë (telegram_id: 222222) –ø—ã—Ç–∞–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç —Å —Ç–æ–≥–æ –∂–µ –∫–æ—à–µ–ª—å–∫–∞
3. JWT —Å–æ–¥–µ—Ä–∂–∏—Ç telegram_id: 222222
4. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ê –ø–æ –∫–æ—à–µ–ª—å–∫—É
5. –î–µ–ø–æ–∑–∏—Ç –∑–∞—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ê, –∞ –Ω–µ –ë!
```

### –°—Ü–µ–Ω–∞—Ä–∏–π B: –ù–µ–≤–µ—Ä–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT

```
1. JWT —Å–æ–¥–µ—Ä–∂–∏—Ç database ID –≤–º–µ—Å—Ç–æ telegram_id
2. getUserByTelegramId(74) –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –ø–æ–∏—Å–∫—É –ø–æ –∫–æ—à–µ–ª—å–∫—É
4. –ï—Å–ª–∏ –∫–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω - —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
5. –í–æ–∑–Ω–∏–∫–∞—é—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

### –°—Ü–µ–Ω–∞—Ä–∏–π C: –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```
1. Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç user_id –∏–∑ UserContext
2. Backend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç telegram_id –∏–∑ JWT
3. –≠—Ç–∏ ID –º–æ–≥—É—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å –∏–∑-–∑–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã
4. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω–∞
```

---

## üí° 5. –ö–û–†–ù–ï–í–´–ï –ü–†–ò–ß–ò–ù–´ –ü–†–û–ë–õ–ï–ú

### 5.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å ID

```typescript
// –ü–†–û–ë–õ–ï–ú–ê –≤ telegramAuth.ts:
const user = {
  id: fullUser.id,  // database ID, –∞ –Ω–µ telegram_id!
  telegram_id: fullUser.telegram_id,
  // ...
};
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –≤–æ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö `telegram.user.id` —Å–æ–¥–µ—Ä–∂–∏—Ç database ID, –∞ –Ω–µ telegram_id.

### 5.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–æ—à–µ–ª—å–∫–∞

–ü—Ä–∏ fallback –ø–æ wallet_address –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ telegram_id –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—É—â–∏–º JWT
- –ò–º–µ–µ—Ç –ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∞–≤–æ –Ω–∞ —ç—Ç–æ—Ç –∫–æ—à–µ–ª–µ–∫

### 5.3 –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å Frontend –∏ Backend

Frontend –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å:
- `user_id` –∏–∑ UserContext (database ID)
- `wallet_address` –∏–∑ TonConnect

Backend –æ–∂–∏–¥–∞–µ—Ç:
- –í–∞–ª–∏–¥–Ω—ã–π JWT —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º telegram_id
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É JWT –∏ wallet_address

---

## üõ†Ô∏è 6. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

### 6.1 –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è –ø–æ–∏—Å–∫–∞:**
```typescript
// –í–µ–∑–¥–µ –∑–∞–º–µ–Ω–∏—Ç—å:
getUserByTelegramId(telegram.user.id)
// –ù–∞:
getUserByTelegramId(telegram.user.telegram_id)
```

2. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø—Ä–∏ fallback:**
```typescript
if (existingUser && existingUser.telegram_id !== telegram.user.telegram_id) {
  logger.warn('–ü–æ–ø—ã—Ç–∫–∞ –¥–µ–ø–æ–∑–∏—Ç–∞ —Å —á—É–∂–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞', {
    current_telegram_id: telegram.user.telegram_id,
    wallet_owner_telegram_id: existingUser.telegram_id
  });
  return this.sendError(res, '–ö–æ—à–µ–ª–µ–∫ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –¥—Ä—É–≥–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É', 403);
}
```

### 6.2 –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É wallet_links:**
```sql
CREATE TABLE wallet_links (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  wallet_address TEXT NOT NULL,
  verified BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, wallet_address)
);
```

2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–ª–∞–¥–µ–Ω–∏—è:**
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–π –ø—Ä–∏–≤—è–∑–∫–µ –∫–æ—à–µ–ª—å–∫–∞ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –ø—Ä–∏–≤—è–∑–æ–∫
- –ü–æ–∑–≤–æ–ª—è—Ç—å –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ—à–µ–ª—å–∫–æ–≤

3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É —Å ID:**
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ–ª–µ –≤ telegram context
- –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö ID

---

## üìã 7. –ü–†–û–í–ï–†–û–ß–ù–´–ô –ß–ï–ö–õ–ò–°–¢

–î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –¥–µ–ø–æ–∑–∏—Ç–æ–º:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å JWT —Ç–æ–∫–µ–Ω:**
   - –ö–∞–∫–æ–π telegram_id –≤ —Ç–æ–∫–µ–Ω–µ?
   - –ö–∞–∫–æ–π userId –≤ —Ç–æ–∫–µ–Ω–µ?

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç getUserByTelegramId —Å –æ–±–æ–∏–º–∏ ID?
   - –ï—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º wallet_address?

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:**
   - –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ telegram_id –∏–∑ JWT —Å telegram_id –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–æ—à–µ–ª—å–∫–∞?
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ user_id –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏?

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   - –ö–∞–∫–æ–π resolution method –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω (jwt_auth, wallet_linking, auto_creation)?
   - –ë—ã–ª–∏ –ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ ID?

---

## ‚úÖ –í–´–í–û–î–´

1. **–ì–ª–∞–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ —Å–±–æ–µ–≤** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º database ID –≤–º–µ—Å—Ç–æ telegram_id –≤ JWT –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

2. **–£—Å—É–≥—É–±–ª—è—é—â–∏–π —Ñ–∞–∫—Ç–æ—Ä** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–æ—à–µ–ª—å–∫–∞ –ø—Ä–∏ fallback –ø–æ–∏—Å–∫–µ

3. **–†–µ–∑—É–ª—å—Ç–∞—Ç** - –¥–µ–ø–æ–∑–∏—Ç—ã –º–æ–≥—É—Ç –∑–∞—á–∏—Å–ª—è—Ç—å—Å—è –Ω–µ —Ç–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è

4. **–†–µ—à–µ–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

---

**–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 21 —è–Ω–≤–∞—Ä—è 2025  
**–¶–µ–ª—å:** –í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–∏—á–∏–Ω —Å–±–æ–µ–≤ –≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ TON –¥–µ–ø–æ–∑–∏—Ç–∞—Ö