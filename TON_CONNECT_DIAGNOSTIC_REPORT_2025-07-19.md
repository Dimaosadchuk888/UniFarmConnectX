# TON Connect & Wallet System Diagnostic Report
## –î–∞—Ç–∞: 19 –∏—é–ª—è 2025

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ –≤ —Ñ–æ—Ä–º–µ –≤—ã–≤–æ–¥–∞

#### üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ù–ê–•–û–î–ö–ê
**–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å**: `0:20b597c37c551332393fb87d599bad86b1402e7f06a9e9946fc3fe1c98c645e8`  
**–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã**: –ù–ï –ù–ê–ô–î–ï–ù –≤ –∫–æ–¥–µ

#### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **WithdrawalForm.tsx (—Å—Ç—Ä–æ–∫–∏ 66-67)**:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `walletAddress` –∏–∑ UserContext
   - `defaultValues: { walletAddress: walletAddress || '' }`
   - –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞

2. **UserContext.tsx**:
   - `walletAddress` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `null` (—Å—Ç—Ä–æ–∫–∞ 113)
   - –ü–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ TON Connect UI —á–µ—Ä–µ–∑ `getTonWalletAddress()`
   - –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞

3. **–ü–æ–∏—Å–∫ –ø–æ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ**:
   - `grep -r "20b597c37c"` - –ù–ï –ù–ê–ô–î–ï–ù–û
   - `grep -r "EQAgFo"` - –ù–ï –ù–ê–ô–î–ï–ù–û
   - –ê–¥—Ä–µ—Å –ù–ï –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ

#### üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ø–æ–ª–µ `ton_wallet_address` —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 184 —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å
2. **LocalStorage/SessionStorage**: –¥–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. **TON Connect SDK**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å
4. **UserContext**: –∞–¥—Ä–µ—Å –º–æ–≥ –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–µ—Å—Å–∏—è—Ö

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞ –≤–º–µ—Å—Ç–æ "Uni Farm"

#### üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ù–ê–•–û–î–ö–ê
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –≤–º–µ—Å—Ç–æ "Uni Farm"

#### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **TON Connect Manifest (client/public/tonconnect-manifest.json)**:
   ```json
   {
     "url": "https://uni-farm-connect-aab49267.replit.app",
     "name": "UniFarm",
     "iconUrl": "https://uni-farm-connect-aab49267.replit.app/assets/unifarm-icon.svg"
   }
   ```
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: "UniFarm"
   - ‚úÖ –û–±–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã

2. **App.tsx (—Å—Ç—Ä–æ–∫–∞ 290)**:
   ```typescript
   <TonConnectUIProvider manifestUrl="https://uni-farm-connect-aab49267.replit.app/tonconnect-manifest.json">
   ```
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
   - ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–ª–Ω—ã–π URL (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω 16 —è–Ω–≤–∞—Ä—è 2025)

#### üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ö—ç—à –±—Ä–∞—É–∑–µ—Ä–∞**: —Å—Ç–∞—Ä—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω
2. **TON Connect UI**: –Ω–µ –æ–±–Ω–æ–≤–∏–ª –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –¥–æ–º–µ–Ω–æ–≤**: –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º –¥–æ–º–µ–Ω–æ–º –∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–º
4. **CDN/Proxy**: –º–∞–Ω–∏—Ñ–µ—Å—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º

#### üö® –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
**–û–ø–∏—Å–∞–Ω–∏–µ**: "–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –Ω–µ —Ä–µ—à–∏–ª–∞—Å—å"

#### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **TonDepositCard.tsx**:
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç TON Connect UI (—Å—Ç—Ä–æ–∫–∏ 8, 27)
   - ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 56-84)
   - ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–µ–ø–æ–∑–∏—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 86-125)

2. **tonConnectService.ts**:
   - ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 25-28)
   - ‚úÖ –§—É–Ω–∫—Ü–∏—è `isTonWalletConnected()` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 119-125)
   - ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤ –≤ raw —Ñ–æ—Ä–º–∞—Ç (—Å—Ç—Ä–æ–∫–∏ 31-40)

3. **Backend API**:
   - ‚úÖ Endpoint `/api/v2/wallet/ton-deposit` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ server/index.ts
   - ‚úÖ WalletService.saveTonWallet() –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∞–¥—Ä–µ—Å–∞

#### üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º:
1. **TON Connect UI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
2. **Wallet Connection**: –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ TON Connect UI
3. **Transaction Processing**: –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
4. **Backend Processing**: –ø—Ä–æ–±–ª–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞)

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞** –ø–æ–ª–Ω–æ—Å—Ç—å—é
2. **–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç–µ TON –∫–æ—à–µ–ª–µ–∫**:
   - –û—Ç–∫–ª—é—á–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –∫–æ—à–µ–ª–µ–∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
   - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –∑–∞–Ω–æ–≤–æ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ JavaScript –æ—à–∏–±–æ–∫

### –î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**: –ø–æ–ª–µ `ton_wallet_address` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 184
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞** —Å –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞**: –æ—Ç–∫—Ä—ã—Ç—å URL –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Console Logs**: –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É TON Connect

## üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º—ã |
|-----------|--------|----------|
| WithdrawalForm.tsx | ‚úÖ –ò—Å–ø—Ä–∞–≤–µ–Ω | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∞–¥—Ä–µ—Å–∞ |
| UserContext.tsx | ‚úÖ –ò—Å–ø—Ä–∞–≤–µ–Ω | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è walletAddress |
| tonConnectService.ts | ‚úÖ –ò—Å–ø—Ä–∞–≤–µ–Ω | –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç |
| TON Connect Manifest | ‚úÖ –ò—Å–ø—Ä–∞–≤–µ–Ω | –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ "UniFarm" |
| TonDepositCard.tsx | ‚úÖ –ò—Å–ø—Ä–∞–≤–µ–Ω | –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ |
| Backend API | ‚úÖ –ò—Å–ø—Ä–∞–≤–µ–Ω | Endpoints —Å—É—â–µ—Å—Ç–≤—É—é—Ç |

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Application ‚Üí Storage ‚Üí Clear All
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ TON –∫–æ—à–µ–ª–µ–∫
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–∞ –≤ —Ñ–æ—Ä–º–µ –≤—ã–≤–æ–¥–∞
1. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ö–æ—à–µ–ª–µ–∫"
3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫
2. –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Console –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

## üî¨ –í—ã–≤–æ–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

1. **–ö–æ–¥ –∏—Å–ø—Ä–∞–≤–µ–Ω**: –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
2. **–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ**: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
3. **–í–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –¥–∞–Ω–Ω—ã–º–∏**: –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
4. **–ú–∞–Ω–∏—Ñ–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω**: –Ω–∞–∑–≤–∞–Ω–∏–µ "UniFarm" —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
5. **–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞**: –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

**–¢–†–ï–ë–£–ï–¢–°–Ø –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:**
- –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 184
- Console logs –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º