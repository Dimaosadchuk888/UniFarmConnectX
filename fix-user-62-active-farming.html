<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ–∞—Ä–º–∏–Ω–≥–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 62</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .status-box {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
        }
        .success {
            color: #4CAF50;
            font-weight: bold;
        }
        .error {
            color: #f44336;
            font-weight: bold;
        }
        .button {
            background: #FF6600;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        .button:hover {
            background: #CC5200;
        }
        .button:disabled {
            background: #999;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ–∞—Ä–º–∏–Ω–≥–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 62</h1>
        
        <div id="current-status" class="status-box">
            –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞...
        </div>
        
        <button id="activate-btn" class="button" onclick="activateFarming()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞—Ä–º–∏–Ω–≥</button>
        
        <div id="result" class="status-box" style="display: none;">
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://mipmnzjgbgrnwizyjtwm.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1pcG1uempnYmdybndpenlqdHdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3OTM2MTIsImV4cCI6MjA1MTM2OTYxMn0.U9c-c0hh55IaFRxR-s5iH5Vc4yOK0-lLkSoD1F90bD8';
        
        async function checkCurrentStatus() {
            const statusDiv = document.getElementById('current-status');
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/users?id=eq.62`, {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`
                    }
                });
                
                const data = await response.json();
                const user = data[0];
                
                let html = '<h3>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:</h3>';
                html += `<p>User ID: ${user.id}</p>`;
                html += `<p>Username: ${user.username || 'N/A'}</p>`;
                html += `<p>–ë–∞–ª–∞–Ω—Å UNI: <strong>${user.balance_uni}</strong></p>`;
                html += `<p>–î–µ–ø–æ–∑–∏—Ç: <strong>${user.uni_deposit_amount} UNI</strong></p>`;
                html += `<p>–°—Ç–∞–≤–∫–∞ (uni_farming_rate): <span class="success"><strong>${user.uni_farming_rate}</strong></span></p>`;
                html += `<p>–§–∞—Ä–º–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω: <span class="${user.uni_farming_active ? 'success' : 'error'}"><strong>${user.uni_farming_active ? '–î–ê' : '–ù–ï–¢'}</strong></span></p>`;
                html += `<p>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: ${user.uni_farming_start_timestamp || '–ù–ï–¢'}</p>`;
                
                statusDiv.innerHTML = html;
                
                if (user.uni_farming_active) {
                    document.getElementById('activate-btn').disabled = true;
                    document.getElementById('activate-btn').textContent = '–§–∞—Ä–º–∏–Ω–≥ —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω';
                }
                
            } catch (error) {
                statusDiv.innerHTML = `<span class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</span>`;
            }
        }
        
        async function activateFarming() {
            const button = document.getElementById('activate-btn');
            const resultDiv = document.getElementById('result');
            
            button.disabled = true;
            button.textContent = '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...';
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/users?id=eq.62`, {
                    method: 'PATCH',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=representation'
                    },
                    body: JSON.stringify({
                        uni_farming_active: true
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h3 class="success">‚úÖ –§–∞—Ä–º–∏–Ω–≥ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!</h3>
                    <p>uni_farming_active —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ <strong>true</strong></p>
                    <p>–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 62 –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã –æ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.</p>
                    <p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç</strong> –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π.</p>
                `;
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç—É—Å
                await checkCurrentStatus();
                
            } catch (error) {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `<span class="error">–û—à–∏–±–∫–∞: ${error.message}</span>`;
                button.disabled = false;
                button.textContent = '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞—Ä–º–∏–Ω–≥';
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = checkCurrentStatus;
    </script>
</body>
</html>