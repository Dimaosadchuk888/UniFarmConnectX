# üìã –ê–£–î–ò–¢ UniFarm Bot  
üìÜ **–î–∞—Ç–∞:** 2025-07-06  
üéØ **–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç UniFarm Bot –∫–∞–∫ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å  
üõ† **–†–µ–∂–∏–º:** –¢–æ–ª—å–∫–æ –∞—É–¥–∏—Ç, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞  

---

## 1Ô∏è‚É£ –°—Ç–∞—Ä—Ç –±–æ—Ç–∞ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –¢–æ–∫–µ–Ω –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- **Token –≤ .env:** `TELEGRAM_BOT_TOKEN=7980427501:AAHdia3LusU9dk2aRvhXgmj9Ozo08nR0Gug`
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `modules/telegram/` (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É)
- **Username –±–æ—Ç–∞:** @UniFarming_Bot

### ‚úÖ –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:
- **Webhook endpoint:** `/api/v2/telegram/webhook`
- **Polling:** –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ webhook)
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –ß–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä, –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º

### ‚ùå –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—Ç–∞:
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ª–æ–≥–æ–≤ "Bot started" –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
- –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ webhook –≤ —Ä–∞–º–∫–∞—Ö –æ–±—â–µ–≥–æ API

### ‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã:
- –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å adminBot (—Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ)
- adminBot: @unifarm_admin_bot (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω)
- UniFarm Bot: @UniFarming_Bot (–æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–∫–µ–Ω)

---

## 2Ô∏è‚É£ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏:
```typescript
// modules/user/service.ts
async getOrCreateUserFromTelegram(userData: CreateUserData) {
  let user = await this.getUserByTelegramId(userData.telegram_id);
  if (!user) {
    user = await this.createUser(userData);
  }
  return user;
}
```

### ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:
- telegram_id
- username
- first_name
- ref_code (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- referred_by (–µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª)

### ‚úÖ –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ telegram_id –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤ –ë–î –ø–æ telegram_id

---

## 3Ô∏è‚É£ –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è –ª–æ–≥–∏–∫–∞

### ‚ö†Ô∏è –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ —á–µ—Ä–µ–∑ –±–æ—Ç–∞:
- –ë–æ—Ç –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `start` –Ω–∞–ø—Ä—è–º—É—é
- –ö–æ–º–∞–Ω–¥–∞ `/start` –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Mini App
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ Mini App

### ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –≤ Mini App:
```typescript
// client/src/services/referralService.ts
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç ref_code –∏–∑ URL
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ localStorage
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ API
```

### ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –¢–∞–±–ª–∏—Ü–∞ users
referred_by -> —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ
ref_code -> —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

-- –¢–∞–±–ª–∏—Ü–∞ referrals (–¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏)
referrer_id, referred_id, level
```

---

## 4Ô∏è‚É£ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å farming –∏ boost

### ‚úÖ –ë–æ—Ç –∫–∞–∫ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞:
```typescript
// modules/telegram/controller.ts
await this.telegramService.sendMessage(chatId, 
  'üåæ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ UniFarm Connect!\n\n' +
  '–ù–∞—á–Ω–∏—Ç–µ —Ñ–∞—Ä–º–∏—Ç—å UNI –∏ TON —Ç–æ–∫–µ–Ω—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!', 
  {
    reply_markup: {
      inline_keyboard: [[{
        text: 'üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å UniFarm',
        web_app: { url: 'https://uni-farm-connect-x-alinabndrnk99.replit.app' }
      }]]
    }
  }
);
```

### ‚ùå –ü—Ä—è–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞:
- –ë–æ—Ç –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç farming –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ë–æ—Ç –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å—ã
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Mini App API

---

## 5Ô∏è‚É£ UI / UX

### ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π:
- HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (`parse_mode: 'HTML'`)
- –≠–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ Mini App
- –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ @unifarm_admin_bot

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ callback:
- answerCallbackQuery –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –Ω–∞–∂–∞—Ç–∏—è
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

---

## 6Ô∏è‚É£ –õ–æ–≥–∏–∫–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è:
```
modules/telegram/
‚îú‚îÄ‚îÄ controller.ts  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ webhook
‚îú‚îÄ‚îÄ service.ts     // –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ routes.ts      // 2 endpoint'–∞ (debug, webhook)
‚îú‚îÄ‚îÄ model.ts       // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îî‚îÄ‚îÄ types.ts       // TypeScript —Ç–∏–ø—ã
```

### ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:
- handleWebhook –≤ controller.ts
- try/catch –æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ core/logger

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
```typescript
try {
  // –æ–±—Ä–∞–±–æ—Ç–∫–∞
} catch (error) {
  logger.error('[TelegramWebhook] Error', { error });
  res.status(200).json({ ok: true }); // –í—Å–µ–≥–¥–∞ 200 –¥–ª—è Telegram
}
```

---

## 7Ô∏è‚É£ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏:
- HMAC –≤–∞–ª–∏–¥–∞—Ü–∏—è initData –≤ service.ts
- –ü—Ä–æ–≤–µ—Ä–∫–∞ hash –æ—Ç Telegram
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –±–æ—Ç–∞

### ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ telegram_id:
- –î–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ update.message.from
- –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–¥–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π ID

### ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:
- –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–æ—Ç

---

## üìÅ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. **Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç updates
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - —á–µ—Ä–µ–∑ API –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –≤ Mini App
3. **–ë–∞–∑–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –∫–æ–º–∞–Ω–¥–∞ /start —Å –∫–Ω–æ–ø–∫–æ–π –∑–∞–ø—É—Å–∫–∞ Mini App
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - HMAC –≤–∞–ª–∏–¥–∞—Ü–∏—è, –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ –¥–∞–Ω–Ω—ã—Ö
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è

### ‚ö†Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
1. **–ë–æ—Ç –Ω–µ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á–∞—Å—Ç—å –æ–±—â–µ–≥–æ API
2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** - —Ç–æ–ª—å–∫–æ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ Mini App
3. **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ Mini App, –Ω–µ –≤ –±–æ—Ç–µ
4. **–ù–µ—Ç –ø—Ä—è–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** - –≤—Å–µ —á–µ—Ä–µ–∑ Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ start –ø–∞—Ä–∞–º–µ—Ç—Ä–∞** - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
2. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –±–∞–ª–∞–Ω—Å—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ–ª—å–∫–æ –≤ Mini App
3. **Farming –∫–æ–º–∞–Ω–¥—ã** - –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞

### üìå –í—ã–≤–æ–¥:

**UniFarm Bot –≥–æ—Ç–æ–≤ –∫ production –≤ —Å–≤–æ–µ–π —Ç–µ–∫—É—â–µ–π —Ä–æ–ª–∏.**

–ë–æ—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é - —Å–ª—É–∂–∏—Ç —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –≤ Mini App. –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Ä–µ—Ñ–µ—Ä–∞–ª—ã, farming) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ API –∏ Mini App –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ start –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É /help —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö (–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è, –±–æ–Ω—É—Å—ã)
4. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É /balance –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–∞–ª–∞–Ω—Å–∞

**–°—Ç–∞—Ç—É—Å: Production Ready** ‚úÖ