# UniFarm - –û—Ç—á–µ—Ç –æ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö

**–î–∞—Ç–∞:** 9 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ

## üìã –û–±–∑–æ—Ä –∑–∞–¥–∞—á

–ë—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ —Å–∏—Å—Ç–µ–º–µ UniFarm:

1. **–§–ª–∞–≥ `uni_farming_active`** –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø—Ä–∏ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö
2. **–¢–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ `FARMING_DEPOSIT`** –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤ —Å–∏—Å—Ç–µ–º–µ
3. **–ü–æ–ª—è TON-–∫–æ—à–µ–ª—å–∫–∞** –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ–∞—Ä–º–∏–Ω–≥–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 62

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–ª–∞–≥ `uni_farming_active` –±—ã–ª `false`, —Ö–æ—Ç—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–µ–ª–∞–ª –¥–µ–ø–æ–∑–∏—Ç  
**–†–µ—à–µ–Ω–∏–µ:** 
- –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `scripts/fix-user-62-active-farming.js`
- –§–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Supabase API
- –°—Ç–∞—Ç—É—Å –≤ UI –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ "–ê–∫—Ç–∏–≤–µ–Ω"

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤

**–§–∞–π–ª:** `modules/farming/service.ts`  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°—Ç—Ä–æ–∫–∞ 103: –î–æ–±–∞–≤–ª–µ–Ω–æ `uni_farming_active: true` –≤ –º–µ—Ç–æ–¥–µ `startFarming`
- –°—Ç—Ä–æ–∫–∞ 252: –î–æ–±–∞–≤–ª–µ–Ω–æ `uni_farming_active: true` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–µ–ø–æ–∑–∏—Ç–∞
- –°—Ç—Ä–æ–∫–∞ 221: –ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å `FARMING_REWARD` –Ω–∞ `FARMING_DEPOSIT`

**–§–∞–π–ª:** `modules/transactions/model.ts`  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–∏–ø `FARMING_DEPOSIT = 'FARMING_DEPOSIT'`

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

- Workflow "UniFarm Development" —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –∞–∫—Ç–∏–≤–Ω—ã

## ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ

### 1. –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–í Supabase Dashboard SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
ALTER TYPE transaction_type ADD VALUE IF NOT EXISTS 'FARMING_DEPOSIT';
```

### 2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è TON-–∫–æ—à–µ–ª—å–∫–∞

–í Supabase Dashboard SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–∑ —Ñ–∞–π–ª–∞ `scripts/add-ton-wallet-fields.sql`:
```sql
ALTER TABLE users
  ADD COLUMN IF NOT EXISTS ton_wallet_address TEXT,
  ADD COLUMN IF NOT EXISTS ton_wallet_verified BOOLEAN DEFAULT false,
  ADD COLUMN IF NOT EXISTS ton_wallet_linked_at TIMESTAMP;

CREATE INDEX IF NOT EXISTS idx_users_ton_wallet_address 
  ON users(ton_wallet_address) 
  WHERE ton_wallet_address IS NOT NULL;
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- ‚úÖ –§–∞—Ä–º–∏–Ω–≥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 62
- ‚úÖ –ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–æ–≤—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–∞—Ö
- ‚úÖ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ë–î
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π TON-–∫–æ—à–µ–ª—å–∫–∞ –≤ –ë–î

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤:
1. –ù–æ–≤—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ç–∏–ø–∞ `FARMING_DEPOSIT`
2. –§–ª–∞–≥ `uni_farming_active` –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. TON-–∫–æ—à–µ–ª—å–∫–∏ —Å–º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `scripts/fix-user-62-active-farming.js` - –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ–ª–∞–≥–∞
- `scripts/add-farming-deposit-type.sql` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `scripts/add-ton-wallet-fields.sql` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –∫–æ—à–µ–ª—å–∫–∞
- `scripts/test-new-deposit-type.js` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- `docs/NEXT_STEPS_DEPLOYMENT.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é