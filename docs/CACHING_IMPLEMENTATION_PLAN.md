# üìã –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è UniFarm

## –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 –¥–Ω—è)

### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
```typescript
// client/src/services/cacheService.ts
class CacheService {
  private cache = new Map();
  private timers = new Map();
  
  set(key: string, data: any, ttl: number = 60000) {
    this.cache.set(key, {
      data,
      timestamp: Date.now()
    });
    
    // –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    if (this.timers.has(key)) {
      clearTimeout(this.timers.get(key));
    }
    
    const timer = setTimeout(() => {
      this.cache.delete(key);
      this.timers.delete(key);
    }, ttl);
    
    this.timers.set(key, timer);
  }
  
  get(key: string) {
    const item = this.cache.get(key);
    if (!item) return null;
    return item.data;
  }
  
  invalidate(key: string) {
    this.cache.delete(key);
    if (this.timers.has(key)) {
      clearTimeout(this.timers.get(key));
      this.timers.delete(key);
    }
  }
  
  clear() {
    this.cache.clear();
    this.timers.forEach(timer => clearTimeout(timer));
    this.timers.clear();
  }
}
```

### 1.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –û–±–µ—Ä–Ω—É—Ç—å API –≤—ã–∑–æ–≤—ã –≤ –∫–µ—à–∏—Ä—É—é—â–∏–π —Å–ª–æ–π
- –ù–∞—á–∞—Ç—å —Å —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:
  - `/api/v2/wallet/balance` - –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 30 —Å–µ–∫
  - `/api/v2/uni-farming/status` - –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 30 —Å–µ–∫
  - `/api/v2/transactions/history` - –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 60 —Å–µ–∫

## –≠—Ç–∞–ø 2: –£–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ (2-3 –¥–Ω—è)

### 2.1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebSocket
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ - –æ–±–Ω–æ–≤–∏—Ç—å –∫–µ—à
- –ü—Ä–∏ –Ω–æ–≤–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ - –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –∏—Å—Ç–æ—Ä–∏–∏
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞—Ä–º–∏–Ω–≥–∞ - –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–µ—à

### 2.2 –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```typescript
// –ü—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
async function preloadUserData(userId: number) {
  // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
  await Promise.all([
    fetchAndCacheBalance(userId),
    fetchAndCacheFarmingStatus(userId),
    fetchAndCacheTransactions(userId)
  ]);
}
```

## –≠—Ç–∞–ø 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è React Query (1-2 –¥–Ω—è)

### 3.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ staleTime –∏ cacheTime
```typescript
// –í queryClient.ts
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 30000,      // –î–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ 30 —Å–µ–∫
      cacheTime: 5 * 60000,  // –ö–µ—à –∂–∏–≤—ë—Ç 5 –º–∏–Ω—É—Ç
      refetchOnWindowFocus: false,
      retry: 1
    }
  }
});
```

### 3.2 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ optimistic updates
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ - —Å—Ä–∞–∑—É –æ–±–Ω–æ–≤–∏—Ç—å UI
- –ü—Ä–∏ –æ—à–∏–±–∫–µ - –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫

## –≠—Ç–∞–ø 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (1 –¥–µ–Ω—å)

### 4.1 –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫–µ—à
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ —Å –∫–µ—à–µ–º vs –±–µ–∑
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—ç–∫–æ–Ω–æ–º–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 4.2 –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ TTL
- –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö
- –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–≤–µ–∂–µ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

### –°–∫–æ—Ä–æ—Å—Ç—å:
- **–ë—ã–ª–æ**: 220ms –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **–°—Ç–∞–Ω–µ—Ç**: 1-5ms –∏–∑ –∫–µ—à–∞ (—É–ª—É—á—à–µ–Ω–∏–µ –≤ 50-200 —Ä–∞–∑!)

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç:
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- –ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–∞–∂–µ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
- –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ –±–∞—Ç–∞—Ä–µ–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö

### –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É:
- –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î –Ω–∞ 70-80%
- –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –†–∏—Å–∫–∏ –∏ –∏—Ö –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:

1. **–†–∏—Å–∫**: –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ
   **–†–µ—à–µ–Ω–∏–µ**: WebSocket –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è + –∫–æ—Ä–æ—Ç–∫–∏–π TTL

2. **–†–∏—Å–∫**: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
   **–†–µ—à–µ–Ω–∏–µ**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–µ—à–∞ + –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞

3. **–†–∏—Å–∫**: –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏
   **–†–µ—à–µ–Ω–∏–µ**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + dev tools –¥–ª—è –∫–µ—à–∞

## –í—ã–≤–æ–¥:
–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ, –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –ù–∞—á–Ω–∏—Ç–µ —Å –≠—Ç–∞–ø–∞ 1 –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–≤–∏–≥–∞–π—Ç–µ—Å—å –¥–∞–ª—å—à–µ!