# План оптимизации базы данных UniFarm
Дата: 11.07.2025

## Этапы оптимизации

### Фаза 1: Критические исправления (Высокий приоритет)
1. **Удаление поля `users.last_active`**
   - Поле существует в БД, но не используется в коде
   - Действие: Создать миграцию для удаления поля из БД

2. **Консолидация дублирующихся полей**
   - `referred_by` vs `referrer_id` - выбрать одно поле
   - `uni_farming_deposit` vs `uni_deposit_amount` - выбрать одно поле
   - Действие: Анализ использования и миграция данных

3. **Проверка типов транзакций**
   - Убедиться что FARMING_DEPOSIT, BOOST_PURCHASE, DAILY_BONUS существуют в enum
   - Действие: Проверить и добавить недостающие типы

### Фаза 2: Структурная оптимизация (Средний приоритет)
4. **Очистка устаревших полей daily bonus**
   - `checkin_last_date`, `checkin_streak` больше не используются
   - Действие: Создать миграцию для удаления

5. **Решение по пустым таблицам**
   - Анализ необходимости 7 пустых таблиц
   - Действие: Удалить или реализовать функциональность

6. **Документация поля metadata**
   - Редко используется, нужно понять назначение
   - Действие: Документировать или удалить

### Фаза 3: Производительность (Низкий приоритет)
7. **Оптимизация индексов**
   - Добавить индексы на часто используемые поля
   
8. **Архивирование старых транзакций**
   - 595K+ записей могут замедлять систему

## Порядок выполнения
1. Сначала проверим текущее использование полей в коде
2. Создадим SQL миграции для изменений
3. Протестируем изменения на dev среде
4. Применим миграции к production БД