# –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–õ–ê–ù –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê JWT –ü–†–û–ë–õ–ï–ú

## üéØ –¶–ï–õ–¨
–°–æ–±—Ä–∞—Ç—å –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É JWT –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏—á–∏–Ω –ø–æ—Ç–µ—Ä–∏ 3 TON User ID 25.

## üìä –¢–ï–ö–£–©–ò–ï –§–ê–ö–¢–´

### ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´
1. **JWT —Ç–æ–∫–µ–Ω—ã –∏—Å—á–µ–∑–∞—é—Ç –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç** (–Ω–µ 7 –¥–Ω–µ–π –∫–∞–∫ –∑–∞–ª–æ–∂–µ–Ω–æ)
2. **Browser console:** "JWT —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
3. **User 25:** –ü–æ—Ç–µ—Ä—è–ª 3 TON (hash: te6cckECAgEAAKoAAeGIAMtaj5JhEoDmTGdtuWKu2Ndd7Q45BQhTz1ozLYdEVqaK...)
4. **–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å User 25:** 1.117185 TON (–æ–∂–∏–¥–∞–µ—Ç—Å—è 4+ TON)
5. **1% –≤—ã–≤–æ–¥–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è** –Ω–∞ –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ —Å–ø–∏—Å–∞–Ω–∏—è
6. **–°–∏—Å—Ç–µ–º–∞ —Å–µ–π—á–∞—Å:** –†–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó JWT —Ç–æ–∫–µ–Ω–∞ (–≤—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –ø–∞–¥–∞—é—Ç)

### üîç –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê
JWT —Ç–æ–∫–µ–Ω—ã **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è** —Å–∏—Å—Ç–µ–º–æ–π, –∞ –ù–ï –∏—Å—Ç–µ–∫–∞—é—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ. –ü—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –≤–æ–∑–º–æ–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î.

## üìã –ü–õ–ê–ù –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê

### 1Ô∏è‚É£ –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Browser DevTools ‚Üí Application ‚Üí LocalStorage ‚Üí –∫–ª—é—á "unifarm_jwt_token"
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network Tab ‚Üí –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 401 –æ—à–∏–±–æ–∫
- [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø–æ—è–≤–ª–µ–Ω–∏—è "JWT —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" 
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –¥–µ–ø–æ–∑–∏—Ç–∞/–≤—ã–≤–æ–¥–∞

### 2Ô∏è‚É£ BACKEND –ê–ù–ê–õ–ò–ó  
- [ ] –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞: JWT validation failures
- [ ] –ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–∑–æ–≤–æ–≤ `/api/v2/auth/telegram`
- [ ] 401 –æ—à–∏–±–∫–∏ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- [ ] JWT_SECRET —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞—Ö

### 3Ô∏è‚É£ TIMING –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï
- [ ] –í—Ä–µ–º—è –º–µ–∂–¥—É balance updates –∏ JWT recreation
- [ ] Database commit vs read timing
- [ ] WebSocket notification delays
- [ ] Race conditions –≤ UserContext

### 4Ô∏è‚É£ –í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–ï
- [ ] –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ø–æ—Ç–µ—Ä—é –¥–µ–ø–æ–∑–∏—Ç–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å withdrawal reversals
- [ ] –ò–∑—É—á–∏—Ç—å —Ç–æ—á–Ω—ã–π timing –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –°–¶–ï–ù–ê–†–ò–ò

### –°–¶–ï–ù–ê–†–ò–ô A: –ü–û–¢–ï–†–Ø 3 TON
```
31.07.2025, 08:07:00 - TON Connect –¥–µ–ø–æ–∑–∏—Ç 3 TON ‚úÖ
31.07.2025, 08:07:05 - Backend –ø–æ–ª—É—á–∞–µ—Ç –¥–µ–ø–æ–∑–∏—Ç ‚Üí –ë–î +3 TON ‚úÖ  
31.07.2025, 08:07:10 - WebSocket ‚Üí UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç +3 TON ‚úÖ
31.07.2025, 08:07:15 - JWT –¢–û–ö–ï–ù –ò–°–ß–ï–ó–ê–ï–¢ ‚ùå
31.07.2025, 08:07:20 - UserContext ‚Üí –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚ùå
31.07.2025, 08:07:25 - –ù–æ–≤—ã–π JWT —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ë–î ‚ùå
–†–ï–ó–£–õ–¨–¢–ê–¢: –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω —Å—Ç–∞—Ä—ã–º
```

### –°–¶–ï–ù–ê–†–ò–ô B: –í–û–ó–í–†–ê–¢ –í–´–í–û–î–û–í
```
XX:XX:00 - processWithdrawal() —Å–ø–∏—Å—ã–≤–∞–µ—Ç 1 TON ‚úÖ
XX:XX:01 - –ë–î –æ–±–Ω–æ–≤–ª–µ–Ω–∞: –±–∞–ª–∞–Ω—Å -1 TON ‚úÖ
XX:XX:02 - UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å ‚úÖ
XX:XX:05 - JWT –¢–û–ö–ï–ù –ò–°–ß–ï–ó–ê–ï–¢ (1% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å) ‚ùå
XX:XX:06 - –ü–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ –î–û —Å–ø–∏—Å–∞–Ω–∏—è ‚ùå
–†–ï–ó–£–õ–¨–¢–ê–¢: –î–µ–Ω—å–≥–∏ "–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è"
```

## üîç –ú–ï–°–¢–ê –ò–°–ß–ï–ó–ù–û–í–ï–ù–ò–Ø JWT

### 1. TELEGRAM WEBAPP
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–∞—Ç–æ–≤
- Background/foreground transitions
- Memory pressure cleanup
- App updates

### 2. BROWSER POLICIES
- Storage quota limits
- Incognito restrictions
- Security policies

### 3. BACKEND REJECTION
- verifyJWTToken() failures
- JWT_SECRET changes
- Clock skew issues

### 4. APPLICATION LOGIC
- Error handling cleanup
- Race conditions
- Multiple localStorage access

## ‚ö° –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ú–û–ù–ò–¢–û–†–ò–ù–ì** - –æ—Ç—Å–ª–µ–¥–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
2. **BACKEND –õ–û–ì–ò** - –∞–Ω–∞–ª–∏–∑ JWT validation errors
3. **TIMING –ê–ù–ê–õ–ò–ó** - database vs token recreation races
4. **–í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–ï** - –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢
–ü–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ JWT –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.