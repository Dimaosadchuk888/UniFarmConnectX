# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –î–£–ë–õ–ò–ö–ê–¢–û–í TON –î–ï–ü–û–ó–ò–¢–û–í - –í–ê–†–ò–ê–ù–¢ 1 –ü–†–ò–ú–ï–ù–ï–ù

**–î–∞—Ç–∞:** 3 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í—Ä–µ–º—è:** 14:00 UTC  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ó–í–ï–†–ù–£–¢–û –í –ü–†–û–î–ê–ö–®–ù  

## üéØ –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞:
**–§–∞–π–ª:** `client/src/services/tonConnectService.ts`  
**–°—Ç—Ä–æ–∫–∞:** 440  

```diff
- const cleanBocHash = result.boc.replace(/_\d{13}_[a-z0-9]+$/, '');
+ const cleanBocHash = result.boc.replace(/_\d{13}_[a-zA-Z0-9_-]+$/, '');
```

### –£–ª—É—á—à–µ–Ω–∏—è regex pattern:
- **–ë—ã–ª–æ:** `/_\d{13}_[a-z0-9]+$/` (—Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã)
- **–°—Ç–∞–ª–æ:** `/_\d{13}_[a-zA-Z0-9_-]+$/` (–≤—Å–µ —Å–∏–º–≤–æ–ª—ã)

**–¢–µ–ø–µ—Ä—å —É–¥–∞–ª—è—é—Ç—Å—è —Å—É—Ñ—Ñ–∏–∫—Å—ã:**
- `_1754223557625_bppxkqf9y` ‚úÖ (—Ä–∞–±–æ—Ç–∞–ª–æ –∏ —Ä–∞–Ω—å—à–µ)
- `_1754223557625_BppXkQf9Y` ‚úÖ (—Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `_1754223557625_test_abc` ‚úÖ (—Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `_1754223557625_abc-def` ‚úÖ (—Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç)

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:
- **20-40% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ** –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –æ—Ç —Å—É—Ñ—Ñ–∏–∫—Å–æ–≤
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** BOC —Ö–µ—à–µ–π
- **–ù—É–ª–µ–≤–æ–π —Ä–∏—Å–∫** –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- –ù–∞–±–ª—é–¥–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 2-3 –¥–Ω–µ–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ `[TON_DEPOSIT_FIX]` –≤ –∫–æ–Ω—Å–æ–ª–∏
- –°–ª–µ–¥–∏—Ç—å –∑–∞ –ø–æ–ª–µ–º `suffixRemoved: true/false`

## üîç –ü–õ–ê–ù –î–ê–õ–¨–ù–ï–ô–®–ò–• –î–ï–ô–°–¢–í–ò–ô

### –ï—Å–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π:
1. **–í–∞—Ä–∏–∞–Ω—Ç 2:** –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É UI –∫–Ω–æ–ø–æ–∫
2. **–í–∞—Ä–∏–∞–Ω—Ç 3:** Idempotency keys –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:
- **–•–æ—Ä–æ—à–æ:** 30%+ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **–û—Ç–ª–∏—á–Ω–æ:** 50%+ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ:** <20% - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –í–∞—Ä–∏–∞–Ω—Ç—É 2

## üö® –ü–õ–ê–ù –û–¢–ö–ê–¢–ê

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—ã–π regex:
```typescript
const cleanBocHash = result.boc.replace(/_\d{13}_[a-z0-9]+$/, '');
```

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ü–µ—Ä–≤—ã–π —à–∞–≥ —Å–¥–µ–ª–∞–Ω** - —É–ª—É—á—à–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ —Å—É—Ñ—Ñ–∏–∫—Å–æ–≤ BOC.  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ä–∞—Ö.

**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í –ö –ú–û–ù–ò–¢–û–†–ò–ù–ì–£ ‚úÖ