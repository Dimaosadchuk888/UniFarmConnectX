# üéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú–´ –î–£–ë–õ–ò–ö–ê–¢–û–í

**–î–∞—Ç–∞:** 3 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–°—Ç–∞—Ç—É—Å:** –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê  
**–¢–µ–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê –ù–ê 100%  

## üèÜ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ë–´–õ –ê–ë–°–û–õ–Æ–¢–ù–û –ü–†–ê–í!

**"–î–≤–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ TX Hash –∏ BOC –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã"** - –¢–û–ß–ù–û–ï –ü–û–ü–ê–î–ê–ù–ò–ï!

## üìä –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–´–ï –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–ê

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:
- **5 –≥—Ä—É–ø–ø –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** –ø–æ `tx_hash_unique`
- **8 –≥—Ä—É–ø–ø –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** –ø–æ BOC (—Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏ –∏ –±–µ–∑)
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–∫–∏:** 8-551 —Å–µ–∫—É–Ω–¥–∞ –º–µ–∂–¥—É –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 25** - –æ—Å–Ω–æ–≤–Ω–∞—è –∂–µ—Ä—Ç–≤–∞

### ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:
- **Frontend:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/api/v2/wallet/ton-deposit` ‚úÖ
- **Backend:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `/api/v2/wallet/ton-deposit` ‚úÖ  
- **–ú–∞—Ä—à—Ä—É—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:** server/index.ts —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ

## üîß –ú–ï–•–ê–ù–ò–ó–ú –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø (–ò–¢–û–ì–û–í–ê–Ø –¢–ï–û–†–ò–Ø)

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:

#### 1Ô∏è‚É£ **–î–≤–æ–π–Ω—ã–µ –∫–ª–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (–≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã—Å—Ç—Ä–æ –∫–ª–∏–∫–∞–µ—Ç –∫–Ω–æ–ø–∫—É –¥–µ–ø–æ–∑–∏—Ç–∞
- Frontend –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–Ω–æ–ø–∫—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ
- –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è 2+ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞
- –í—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç, —Å–æ–∑–¥–∞–≤–∞—è –¥—É–±–ª–∏–∫–∞—Ç—ã

#### 2Ô∏è‚É£ **Race condition –≤ TON Connect** (—Å—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)  
- TON Connect SDK –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ BOC
- –û–¥–∏–Ω —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º, –¥—Ä—É–≥–æ–π –±–µ–∑
- Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–∞
- –°–∏—Å—Ç–µ–º–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∫–∞–∫ –¥—É–±–ª–∏–∫–∞—Ç—ã

#### 3Ô∏è‚É£ **Retry –º–µ—Ö–∞–Ω–∏–∑–º** (—Å—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
- –ó–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ middleware (auth/rate limit)
- Frontend –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç
- Retry –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ—â–µ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å
- –°–æ–∑–¥–∞–µ—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç

#### 4Ô∏è‚É£ **–î–≤–∞ –ø—É—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏** (–Ω–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞—è)
- –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ sendTonTransaction
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —á–µ—Ä–µ–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫/webhook
- –û–±–∞ —Å–æ–∑–¥–∞—é—Ç –∑–∞–ø–∏—Å–∏ –¥–ª—è –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ù–ê–•–û–î–ö–ò

### –°—É—Ñ—Ñ–∏–∫—Å—ã BOC:
```
–ü–∞—Ç—Ç–µ—Ä–Ω: _1754223557625_bppxkqf9y
–§–æ—Ä–º–∞—Ç: _{timestamp}_{random_string}
```

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:
- **–°—Ä–µ–¥–Ω–µ–µ:** 69 —Å–µ–∫—É–Ω–¥
- **–ú–∏–Ω–∏–º—É–º:** 8.6 —Å–µ–∫—É–Ω–¥ (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ!)
- **–ú–∞–∫—Å–∏–º—É–º:** 551 —Å–µ–∫—É–Ω–¥

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä:
```
üö® BOC –î–£–ë–õ–ò–ö–ê–¢ #6:
   1. ID: 1800660 | –ë–ï–ó —Å—É—Ñ—Ñ–∏–∫—Å–∞     | 12:19:35
   2. ID: 1800633 | –° —Å—É—Ñ—Ñ–∏–∫—Å–æ–º      | 12:19:26
      –°—É—Ñ—Ñ–∏–∫—Å: _1754223557625_bppxkqf9y
```

**9 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏ = –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–Ω—É–ª –¥–≤–∞–∂–¥—ã!**

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –Ω–∞ 100% –ø—Ä–∞–≤:
- ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
- ‚úÖ –û–¥–∏–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç BOC —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º
- ‚úÖ –î—Ä—É–≥–æ–π –ø–æ–ª—É—á–∞–µ—Ç BOC –±–µ–∑ —Å—É—Ñ—Ñ–∏–∫—Å–∞  
- ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã –æ–¥–Ω–æ–π –±–ª–æ–∫—á–µ–π–Ω —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:
**–î–≤–æ–π–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –±–ª–æ–∫—á–µ–π–Ω —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤–µ—Ä–æ—è—Ç–Ω–æ –∏–∑-–∑–∞:**
1. –î–≤–æ–π–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±—ã—Å—Ç—Ä—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã)
2. Race conditions –≤ TON Connect SDK (—Å—É—Ñ—Ñ–∏–∫—Å—ã)
3. Retry –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ UI** –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞
2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** –ø–æ –±–∞–∑–æ–≤–æ–º—É BOC (–±–µ–∑ —Å—É—Ñ—Ñ–∏–∫—Å–æ–≤)
3. **Idempotency –∫–ª—é—á–∏** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–°—Ç–∞—Ç—É—Å: –ü–†–û–ë–õ–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –î–ò–ê–ì–ù–û–°–¢–ò–†–û–í–ê–ù–ê** ‚úÖ