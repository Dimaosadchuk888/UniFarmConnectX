# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ù–ï–°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –ò–ú–ü–û–†–¢–û–í TON CONNECT

**–î–∞—Ç–∞**: 19 —è–Ω–≤–∞—Ä—è 2025  
**–í—Ä–µ–º—è**: 8:45 UTC  
**–°—Ç–∞—Ç—É—Å**: üî• –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

---

## üîç **–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –ü–†–û–ë–õ–ï–ú–´**

### **‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏**

```typescript
// UserContext.tsx (—Å—Ç—Ä–æ–∫–∏ 7-12) - –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô –ò–ú–ü–û–†–¢
import { 
  getWalletAddress,           // ‚ùå –§–£–ù–ö–¶–ò–Ø –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢
  isWalletConnected,          // ‚ùå –§–£–ù–ö–¶–ò–Ø –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢  
  connectWallet as connectTonWallet,
  disconnectWallet as disconnectTonWallet
} from '@/services/tonConnectService';

// TonDepositCard.tsx (—Å—Ç—Ä–æ–∫–∏ 9-15) - –ü–†–ê–í–ò–õ–¨–ù–´–ô –ò–ú–ü–û–†–¢
import { 
  isTonWalletConnected,       // ‚úÖ –§–£–ù–ö–¶–ò–Ø –°–£–©–ï–°–¢–í–£–ï–¢
  connectTonWallet,
  sendTonTransaction,
  saveTonWalletAddress,
  getTonWalletAddress         // ‚úÖ –§–£–ù–ö–¶–ò–Ø –°–£–©–ï–°–¢–í–£–ï–¢
} from '@/services/tonConnectService';
```

---

## üìä **–î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´**

### **1. –§–£–ù–ö–¶–ò–ò –í tonConnectService.ts**

```typescript
// ‚úÖ –†–ï–ê–õ–¨–ù–û –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –§–£–ù–ö–¶–ò–ò:
export async function getTonWalletAddress(tonConnectUI, format) { ... }
export function isTonWalletConnected(tonConnectUI) { ... }
export async function connectTonWallet(tonConnectUI) { ... }
export async function disconnectTonWallet(tonConnectUI) { ... }

// ‚úÖ –ê–õ–ò–ê–°–´ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏):
export const getWalletAddress = (tonConnectUI) => getTonWalletAddress(tonConnectUI, 'user-friendly');
export const connectWallet = connectTonWallet;
export const disconnectWallet = disconnectTonWallet;

// ‚ùå –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢:
export function isWalletConnected() // –û–¢–°–£–¢–°–¢–í–£–ï–¢
```

### **2. –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –í UserContext.tsx**

```typescript
// ‚ùå –ü–†–û–ë–õ–ï–ú–ù–´–ï –í–´–ó–û–í–´:
const connected = isWalletConnected(tonConnectUI);  // TypeError: isWalletConnected is not a function
const address = await getWalletAddress(tonConnectUI); // –†–∞–±–æ—Ç–∞–µ—Ç (–µ—Å—Ç—å –∞–ª–∏–∞—Å)
```

### **3. –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –í TonDepositCard.tsx**

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ï –í–´–ó–û–í–´:
const connected = isTonWalletConnected(tonConnectUI);  // –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
const address = await getTonWalletAddress(tonConnectUI); // –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## üéØ **–í–õ–ò–Ø–ù–ò–ï –ù–ê –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨**

### **‚ùå –°–õ–û–ú–ê–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´:**
1. **UserContext.tsx** - –ù–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
2. **Wallet —Å—Ç—Ä–∞–Ω–∏—Ü–∞** - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. **TON Connect –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –ß–∞—Å—Ç–∏—á–Ω–æ –Ω–µ—Ä–∞–±–æ—á–∞—è
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—à–µ–ª—å–∫–∞** - –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### **‚úÖ –†–ê–ë–û–¢–ê–Æ–©–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´:**
1. **TonDepositCard.tsx** - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ)
2. **–ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - getTonWalletAddress, connectTonWallet —Ä–∞–±–æ—Ç–∞—é—Ç
3. **API endpoints** - Backend —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω

---

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò –û–®–ò–ë–ö–ò**

### **JavaScript Console Error:**
```javascript
TypeError: isWalletConnected is not a function
    at UserContext.tsx:497 (checkWalletConnection)
    at UserContext.tsx:523 (useEffect timeout)
```

### **–¶–µ–ø–æ—á–∫–∞ –æ—à–∏–±–æ–∫:**
```
1. UserContext –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚Üí useEffect –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
2. checkWalletConnection() –≤—ã–∑—ã–≤–∞–µ—Ç isWalletConnected(tonConnectUI)
3. JavaScript –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç TypeError
4. Catch –±–ª–æ–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç wallet: { connected: false }
5. UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—à–µ–ª–µ–∫ –∫–∞–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–π
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –æ—à–∏–±–∫—É
```

---

## üìà **–î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ê–Ø –¶–ï–ü–û–ß–ö–ê**

### **–£—Ä–æ–≤–µ–Ω—å 1: –ë—Ä–∞—É–∑–µ—Ä–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (95%)**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ - –∫—ç—à–∏ –æ—á–∏—â–µ–Ω—ã
- ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã  
- ‚ùå **–ù–ï –†–ï–®–ò–õ–û –ü–†–û–ë–õ–ï–ú–£**

### **–£—Ä–æ–≤–µ–Ω—å 2: –ò–º–ø–æ—Ä—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–û–ë–ù–ê–†–£–ñ–ï–ù–û)**
- ‚ùå UserContext –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞–ª–∏–∞—Å isWalletConnected  
- ‚úÖ **–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –ù–ê–ô–î–ï–ù–ê**

---

## üõ†Ô∏è **–ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ UserContext**
```typescript
// –ó–ê–ú–ï–ù–ò–¢–¨:
import { 
  getWalletAddress, 
  isWalletConnected,        // ‚ùå –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢
  connectWallet as connectTonWallet,
  disconnectWallet as disconnectTonWallet
} from '@/services/tonConnectService';

// –ù–ê:
import { 
  getTonWalletAddress as getWalletAddress,
  isTonWalletConnected as isWalletConnected,  // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –ù–ê–ó–í–ê–ù–ò–ï
  connectTonWallet,
  disconnectTonWallet
} from '@/services/tonConnectService';
```

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –∞–ª–∏–∞—Å**
```typescript
// –í tonConnectService.ts –¥–æ–±–∞–≤–∏—Ç—å:
export const isWalletConnected = isTonWalletConnected;
```

---

## üéØ **–ü–†–ò–û–†–ò–¢–ï–¢ –î–ï–ô–°–¢–í–ò–ô**

### **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (—Å–µ–π—á–∞—Å):**
1. ‚ùå **–°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω** - —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
2. ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã** - UserContext —Å–ª–æ–º–∞–Ω

### **–í–´–°–û–ö–ò–ô (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞):**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ UserContext.tsx
2. –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∞–ª–∏–∞—Å—ã –≤ tonConnectService.ts
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞

---

## üìã **–ü–†–û–í–ï–†–û–ß–ù–´–ô –°–ü–ò–°–û–ö**

### **‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- [x] Backend API endpoints —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- [x] TonDepositCard.tsx –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã  
- [x] getTonWalletAddress() —Ñ—É–Ω–∫—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [x] –ö—ç—à–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –æ—á–∏—â–µ–Ω—ã

### **‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã:**
- [ ] UserContext.tsx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é isWalletConnected
- [ ] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞–ª–∏–∞—Å isWalletConnected –≤ tonConnectService.ts
- [ ] –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω

---

## üîÆ **–ü–†–û–ì–ù–û–ó –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **95% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å** - –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
- **90% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å** - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –≤ UI
- **85% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å** - –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö JavaScript –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

### **–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:** 2-3 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ TON Connect

---

## ‚úÖ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

**–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –ù–ê–ô–î–ï–ù–ê**: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π –º–µ–∂–¥—É UserContext –∏ tonConnectService.

**–†–ï–®–ï–ù–ò–ï**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∞–ª–∏–∞—Å—ã.

**–ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ**: 100% - –ø—Ä–æ–±–ª–µ–º–∞ —á–µ—Ç–∫–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞.

---

*–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞. –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.*