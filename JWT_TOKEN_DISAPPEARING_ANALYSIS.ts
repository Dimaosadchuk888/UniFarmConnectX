/**
 * –ì–õ–£–ë–û–ö–ò–ô –ê–ù–ê–õ–ò–ó: –ü–û–ß–ï–ú–£ JWT –¢–û–ö–ï–ù–´ –ò–°–ß–ï–ó–ê–Æ–¢
 * 
 * –ó–∞–¥–∞—á–∞: –ù–∞–π—Ç–∏ —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤
 * –ó–∞–ø—Ä–µ—Ç: –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
 */

console.log('üîç –ê–ù–ê–õ–ò–ó –ò–°–ß–ï–ó–ù–û–í–ï–ù–ò–Ø JWT –¢–û–ö–ï–ù–û–í');
console.log('=================================');

console.log('\nüìä –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –§–ê–ö–¢–´:');
console.log('‚úÖ –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ JWT: 7 –¥–Ω–µ–π (604800 —Å–µ–∫—É–Ω–¥)');
console.log('‚ùå –†–µ–∞–ª—å–Ω–æ—Å—Ç—å: —Ç–æ–∫–µ–Ω—ã –∏—Å—á–µ–∑–∞—é—Ç –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç');
console.log('üîÑ Browser console: "JWT —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" –ø–æ—Å—Ç–æ—è–Ω–Ω–æ');
console.log('üì± User experience: "—Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏"');

console.log('\nüéØ –ú–ï–°–¢–ê –£–î–ê–õ–ï–ù–ò–Ø –¢–û–ö–ï–ù–û–í:');

console.log('\n1Ô∏è‚É£ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –£–î–ê–õ–ï–ù–ò–ï –í correctApiRequest.ts:');
console.log('   –°—Ç—Ä–æ–∫–∏ 214-235 (catch –±–ª–æ–∫):');
console.log('   - –ü—Ä–∏ 401 –æ—à–∏–±–∫–µ: localStorage.removeItem("unifarm_jwt_token")');
console.log('   - –ü—Ä–∏ network errors: –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–∫–µ–Ω');
console.log('   - –ü—Ä–∏ validation failures: –æ—á–∏—Å—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞');
console.log('   ‚ö° –ì–ò–ü–û–¢–ï–ó–ê: Backend —á–∞—Å—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç 401 ‚Üí —Ç–æ–∫–µ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è');

console.log('\n2Ô∏è‚É£ USERCONTEXT –ü–ï–†–ï–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø:');
console.log('   –°—Ç—Ä–æ–∫–∏ 258-328 (refreshUserData):');
console.log('   - –ü—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏: –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞');
console.log('   - Race conditions –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏');
console.log('   - authorizationAttemptedRef –º–æ–∂–µ—Ç —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è');
console.log('   ‚ö° –ì–ò–ü–û–¢–ï–ó–ê: –ß–∞—Å—Ç—ã–µ –≤—ã–∑–æ–≤—ã refreshUserData() –æ—á–∏—â–∞—é—Ç —Ç–æ–∫–µ–Ω—ã');

console.log('\n3Ô∏è‚É£ TELEGRAM WEBAPP –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:');
console.log('   - localStorage –º–æ–∂–µ—Ç –æ—á–∏—â–∞—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —á–∞—Ç–æ–≤');
console.log('   - Telegram –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å storage –≤ background');
console.log('   - WebApp lifecycle –º–æ–∂–µ—Ç –æ—á–∏—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ');
console.log('   ‚ö° –ì–ò–ü–û–¢–ï–ó–ê: Telegram WebApp –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –æ—á–∏—â–∞–µ—Ç localStorage');

console.log('\n4Ô∏è‚É£ BACKEND JWT –í–ê–õ–ò–î–ê–¶–ò–Ø:');
console.log('   verifyJWTToken() –≤ utils/telegram.ts:');
console.log('   - –ú–æ–∂–µ—Ç –æ—Ç–∫–ª–æ–Ω—è—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–∑-–∑–∞ time sync');
console.log('   - JWT_SECRET –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ restart');
console.log('   - Clock skew –º–µ–∂–¥—É client/server');
console.log('   ‚ö° –ì–ò–ü–û–¢–ï–ó–ê: Backend –æ—Ç–∫–ª–æ–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω—ã ‚Üí 401 ‚Üí —É–¥–∞–ª–µ–Ω–∏–µ');

console.log('\nüö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–¶–ï–ù–ê–†–ò–ô - –ü–û–¢–ï–†–Ø 3 TON:');
console.log('31.07.2025, 08:07:00 - TON Connect –¥–µ–ø–æ–∑–∏—Ç 3 TON');
console.log('31.07.2025, 08:07:05 - Backend –ø–æ–ª—É—á–∞–µ—Ç –¥–µ–ø–æ–∑–∏—Ç ‚Üí –ë–î –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
console.log('31.07.2025, 08:07:10 - WebSocket ‚Üí UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç +3 TON');
console.log('31.07.2025, 08:07:15 - JWT –¢–û–ö–ï–ù –ò–°–ß–ï–ó–ê–ï–¢ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç)');
console.log('31.07.2025, 08:07:20 - UserContext ‚Üí refreshUserData()');
console.log('31.07.2025, 08:07:25 - /api/v2/auth/telegram ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ JWT');
console.log('31.07.2025, 08:07:30 - –ù–æ–≤—ã–π JWT —Å –¥–∞–Ω–Ω—ã–º–∏ –ë–î –ù–ê –ú–û–ú–ï–ù–¢ –°–û–ó–î–ê–ù–ò–Ø');
console.log('üí∏ –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ –ë–î —á–∏—Ç–∞–µ—Ç—Å—è –î–û –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Üí —Å—Ç–∞—Ä—ã–π –±–∞–ª–∞–Ω—Å');

console.log('\nüö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –°–¶–ï–ù–ê–†–ò–ô - –í–û–ó–í–†–ê–¢ –í–´–í–û–î–û–í:');
console.log('XX:XX:00 - processWithdrawal() —Å–ø–∏—Å—ã–≤–∞–µ—Ç 1 TON');
console.log('XX:XX:01 - –ë–î –æ–±–Ω–æ–≤–ª–µ–Ω–∞: –±–∞–ª–∞–Ω—Å -1 TON');
console.log('XX:XX:02 - UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å');
console.log('XX:XX:05 - JWT –¢–û–ö–ï–ù –ò–°–ß–ï–ó–ê–ï–¢');
console.log('XX:XX:06 - UserContext ‚Üí –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è');
console.log('XX:XX:07 - –ù–æ–≤—ã–π JWT —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ –ë–î');
console.log('üí∏ –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ —á–∏—Ç–∞–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π –±–∞–ª–∞–Ω—Å ‚Üí –¥–µ–Ω—å–≥–∏ "–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è"');

console.log('\nüîç –ß–ê–°–¢–û–¢–ê –ò–°–ß–ï–ó–ù–û–í–ï–ù–ò–Ø:');
console.log('–ò–∑ browser console –≤–∏–¥–Ω–æ —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –∏—Å—á–µ–∑–∞—é—Ç –ü–û–°–¢–û–Ø–ù–ù–û');
console.log('–ö–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç: "JWT —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"');
console.log('–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ (7 –¥–Ω–µ–π)');
console.log('–ê –≤ —á–∞—Å—Ç–æ–º –£–î–ê–õ–ï–ù–ò–ò —Ç–æ–∫–µ–Ω–æ–≤ —Å–∏—Å—Ç–µ–º–æ–π');

console.log('\n‚ö° –ö–õ–Æ–ß–ï–í–´–ï –í–û–ü–†–û–°–´:');
console.log('1. –ö–∞–∫–æ–π HTTP —Å—Ç–∞—Ç—É—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Backend —á–∞—â–µ –≤—Å–µ–≥–æ?');
console.log('2. –ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è refreshUserData()?');
console.log('3. –ï—Å—Ç—å –ª–∏ 401 –æ—à–∏–±–∫–∏ –≤ Network tab?');
console.log('4. –°—Ç–∞–±–∏–ª–µ–Ω –ª–∏ JWT_SECRET –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?');
console.log('5. –ï—Å—Ç—å –ª–∏ race conditions –ø—Ä–∏ balance updates?');

console.log('\nüö® –ì–õ–ê–í–ù–ê–Ø –ì–ò–ü–û–¢–ï–ó–ê:');
console.log('Backend —á–∞—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized');
console.log('‚Üí correctApiRequest —É–¥–∞–ª—è–µ—Ç —Ç–æ–∫–µ–Ω');
console.log('‚Üí UserContext –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π');
console.log('‚Üí –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ');
console.log('‚Üí –ë–∞–ª–∞–Ω—Å—ã –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏');

console.log('\nüìã –ù–£–ñ–ù–ê –ü–†–û–í–ï–†–ö–ê:');
console.log('1. Network tab: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 401 –æ—à–∏–±–æ–∫');
console.log('2. –õ–æ–≥–∏ Backend: JWT validation failures');
console.log('3. –ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–∑–æ–≤–æ–≤ /api/v2/auth/telegram');
console.log('4. Timing –º–µ–∂–¥—É balance updates –∏ JWT recreation');

console.log('\n‚ö° –°–¢–ê–¢–£–°: –¢–û–ö–ï–ù–´ –£–î–ê–õ–Ø–Æ–¢–°–Ø –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û - –ù–ï –ò–°–¢–ï–ö–ê–Æ–¢ –ï–°–¢–ï–°–¢–í–ï–ù–ù–û');