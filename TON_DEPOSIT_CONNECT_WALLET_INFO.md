# üö® –°–†–û–ß–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø: –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ TON –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ Connect Wallet

## üì± –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è TON –±–∞–ª–∞–Ω—Å–∞

### 1Ô∏è‚É£ UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: TonDepositCard
**–§–∞–π–ª:** `client/src/components/wallet/TonDepositCard.tsx`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ —Å—É–º–º—ã –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫" –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å" –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### 2Ô∏è‚É£ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
```javascript
// –§—É–Ω–∫—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
await connectTonWallet(tonConnectUI);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
isTonWalletConnected(tonConnectUI);

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –≤ –ë–î
await saveTonWalletAddress(address);
```

### 3Ô∏è‚É£ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω
**–§–∞–π–ª:** `client/src/services/tonConnectService.ts`

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **–ê–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è:** `UQBlrUfJMIlAcyYzttyxV2xrrvaHHIKEKeetGZbDoitTRWT8`
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:** 10 –º–∏–Ω—É—Ç (600 —Å–µ–∫—É–Ω–¥)
- **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:** 1 TON = 1,000,000,000 –Ω–∞–Ω–æTON

**–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–ø—Ä–∞–≤–∫–∏:**
```javascript
// –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
const transaction = {
  validUntil: Math.floor(Date.now() / 1000) + 600,
  messages: [{
    address: "UQBlrUfJMIlAcyYzttyxV2xrrvaHHIKEKeetGZbDoitTRWT8",
    amount: nanoTonAmount, // –°—É–º–º–∞ –≤ –Ω–∞–Ω–æTON
    payload: base64Payload // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ base64
  }]
};

// –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ TON Connect
const result = await tonConnectUI.sendTransaction(transaction);
```

### 4Ô∏è‚É£ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–µ–ø–æ–∑–∏—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º–µ
**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω:**

**Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å:**
```
POST /api/v2/wallet/ton-deposit
{
  "user_id": 184,
  "ton_tx_hash": "hash_—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏",
  "amount": 5.0,
  "wallet_address": "–∞–¥—Ä–µ—Å_–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è"
}
```

### 5Ô∏è‚É£ Backend –æ–±—Ä–∞–±–æ—Ç–∫–∞
**–§–∞–π–ª:** `modules/wallet/controller.ts` ‚Üí `tonDeposit()`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ tx_hash
3. –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ TON –Ω–∞ –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ BalanceManager
4. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ç–∏–ø–∞ 'DEPOSIT'
5. –í–æ–∑–≤—Ä–∞—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ú–û–ú–ï–ù–¢–´

### üî¥ –ü—Ä–æ–±–ª–µ–º–∞ —Å BOC (Bag of Cells)
–í —Ñ–∞–π–ª–µ `tonConnectService.ts` –µ—Å—Ç—å —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
```javascript
// –°—Ç—Ä–æ–∫–∞ 53-64: –í–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ BOC –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–µ base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
// –≠—Ç–æ –ù–ï —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É TON!
const bocBytes = new TextEncoder().encode(comment);
return uint8ArrayToBase64(bocBytes);
```
**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–≥—É—Ç –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ TON –±–ª–æ–∫—á–µ–π–Ω–æ–º

### üü° –ê–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
- –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ –∫–æ–¥–µ: `UQBlrUfJMIlAcyYzttyxV2xrrvaHHIKEKeetGZbDoitTRWT8`
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ `VITE_TON_BOOST_RECEIVER_ADDRESS`
- **–í–ê–ñ–ù–û:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞!

### üü¢ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç tx_hash –≤ –ë–î –ø–µ—Ä–µ–¥ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ–º
- –û–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–≤–∞–∂–¥—ã

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã:**
- ‚úÖ UI —Ñ–æ—Ä–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TON Connect
- ‚úÖ Backend API endpoint
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- ‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è BOC payload
- ‚ö†Ô∏è –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
- ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ

## üîß –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–ö–æ—à–µ–ª–µ–∫"
2. –ù–∞–π–¥–∏—Ç–µ –±–ª–æ–∫ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON"
3. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫"
4. –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –∏ –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å"
5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –∫–æ—à–µ–ª—å–∫–µ
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

**–õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:**
- Frontend: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
- Backend: –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[Wallet] TON deposit`