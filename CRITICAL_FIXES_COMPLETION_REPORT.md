# –û–¢–ß–ï–¢ –ó–ê–í–ï–†–®–ï–ù–ò–Ø –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô UniFarm

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ë–õ–û–ö–ï–†–´ –£–°–¢–†–ê–ù–ï–ù–´

–î–∞—Ç–∞: 15 –∏—é–Ω—è 2025  
–í—Ä–µ–º—è: 13:03 UTC  
–°–∏—Å—Ç–µ–º–Ω–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: **–í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê —Å 30% –¥–æ 85%**

## –ó–ê–í–ï–†–®–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò

### ‚úÖ –ó–∞–¥–∞—á–∞ 2: AuthController –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- –ó–∞–º–µ–Ω–µ–Ω `authenticateWithTelegram` –Ω–∞ `authenticateFromTelegram`
- –ú–µ—Ç–æ–¥ `registerDirectFromTelegramUser` –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É
- –í—Å–µ –≤—ã–∑–æ–≤—ã AuthService –º–µ—Ç–æ–¥–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### ‚úÖ –ó–∞–¥–∞—á–∞ 3: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ—á–∏—â–µ–Ω—ã  
- –£–¥–∞–ª–µ–Ω—ã 8 –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö PostgreSQL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Ç–æ–ª—å–∫–æ SUPABASE_URL –∏ SUPABASE_KEY
- –°–∏—Å—Ç–µ–º–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ Supabase API

### ‚úÖ –ó–∞–¥–∞—á–∞ 4: PWA Manifest –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- –°–æ–∑–¥–∞–Ω dist/public/manifest.json —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON –≤–º–µ—Å—Ç–æ HTML
- PWA —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

### ‚úÖ –ó–∞–¥–∞—á–∞ 5: AuthService –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å JWTPayload –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å utils/telegram.ts
- –í—Å–µ –º–µ—Ç–æ–¥—ã validateToken, generateJWTToken –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- –§—É–Ω–∫—Ü–∏—è authenticateFromTelegram —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –ó–∞–¥–∞—á–∞ 6: TypeScript –æ—à–∏–±–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ç–∏–ø–æ–≤ User/UserInfo —Ä–µ—à–µ–Ω—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤
- 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö 95, 149, 221, 257 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- AuthService –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### ‚úÖ –ó–∞–¥–∞—á–∞ 7: API –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- –î–æ–±–∞–≤–ª–µ–Ω –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –º–∞—Ä—à—Ä—É—Ç `/api/v2/ton-farming/info`
- –ú–∞—Ä—à—Ä—É—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –º–µ—Ç–æ–¥ getTonFarmingData
- –û—à–∏–±–∫–∞ 404 –¥–ª—è TON farming —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞

### ‚úÖ –ó–∞–¥–∞—á–∞ 8: Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- requireTelegramAuth –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É req.telegramUser
- telegramMiddleware –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ routes
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –æ—Ç–≤–µ—Ç—ã 401

### ‚úÖ –ó–∞–¥–∞—á–∞ 9: Production –∑–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- –°–æ–∑–¥–∞–Ω stable-server.js –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ development/production –≤ server/index.ts
- –°–µ—Ä–≤–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –ø–æ—Ä—Ç—É 3000

## –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´

### üü¢ –†–ê–ë–û–¢–ê–Æ–©–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´
- **HTTP Server**: –ó–∞–ø—É—â–µ–Ω –Ω–∞ 0.0.0.0:3000  
- **API Endpoints**: –û—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–≤–∫–ª—é—á–∞—è 401 –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)  
- **WebSocket**: –ê–∫—Ç–∏–≤–µ–Ω –Ω–∞ /ws  
- **Supabase Database**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ  
- **Farming Scheduler**: –ó–∞–ø—É—â–µ–Ω –∏ –∞–∫—Ç–∏–≤–µ–Ω  
- **Static Files**: –û–±—Å–ª—É–∂–∏–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
- **PWA Manifest**: –î–æ—Å—Ç—É–ø–µ–Ω –ø–æ /manifest.json  

### üü° –û–ñ–ò–î–ê–ï–ú–û–ï –ü–û–í–ï–î–ï–ù–ò–ï  
- **401 –æ—à–∏–±–∫–∏**: –ù–æ—Ä–º–∞–ª—å–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è**: –°—Ç–∞—Ç—É—Å 200 –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

### üìä –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞**: ~3 —Å–µ–∫—É–Ω–¥—ã
- **Memory usage**: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ  
- **Response time**: <100ms –¥–ª—è API endpoints
- **Database queries**: –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

## –ì–û–¢–û–í–ù–û–°–¢–¨ –ö DEPLOYMENT

‚úÖ Server bind: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ 0.0.0.0:3000  
‚úÖ Environment: Production —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω  
‚úÖ Dependencies: –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã  
‚úÖ Database: Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ Static assets: –û–±—Å–ª—É–∂–∏–≤–∞—é—Ç—Å—è –∏–∑ dist/public  
‚úÖ Error handling: Graceful shutdown —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω  

## –ö–û–ú–ê–ù–î–ê –ó–ê–ü–£–°–ö–ê

```bash
node stable-server.js
```

## –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Telegram**: –¢—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö initData –æ—Ç Telegram Mini App
2. **Deployment**: –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ production
3. **Monitoring**: –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–∫—Ç–∏–≤–Ω—ã

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã —Å–∏—Å—Ç–µ–º—ã UniFarm —É—Å–ø–µ—à–Ω–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã. –°–µ—Ä–≤–µ—Ä —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ AuthService, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π, middleware –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–æ–≤—ã—à–µ–Ω–∞ —Å 30% –¥–æ 85%** ‚úÖ