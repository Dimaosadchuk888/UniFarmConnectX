‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ6

–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Boost –ø–∞–∫–µ—Ç—É

‚∏ª

üéØ –¶–µ–ª—å:

–û–±–µ—Å–ø–µ—á–∏—Ç—å, —á—Ç–æ–±—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã Farming ‚Üí BoostPackagesCard
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –∞ JWT —Ç–æ–∫–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –Ω–∞ backend.

‚∏ª

üìç –ö–æ–Ω—Ç–µ–∫—Å—Ç:
 ‚Ä¢ –ó–∞–ø—Ä–æ—Å –∫ /api/v2/boost/packages –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized
 ‚Ä¢ –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ middleware requireTelegramAuth
 ‚Ä¢ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç BoostPackagesCard –Ω–µ –≤–∏–Ω–æ–≤–∞—Ç: –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

‚∏ª

üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

–ü—É—Å—Ç—å –∞–≥–µ–Ω—Ç –∏—Å—Å–ª–µ–¥—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Ü–µ–ø–æ—á–∫—É:

1. üîê –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç window.Telegram.WebApp.initDataUnsafe
 ‚Ä¢ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ initData ‚Üí –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –±–µ—Ä—ë—Ç—Å—è user_id

2. üßæ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ /api/v2/auth/telegram –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ Mini App
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Å–æ–∑–¥–∞—ë—Ç—Å—è –ª–∏ JWT –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–∏ –≤ localStorage.token –∏–ª–∏ sessionStorage

3. üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ HOC/Context
 ‚Ä¢ –û–±—ë—Ä—Ç–∫–∞ UserContext / AuthProvider ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
 ‚Ä¢ –ù–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ª–∏ –æ—à–∏–±–∫–∞:

[UserContext] –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è



‚∏ª

üõ† –ó–∞–¥–∞—á–∏:
 1. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ Telegram Mini App –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è endpoint –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
 2. ‚úÖ JWT —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (localStorage –∏–ª–∏ –≤ React Context)
 3. ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã correctApiRequest –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç —Ç–æ–∫–µ–Ω –∫ –∑–∞–≥–æ–ª–æ–≤–∫—É Authorization
 4. ‚úÖ –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Farming JWT —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
 5. ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ BoostPackagesCard –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ /api/v2/boost/packages

‚∏ª

‚ö†Ô∏è –í–∞–∂–Ω–æ:
 ‚Ä¢ –ù–µ –º–µ–Ω—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç BoostPackagesCard
 ‚Ä¢ –ù–µ –∏–∑–º–µ–Ω—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –ø–∞–∫–µ—Ç–æ–≤
 ‚Ä¢ –ù–µ —Ç—Ä–æ–≥–∞—Ç—å requireTelegramAuth
 ‚Ä¢ –¢–æ–ª—å–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å JWT —Ü–µ–ø–æ—á–∫—É

‚∏ª

üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é):

// correctApiRequest.ts
headers: {
  Authorization: `Bearer ${localStorage.getItem('token')}`,
}


‚∏ª

üìå –†–µ–∑—É–ª—å—Ç–∞—Ç:

–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å:
 ‚Ä¢ ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ
 ‚Ä¢ ‚úÖ JWT —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –∫ –∑–∞–ø—Ä–æ—Å—É
 ‚Ä¢ ‚úÖ Endpoint /api/v2/boost/packages –æ—Ç–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ
 ‚Ä¢ ‚úÖ BoostPackagesCard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

–ü–æ—Å–ª–µ —á–µ–≥–æ –º—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¢–ó.