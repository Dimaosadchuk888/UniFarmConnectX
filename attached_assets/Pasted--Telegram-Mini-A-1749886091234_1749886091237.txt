üéØ –¶–µ–ª—å:

–û–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–¥–µ–∂–Ω—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ Telegram Mini App:
 ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ref_code,
 ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ telegram_id, username,
 ‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏–µ JWT,
 ‚Ä¢ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Mini App (—Ä–µ—Ñ. —Å—Å—ã–ª–∫–∞ –∏ –¥–æ—Ö–æ–¥—ã –ø–∞—Ä—Ç–Ω—ë—Ä–∫–∏).

‚∏ª

üìå –ö–æ–Ω—Ç–µ–∫—Å—Ç:

–°–µ–π—á–∞—Å:
 ‚Ä¢ Telegram Mini App —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç initData (username –≤–∏–¥–Ω–æ);
 ‚Ä¢ ‚ùå –ó–∞–ø–∏—Å—å –≤ –ë–î (users) –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è;
 ‚Ä¢ ‚ùå JWT —Ç–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è;
 ‚Ä¢ ‚ùå –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è;
 ‚Ä¢ ‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, –∏ API /api/v2/referral/info –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É.

‚∏ª

‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
 1. –†–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã:
 ‚Ä¢ ‚ùó –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –ª–æ–≥–∏–∫–∏ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–π;
 ‚Ä¢ ‚ùó –ù–µ –ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ref_code, –ø—Ä–æ–≤–µ—Ä–∫–∞ telegram_id);
 ‚Ä¢ –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å/–∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –µ—ë –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π:
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è:
 ‚Ä¢ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
 ‚Ä¢ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ref_code;
 ‚Ä¢ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç JWT;
 ‚Ä¢ –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—Ç, —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é ‚Äî —Å—Ç—Ä–æ–≥–æ –≤ –º–æ–¥—É–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.
 3. –ü–æ—Ä—è–¥–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
 ‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram.WebApp.initDataRaw;
 ‚Ä¢ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ /api/v2/auth/telegram;
 ‚Ä¢ –ï—Å–ª–∏ telegram_id –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ /api/v2/register/telegram;
 ‚Ä¢ –ó–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É users: telegram_id, username, ref_code, created_at;
 ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ JWT –≤ localStorage.
 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:
 ‚Ä¢ –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω ‚Äî –∑–∞–ø—Ä–æ—Å –∫ /api/v2/referral/info;
 ‚Ä¢ –ï—Å–ª–∏ ref_code –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è;
 ‚Ä¢ –í—ã–≤–æ–¥ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.
 5. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ ‚Äú–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ‚Äù:
 ‚Ä¢ –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
 ‚Ä¢ –ù–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, –∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
 6. –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤:
 ‚Ä¢ –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ test_, console.log, debug.ts ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏;
 ‚Ä¢ ‚ùå –ù–µ –æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏ –≤ controllers, routes, modules.

‚∏ª

‚õî –ó–∞–ø—Ä–µ—â–µ–Ω–æ:
 ‚Ä¢ üö´ –°–æ–∑–¥–∞–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –ª–æ–≥–∏–∫–∏ (registerUser(), authTelegram() –∏ –¥—Ä.);
 ‚Ä¢ üö´ –î–æ–±–∞–≤–ª—è—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è API;
 ‚Ä¢ üö´ –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü—ã users;
 ‚Ä¢ üö´ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ guest_* –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
 ‚Ä¢ üö´ –ü–∏—Å–∞—Ç—å –≤–Ω–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã modules/, services/, controllers/.

‚∏ª

üìã –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
 ‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É users (telegram_id, username, ref_code);
 ‚Ä¢ API /auth/telegram –∏ /register/telegram —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ;
 ‚Ä¢ JWT –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è;
 ‚Ä¢ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è;
 ‚Ä¢ –ù–µ—Ç –æ—à–∏–±–æ–∫ 401, 404, undefined, not found user;
 ‚Ä¢ –í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã ‚Äî —É–¥–∞–ª–µ–Ω—ã –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞.

‚∏ª

üìé –ü–æ–¥—Å–∫–∞–∑–∫–∞:

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π flow:

if (initData) {
  try {
    await authTelegram(initData); // /auth/telegram
  } catch {
    await registerTelegram(initData); // /register/telegram
  }
}


‚∏ª

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏, –µ—Å–ª–∏ —Ç–∞–∫ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∞–≥–µ–Ω—Ç—É ‚úÖ