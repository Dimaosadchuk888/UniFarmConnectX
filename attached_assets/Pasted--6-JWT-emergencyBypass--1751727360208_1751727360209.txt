‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ6: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (JWT + emergencyBypass)

üéØ –¶–µ–ª—å:

–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ–±—Ö–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–¥–∫–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–µ –¥–∞–Ω–Ω—ã—Ö, –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ –≤–∑–ª–æ–º—É —Å–∏—Å—Ç–µ–º—ã. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ production-—É—Ä–æ–≤–Ω—è.

‚∏ª

üîê 1. –£–¥–∞–ª–∏—Ç—å emergencyBypass middleware

üìÅ –ü—É—Ç—å:

core/middleware/emergencyBypass.ts

üö´ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

const demoUser = {
  id: 42,
  telegram_id: 42,
  username: 'demo_user',
  ...
}

–≠—Ç–æ—Ç middleware –ø–æ–¥–∫–ª—é—á–µ–Ω –≤–æ –º–Ω–æ–≥–∏—Ö –º–µ—Å—Ç–∞—Ö –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –≤—Å–µ–º –≤—Ö–æ–¥—è—â–∏–º –∑–∞–ø—Ä–æ—Å–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å ID 42.

‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:
 ‚Ä¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª emergencyBypass.ts
 ‚Ä¢ –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ emergencyBypass –≤ server/index.ts, server/routes.ts, –∞ —Ç–∞–∫–∂–µ –≤ –º–æ–¥—É–ª—è—Ö, –≥–¥–µ –æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω

‚∏ª

üõ°Ô∏è 2. –£–¥–∞–ª–∏—Ç—å fallback –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è JWT_SECRET

üìÅ –ü—É—Ç—å:

core/utils/telegramAuth.ts (–∏–ª–∏ auth.ts)

üö´ –ü—Ä–æ–±–ª–µ–º–∞:

const jwtSecret = process.env.JWT_SECRET || 'unifarm_jwt_secret_key_2025_production';

–ï—Å–ª–∏ .env –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç JWT_SECRET, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–∞—Å–Ω–æ–µ —Ö–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –≤—Å–µ–º, —É –∫–æ–≥–æ –µ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥.

‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:
 ‚Ä¢ –£–¥–∞–ª–∏—Ç—å fallback:

‚ùå  || 'unifarm_jwt_secret_key_2025_production'

 ‚Ä¢ –°–¥–µ–ª–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è:

if (!process.env.JWT_SECRET) {
  throw new Error('JWT_SECRET is not defined');
}

 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ JWT —Ç–æ–∫–µ–Ω—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ production –∏ preview

‚∏ª

üß™ 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è:
 ‚Ä¢ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ preview –∏ production –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:
 ‚Ä¢ ‚úÖ Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
 ‚Ä¢ ‚úÖ –í—Å–µ JWT —Ç–æ–∫–µ–Ω—ã –≤—ã–¥–∞—é—Ç—Å—è –∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è
 ‚Ä¢ ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è (401 Unauthorized)
 ‚Ä¢ ‚úÖ –ù–µ—Ç –ª–æ–≥–æ–≤ –æ—à–∏–±–æ–∫ –ø–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é emergencyBypass

‚∏ª

üìù –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
 1. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–µ—Å—Ç, –≥–¥–µ emergencyBypass –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è (–∏ –±—ã–ª —É–¥–∞–ª—ë–Ω)
 2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —á—Ç–æ JWT_SECRET —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
 3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ endpoints:
 ‚Ä¢ /api/v2/farming
 ‚Ä¢ /api/v2/wallet
 ‚Ä¢ /api/v2/boost
 ‚Ä¢ /api/v2/referral
—Ä–∞–±–æ—Ç–∞—é—Ç —Å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

‚∏ª

üîí –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
 ‚Ä¢ ‚úÖ –£–¥–∞–ª—ë–Ω –≤–µ—Å—å —Ä–∏—Å–∫ –æ–±—Ö–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
 ‚Ä¢ ‚úÖ JWT-—Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞, –±–µ–∑ —Ö–∞—Ä–¥–∫–æ–¥–æ–≤
 ‚Ä¢ ‚úÖ Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∏ –ø—Ä–µ–∂–¥–µ
 ‚Ä¢ ‚úÖ Production –≥–æ—Ç–æ–≤ –∫ –∑–∞—â–∏—â—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ

‚∏ª