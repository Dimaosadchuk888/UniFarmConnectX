üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ

–¶–µ–ª—å:
–ü—Ä–∏–≤–µ—Å—Ç–∏ user_id = 48 –∫ –Ω–∞—Å—Ç–æ—è—â–µ–º—É –ø—Ä–æ–¥–∞–∫—à–Ω-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —É–±—Ä–∞—Ç—å –≤—Å–µ —Ö–∞—Ä–¥–∫–æ–¥—ã –∏ –¥–µ–º–æ-—Ä–µ–∂–∏–º—ã, —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

‚∏ª

üîç –≠–¢–ê–ü 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ —Ö–∞—Ä–¥–∫–æ–¥–æ–≤

1. –£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞

–§–∞–π–ª: client/src/contexts/userContext.tsx
–ó–∞–º–µ–Ω–∏—Ç—å:

const isDemoMode = window.location.hostname.includes('replit') || true;

–ù–∞:

const isDemoMode = window.location.hostname.includes('replit');


‚∏ª

2. –£–¥–∞–ª–∏—Ç—å –∂–µ—Å—Ç–∫—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é telegram_id = 88888888

–§–∞–π–ª: UserContext.tsx
–£–¥–∞–ª–∏—Ç—å/–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–∏ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è POST –Ω–∞ /api/v2/auth/telegram —Å –∂–µ—Å—Ç–∫–∏–º telegram_id=88888888.

‚∏ª

3. –£–¥–∞–ª–∏—Ç—å fallback –Ω–∞ user_id = 48

–§–∞–π–ª: server/routes.ts
–ù–∞–π—Ç–∏:

const userId = req.query.user_id || 48;

–ó–∞–º–µ–Ω–∏—Ç—å:

if (!req.query.user_id) return res.status(400).json({ error: 'Missing user_id' });
const userId = req.query.user_id;


‚∏ª

4. –£–¥–∞–ª–∏—Ç—å/–¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ debug endpoints, –≥–¥–µ user_id = 48

–ï—Å–ª–∏ –µ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ debug —Ç–æ—á–∫–∏ —Å .eq('id', 48) ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π // debug only, –∏–ª–∏ –æ–±–µ—Ä–Ω—É—Ç—å –≤ if (process.env.NODE_ENV !== 'production').

‚∏ª

üîê –≠–¢–ê–ü 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ç–æ–∫–µ–Ω—ã

5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ user_id = 48 –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ Telegram

–ó–∞–ø—Ä–æ—Å –≤ –±–∞–∑—É:

SELECT id, telegram_id, username, first_name, last_name
FROM users
WHERE id = 48;

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:
 ‚Ä¢ telegram_id ‚Äî —á–∏—Å–ª–æ–≤–æ–π ID –∏–∑ Telegram SDK (initDataUnsafe.user.id)
 ‚Ä¢ username, –∏–º—è ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É Telegram-–∞–∫–∫–∞—É–Ω—Ç—É

‚∏ª

6. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ:
 ‚Ä¢ POST /api/v2/auth/telegram –ø–æ–ª—É—á–∞–µ—Ç initData –∏–∑ Telegram SDK
 ‚Ä¢ –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è telegram_id
 ‚Ä¢ –í –ë–î –∏—â–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º telegram_id
 ‚Ä¢ JWT —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ user.id, telegram_id, username
 ‚Ä¢ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–∫–µ–Ω

‚∏ª

7. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á —Ö—Ä–∞–Ω–µ–Ω–∏—è JWT

–í userContext.tsx:

// –ë—ã–ª–æ:
const token = localStorage.getItem('telegramJWT');

// –°—Ç–∞–ª–æ:
const token = localStorage.getItem('unifarm_jwt_token');

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ç–æ–∫–µ–Ω–∞:
 ‚Ä¢ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ unifarm_jwt_token

–£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ telegramJWT

‚∏ª

üß™ –≠–¢–ê–ü 3. –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –±–æ–µ–≤–æ–π —Å—Ä–µ–¥–µ:
 ‚Ä¢ –ó–∞–π—Ç–∏ –≤ Telegram Mini App –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ Telegram-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å user_id=48
 ‚Ä¢ –ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JWT —Ç–æ–∫–µ–Ω
 ‚Ä¢ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –¥–µ–º–æ-–∫–æ—Å—Ç—ã–ª–µ–π
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
 ‚Ä¢ –ë–∞–ª–∞–Ω—Å–∞
 ‚Ä¢ Boost
 ‚Ä¢ Farming
 ‚Ä¢ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª—é–±—ã—Ö fallback/hardcoded 48
 ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ JWT —á–∏—Ç–∞–µ—Ç—Å—è –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ unifarm_jwt_token

‚∏ª

‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏

–®–∞–≥ –ó–∞–¥–∞—á–∞ –°—Ç–∞—Ç—É—Å
1 –£–¥–∞–ª–µ–Ω–æ ` 
2 –£–¥–∞–ª–µ–Ω–∞ –∞–≤—Ç–æ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è telegram_id=88888888 ‚¨ú
3 –£–¥–∞–ª—ë–Ω fallback –Ω–∞ user_id=48 ‚¨ú
4 –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã/—É–¥–∞–ª–µ–Ω—ã debug endpoints ‚¨ú
5 –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Telegram-–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 48 ‚¨ú
6 –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞—Å—Ç–æ—è—â–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram SDK ‚¨ú
7 –ö–ª—é—á —Ç–æ–∫–µ–Ω–∞: unifarm_jwt_token ‚¨ú
8 –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–∫ user_id=48 –±–µ–∑ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞ ‚¨ú