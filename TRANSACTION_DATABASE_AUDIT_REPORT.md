# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–£–î–ò–¢: –¢–ò–ü–´ –¢–†–ê–ù–ó–ê–ö–¶–ò–ô –í –ë–ê–ó–ï –î–ê–ù–ù–´–•

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 11 —è–Ω–≤–∞—Ä—è 2025  
**–ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏:** –ü—Ä—è–º–æ–π –∞–Ω–∞–ª–∏–∑ –ë–î —á–µ—Ä–µ–∑ Supabase API  
**–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

---

## üî¥ –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ 595,053 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π **–í–°–ï** –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–∏–ø: `FARMING_REWARD`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î –ø–æ–∫–∞–∑–∞–ª–∞:
```
–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
-------------------------
FARMING_REWARD: 1000 –∑–∞–ø–∏—Å–µ–π (–∏–∑ –≤—ã–±–æ—Ä–∫–∏)

–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤: 1
–¢–∏–ø—ã: FARMING_REWARD
```

---

## üìä –ê–ù–ê–õ–ò–ó –ù–ï–°–û–û–¢–í–ï–¢–°–¢–í–ò–ô

### 1. –¢–ò–ü–´ –í –°–•–ï–ú–ï (shared/schema.ts):
```typescript
export const TransactionType = pgEnum('transaction_type', [
  'FARMING_REWARD',     // ‚úÖ –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
  'BOOST_REWARD',       // ‚ùå –ù–ï–¢ –≤ –ë–î
  'MISSION_REWARD',     // ‚ùå –ù–ï–¢ –≤ –ë–î
  'DAILY_BONUS',        // ‚ùå –ù–ï–¢ –≤ –ë–î
  'REFERRAL_REWARD',    // ‚ùå –ù–ï–¢ –≤ –ë–î
  'WITHDRAWAL',         // ‚ùå –ù–ï–¢ –≤ –ë–î
  'DEPOSIT',            // ‚ùå –ù–ï–¢ –≤ –ë–î
  'FARMING_DEPOSIT',    // ‚ùå –ù–ï–¢ –≤ –ë–î
  'BOOST_PURCHASE',     // ‚ùå –ù–ï–¢ –≤ –ë–î
  'AIRDROP_CLAIM'       // ‚ùå –ù–ï–¢ –≤ –ë–î
]);
```

### 2. –¢–ò–ü–´ –í –ö–û–î–ï (TransactionService.ts):
```typescript
// –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–∞–ø–ø—è—Ç—Å—è –Ω–∞ FARMING_REWARD:
'TON_BOOST_INCOME': 'FARMING_REWARD',   // TON Boost –¥–æ—Ö–æ–¥—ã
'UNI_DEPOSIT': 'FARMING_REWARD',        // UNI –¥–µ–ø–æ–∑–∏—Ç—ã
'TON_DEPOSIT': 'FARMING_REWARD',        // TON –¥–µ–ø–æ–∑–∏—Ç—ã
'UNI_WITHDRAWAL': 'FARMING_REWARD',     // –í—ã–≤–æ–¥—ã
'TON_WITHDRAWAL': 'FARMING_REWARD',     // –í—ã–≤–æ–¥—ã
'BOOST_PURCHASE': 'FARMING_REWARD',     // –ü–æ–∫—É–ø–∫–∏ boost
'AIRDROP_REWARD': 'DAILY_BONUS'         // Airdrop –Ω–∞–≥—Ä–∞–¥—ã
```

---

## üîç –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢ –°–ï–ô–ß–ê–°

### –ü—Ä–∏–º–µ—Ä: TON Boost –¥–æ—Ö–æ–¥—ã (tonBoostIncomeScheduler.ts:145)
```typescript
.insert({
  user_id: user.id,
  type: 'FARMING_REWARD',  // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–∏–ø
  amount: fiveMinuteIncome.toFixed(8),
  amount_uni: '0',
  amount_ton: fiveMinuteIncome.toFixed(8),
  currency: 'TON',
  status: 'completed',
  description: `TON Boost –¥–æ—Ö–æ–¥ (${user.ton_boost_package}): ${fiveMinuteIncome.toFixed(6)} TON`
})
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–º–∏—Å—Å–∏–∏, –±–æ–Ω—É—Å—ã, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã, TON boost) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ `FARMING_REWARD`

---

## üö® –ü–û–°–õ–ï–î–°–¢–í–ò–Ø

1. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–∏–ø–∞–º** - –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ farming rewards
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –Ω–µ–ª—å–∑—è –æ—Ç–ª–∏—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ö–æ–¥–∞
3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å—é** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ —Ç–∏–ø–∞–º –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–ü—É—Ç–∞–Ω–∏—Ü–∞ –≤ UI** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –≤—Å–µ –∫–∞–∫ "Farming Reward"

---

## üìã –†–ï–ê–õ–¨–ù–´–ï –ü–†–ò–ú–ï–†–´ –ò–ó –ë–î

### –ü—Ä–∏–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
```json
{
  "type": "FARMING_REWARD",
  "description": "UNI farming income: 0.000820 UNI (rate: 0.01)",
  "amount_uni": "0.00082",
  "amount_ton": "0",
  "created_at": "2025-07-09T10:27:05.436"
}
```

### –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:
- –ú–∏—Å—Å–∏–∏: `type: 'MISSION_REWARD'`
- Daily bonus: `type: 'DAILY_BONUS'`
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ: `type: 'REFERRAL_REWARD'`
- TON Boost: `type: 'BOOST_REWARD'`

---

## üõ†Ô∏è –†–ï–®–ï–ù–ò–Ø

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –≤ enum –ë–î (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Ç–∏–ø–æ–≤
ALTER TYPE transaction_type ADD VALUE 'BOOST_REWARD';
ALTER TYPE transaction_type ADD VALUE 'MISSION_REWARD';
ALTER TYPE transaction_type ADD VALUE 'DAILY_BONUS';
ALTER TYPE transaction_type ADD VALUE 'REFERRAL_REWARD';
-- –∏ —Ç.–¥.
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–µ metadata
–°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ metadata:
```json
{
  "type": "FARMING_REWARD",
  "metadata": {
    "original_type": "TON_BOOST_INCOME",
    "boost_package_id": 3
  }
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Ç–∏–ø—ã –≤ –∫–æ–¥–µ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ —Ç–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –ë–î –∏ —Ä–∞–∑–ª–∏—á–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨: –í–´–°–û–ö–ê–Ø

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤–ª–∏—è–µ—Ç –Ω–∞:
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–æ—Ö–æ–¥–∞
- –ë—É–¥—É—â–µ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°—Ä–æ—á–Ω–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Å DevOps –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Ç–∏–ø–æ–≤ –≤ enum –ë–î.