# üîç –î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ò–ô –û–¢–ß–ï–¢: –ü–†–û–ü–ê–í–®–ò–ï –î–ï–ü–û–ó–ò–¢–´ USER 251
**–î–∞—Ç–∞**: 31.07.2025  
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: User ID 251 (@Irinkatriumf)  
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π –Ω–µ –æ—Ç—Ä–∞–∑–∏–ª–∏—Å—å –Ω–∞ –±–∞–ª–∞–Ω—Å–µ

---

## üìä –ê–ù–ê–õ–ò–ó –ò–°–¢–û–†–ò–ß–ï–°–ö–ò–• –î–ê–ù–ù–´–•

### üéØ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –æ User 251:
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: @Irinkatriumf 
- **–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–±–ª–µ–º**: –†–∞–Ω–µ–µ —Ç–µ—Ä—è–ª –¥–µ–ø–æ–∑–∏—Ç—ã –∏–∑-–∑–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∞–≥–æ–≤
- **–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**: –ü–æ–ª—É—á–∞–ª –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é 2 TON –∑–∞ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è ID: 1329776)
- **TON Boost**: –ê–∫—Ç–∏–≤–Ω—ã–π –ø–∞–∫–µ—Ç —Å 2 TON –¥–µ–ø–æ–∑–∏—Ç–æ–º

### üìà –ò–°–¢–û–†–ò–Ø –î–ï–ü–û–ó–ò–¢–û–í –ò –ö–û–ú–ü–ï–ù–°–ê–¶–ò–ô:

#### üïí 28 –∏—é–ª—è 2025:
- ‚úÖ **–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞**: `0.003319 TON` ‚Üí `3.001874 TON` (+2.998555 TON)
- ‚úÖ **TON Boost –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω**: 2 TON –¥–µ–ø–æ–∑–∏—Ç + —Ñ–∞—Ä–º–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ **–ë–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**: 1.041874 TON (–ø–æ—Å–ª–µ –≤—ã—á–µ—Ç–∞ 2 TON –∑–∞ boost)

#### üïí –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (31 –∏—é–ª—è):
- **–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å**: 0.343292 TON (–∏–∑ –ª–æ–≥–æ–≤ WebView)
- **–†–∞—Å—á–µ—Ç–Ω–∞—è —É–±—ã–ª—å**: ~0.7 TON –∑–∞ 3 –¥–Ω—è

---

## üîç –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´ –ü–†–û–ë–õ–ï–ú

### 1. üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ Rollback-–ø—Ä–æ—Ü–µ—Å—Å—ã** (–í–´–°–û–ö–ê–Ø –í–ï–†–û–Ø–¢–ù–û–°–¢–¨)
```
–°–∏–º–ø—Ç–æ–º—ã:
- –î–µ–ø–æ–∑–∏—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è ‚Üí –∏—Å—á–µ–∑–∞—é—Ç —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
- –°–∏—Å—Ç–µ–º–∞ "–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç" –±–∞–ª–∞–Ω—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
```

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º**:
- **BalanceManager**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω—É–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
- **TransactionEnforcer**: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ "–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö" –æ–ø–µ—Ä–∞—Ü–∏–π
- **BatchBalanceProcessor**: –º–∞—Å—Å–æ–≤–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–µ—à–∞
- **Scheduler conflicts**: –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞–º–∏

### 2. üîó **TON Connect ‚Üí Backend —Ä–∞–∑—Ä—ã–≤** (–°–†–ï–î–ù–Ø–Ø –í–ï–†–û–Ø–¢–ù–û–°–¢–¨)
```
–°–∏–º–ø—Ç–æ–º—ã:
- Blockchain —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
- Backend –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- –î–µ–ø–æ–∑–∏—Ç "–≤–∏—Å–∏—Ç" –±–µ–∑ –∑–∞–ø–∏—Å–∏
```

**–ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–ª—É—á–∞–∏**:
- User ID 25: 3 TON –¥–µ–ø–æ–∑–∏—Ç –∏—Å—á–µ–∑ (28.07.2025)
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ `tonConnectService.ts` –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 3. üè¶ **–ü—Ä–æ–±–ª–µ–º—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ BalanceManager** (–°–†–ï–î–ù–Ø–Ø –í–ï–†–û–Ø–¢–ù–û–°–¢–¨)
```
–°–∏–º–ø—Ç–æ–º—ã:
- WebSocket –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–¥–∏–Ω –±–∞–ª–∞–Ω—Å
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç –¥—Ä—É–≥–æ–π
- Race conditions –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ "–ø—Ä—ã–∂–∫–∏" –±–∞–ª–∞–Ω—Å–∞
```

### 4. ‚ö° **JWT Token Timeout** (–ù–ò–ó–ö–ê–Ø –í–ï–†–û–Ø–¢–ù–û–°–¢–¨)
```
–°–∏–º–ø—Ç–æ–º—ã:
- –î–µ–ø–æ–∑–∏—Ç –≤–æ –≤—Ä–µ–º—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
- JWT —Ç–æ–∫–µ–Ω –∏—Å—á–µ–∑–∞–µ—Ç –Ω–∞ 25-35 –º–∏–Ω—É—Ç–µ
- API –≤—ã–∑–æ–≤ –ø–∞–¥–∞–µ—Ç —Å 401 –æ—à–∏–±–∫–æ–π
```

**–°—Ç–∞—Ç—É—Å**: –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ —á–µ—Ä–µ–∑ JWT Token Monitor System

---

## üõ°Ô∏è –ó–ê–©–ò–¢–ù–´–ï –ú–ï–†–´ –£–ñ–ï –í–ù–ï–î–†–ï–ù–´

### ‚úÖ **JWT Token Monitor** (31.07.2025)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –ó–∞—â–∏—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–¥–µ–ø–æ–∑–∏—Ç—ã, –≤—ã–≤–æ–¥—ã)
- –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç –¥–æ timeout

### ‚úÖ **Rollback Protection** (29.07.2025)
- 7 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö rollback-—Ñ—É–Ω–∫—Ü–∏–π –æ—Ç–∫–ª—é—á–µ–Ω—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–∫–∞—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### ‚úÖ **TON Connect Fix** (29.07.2025)
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Frontend ‚Üí Backend
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `/api/v2/wallet/ton-deposit` –ø–æ—Å–ª–µ blockchain —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

---

## üî¨ –î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ò–ï –î–ï–ô–°–¢–í–ò–Ø

### üìã **–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:

1. **–õ–æ–≥–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π User 251** –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π:
   ```sql
   SELECT * FROM transactions 
   WHERE user_id = 251 
   AND created_at > NOW() - INTERVAL '7 days'
   ORDER BY created_at DESC;
   ```

2. **–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–∞—Å—á–µ—Ç–Ω—ã–º –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º**:
   ```sql
   -- –°—É–º–º–∏—Ä—É–µ–º –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
   SELECT 
     SUM(CASE WHEN currency='TON' AND type IN ('DEPOSIT','TON_DEPOSIT','REFERRAL_REWARD','FARMING_REWARD') THEN amount ELSE 0 END) as ton_credits,
     SUM(CASE WHEN currency='TON' AND type IN ('WITHDRAWAL','BOOST_PURCHASE') THEN amount ELSE 0 END) as ton_debits
   FROM transactions WHERE user_id = 251;
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö rollback-—Ñ—É–Ω–∫—Ü–∏–π**:
   ```bash
   grep -r "ANTI_ROLLBACK_PROTECTION" logs/ | grep "User 251"
   ```

4. **WebSocket –ª–æ–≥–∏ –¥–ª—è User 251**:
   ```bash
   grep "userId.*251\|telegram_id.*251" system.log | tail -50
   ```

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### üö® **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**:
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** WebSocket –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è User 251
2. **–°—Ä–∞–≤–Ω–∏—Ç—å** —Ä–∞—Å—á–µ—Ç–Ω—ã–π vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å –ø–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º
3. **–ù–∞–π—Ç–∏** –ø—Ä–æ–ø–∞–≤—à–∏–µ –¥–µ–ø–æ–∑–∏—Ç—ã –≤ blockchain vs database

### üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ä—ã**:
1. **–í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è User 251 –≤—Ä–µ–º–µ–Ω–Ω–æ
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å** –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
3. **–°–æ–∑–¥–∞—Ç—å alert** –ø—Ä–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è—Ö –±–∞–ª–∞–Ω—Å–∞

### üìä **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**:
1. **Improve Balance Reconciliation** - —Å–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–æ–≤ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
2. **Enhanced Logging** - –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–≤ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
3. **Backup Transactions** - –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

## üéØ –°–¢–ê–¢–£–° –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò

**–í–ï–†–û–Ø–¢–ù–ê–Ø –ü–†–ò–ß–ò–ù–ê**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ rollback-–ø—Ä–æ—Ü–µ—Å—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ BalanceManager

**–î–ï–ô–°–¢–í–ò–ï**: –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–æ—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π User 251 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π

**–†–ò–°–ö**: üü° **–°–†–ï–î–ù–ò–ô** - –ü—Ä–æ–±–ª–µ–º–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –º–µ–Ω–µ–µ 1% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

**üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–æ–≤ —Å–∏—Å—Ç–µ–º—ã.