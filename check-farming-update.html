<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞—Ä–º–∏–Ω–≥–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .status-box {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
        }
        .success {
            color: #4CAF50;
            font-weight: bold;
        }
        .error {
            color: #f44336;
            font-weight: bold;
        }
        .warning {
            color: #ff9800;
            font-weight: bold;
        }
        .button {
            background: #2196F3;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        .button:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ñ–∞—Ä–º–∏–Ω–≥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 62</h1>
        
        <div id="status" class="status-box">
            –ó–∞–≥—Ä—É–∑–∫–∞...
        </div>
        
        <button class="button" onclick="checkStatus()">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
    </div>

    <script>
        const API_URL = '/api/v2';
        const USER_ID = 62;
        
        async function checkStatus() {
            const statusDiv = document.getElementById('status');
            const jwtToken = localStorage.getItem('unifarm_jwt_token');
            
            if (!jwtToken) {
                statusDiv.innerHTML = '<span class="error">‚ùå JWT —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω!</span>';
                return;
            }
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å —Ñ–∞—Ä–º–∏–Ω–≥–∞
                const response = await fetch(`${API_URL}/farming/status?user_id=${USER_ID}`, {
                    headers: {
                        'Authorization': `Bearer ${jwtToken}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                const farmingData = data.data || {};
                
                let html = '<h3>–°—Ç–∞—Ç—É—Å —Ñ–∞—Ä–º–∏–Ω–≥–∞:</h3>';
                html += `<p>User ID: ${farmingData.user_id || USER_ID}</p>`;
                html += `<p>–ë–∞–ª–∞–Ω—Å UNI: <strong>${farmingData.balance_uni || 0}</strong></p>`;
                html += `<p>–î–µ–ø–æ–∑–∏—Ç: <strong>${farmingData.uni_deposit_amount || 0} UNI</strong></p>`;
                html += `<p>–°—Ç–∞–≤–∫–∞ (uni_farming_rate): <span class="${farmingData.uni_farming_rate ? 'success' : 'error'}"><strong>${farmingData.uni_farming_rate || '–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù–ê'}</strong></span></p>`;
                html += `<p>–§–∞—Ä–º–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω: <span class="${farmingData.uni_farming_active ? 'success' : 'error'}"><strong>${farmingData.uni_farming_active ? '–î–ê' : '–ù–ï–¢'}</strong></span></p>`;
                html += `<p>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: ${farmingData.uni_farming_start_timestamp || '–ù–ï–¢'}</p>`;
                
                if (farmingData.uni_farming_rate && farmingData.uni_farming_rate === 0.01) {
                    html += '<hr>';
                    html += '<p class="success">‚úÖ uni_farming_rate —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!</p>';
                    
                    if (!farmingData.uni_farming_active) {
                        html += '<p class="warning">‚ö†Ô∏è –§–∞—Ä–º–∏–Ω–≥ –≤—Å–µ –µ—â–µ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</p>';
                        html += '<ul>';
                        html += '<li>–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ uni_farming_active = true</li>';
                        html += '<li>–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –µ—â–µ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∂–¥–∏—Ç–µ 5 –º–∏–Ω—É—Ç)</li>';
                        html += '<li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π</li>';
                        html += '</ul>';
                    } else {
                        html += '<p class="success">üéâ –§–∞—Ä–º–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω! –ù–∞–≥—Ä–∞–¥—ã –±—É–¥—É—Ç –Ω–∞—á–∏—Å–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>';
                    }
                } else {
                    html += '<hr>';
                    html += '<p class="error">‚ùå uni_farming_rate –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–≤–µ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.</p>';
                }
                
                statusDiv.innerHTML = html;
                
            } catch (error) {
                statusDiv.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</span>`;
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = checkStatus;
    </script>
</body>
</html>