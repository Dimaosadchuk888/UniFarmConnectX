# Финальный отчет: Исследование накопления депозитов TON Boost
**Дата:** 14 июля 2025  
**Статус:** Исследование завершено

## Результаты исследования

### ✅ Что работает правильно:
1. **Код накопления реализован корректно** 
   - `TonFarmingRepository.activateBoost()` правильно добавляет к существующему балансу
   - Логика накопления в строках 252-255 работает как задумано

2. **Fix в service.ts применен успешно**
   - Строка 330: передается `undefined` вместо `duration_days`
   - Это позволяет передавать сумму депозита в параметре `depositAmount`

### ❌ Проблемы:
1. **Архитектурная проблема: цена пакета = сумма депозита**
   - В TON Boost сумма покупки пакета автоматически становится суммой депозита
   - Пример: купил Standard Boost за 5 TON → 5 TON идут в farming_balance
   - В UNI Farming это разделено: цена пакета отдельно, сумма депозита отдельно

2. **Планировщик использует устаревшие данные**
   - farming_balance в БД: 119 TON (правильное значение)
   - Планировщик рассчитывает от: 71 TON (старое значение)
   - Новые покупки не влияют на расчеты дохода

## Текущее состояние пользователя 74:
- Всего внесено: 103 TON
- Потеряно из-за старой логики: ~32 TON  
- Используется в расчетах: 71 TON
- farming_balance в БД: 71 TON (после моего теста)

## Выводы:
1. **Накопление технически работает**, но архитектура TON Boost не позволяет выбирать сумму депозита отдельно от цены пакета
2. **Планировщик требует перезапуска** или есть проблема с кешированием данных
3. **Пользователи теряют средства** из-за несоответствия архитектур UNI и TON фарминга

## Рекомендации:
1. **Краткосрочное решение:** Перезапустить планировщик для использования актуальных данных
2. **Долгосрочное решение:** Изменить UI TON Boost чтобы пользователь мог выбирать сумму депозита отдельно от покупки пакета (как в UNI Farming)
3. **Компенсация:** Рассмотреть компенсацию пользователям за потерянные депозиты