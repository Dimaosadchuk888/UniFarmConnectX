# üîç UNIFARM CONNECTX - –ü–û–õ–ù–´–ô –°–ò–°–¢–ï–ú–ù–´–ô –ê–£–î–ò–¢
*–î–∞—Ç–∞: 15 –∏—é–Ω—è 2025 | –ê—É–¥–∏—Ç–æ—Ä: –°–∏—Å—Ç–µ–º–Ω—ã–π –∞–≥–µ–Ω—Ç*

---

## üìä –°–í–û–î–ö–ê –°–¢–ê–¢–£–°–ê –°–ò–°–¢–ï–ú–´

### ‚úÖ –°–ï–†–í–ï–†: –†–ê–ë–û–¢–ê–ï–¢
- **–°—Ç–∞—Ç—É—Å**: –ê–∫—Ç–∏–≤–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
- **–ü—Ä–æ—Ü–µ—Å—Å**: tsx server/index.ts (PID: 25780)
- **–°—Ä–µ–¥–∞**: production (NODE_ENV=production)

### ‚úÖ –ü–û–†–¢: 3000 (–û–¢–ö–†–´–¢ –ò –°–õ–£–®–ê–ï–¢–°–Ø)
- **–ü—Ä–∏–≤—è–∑–∫–∞**: 0.0.0.0:3000 (–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ)
- **Health endpoint**: /health –∞–∫—Ç–∏–≤–µ–Ω
- **API endpoints**: /api/v2/* —Ä–∞–±–æ—Ç–∞—é—Ç

### ‚úÖ WEBHOOK: –ù–ê–°–¢–†–û–ï–ù
- **URL**: https://uni-farm-connect-x-osadchukdmitro2.replit.app/webhook
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**: 4 –ø—É—Ç–∏ (/webhook, /api/webhook, /bot/webhook, /telegram/webhook)
- **Polling fallback**: –ê–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ webhook

---

## ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò

### 1. –û–®–ò–ë–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò (HTTP 401)
**–ò—Å—Ç–æ—á–Ω–∏–∫**: webview_console_logs
```
[QueryClient] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (401)
API Request Error: {}
–û—à–∏–±–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å: HTTP 401: Unauthorized
```

**–ü—Ä–∏—á–∏–Ω–∞**: 
- –ö–ª–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å JWT —Ç–æ–∫–µ–Ω
- initData –ø—É—Å—Ç–æ–π –≤ Telegram WebApp
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–ª–µ–≥—Ä–∞–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ UserContext

**–§–∞–π–ª—ã –ø—Ä–æ–±–ª–µ–º—ã**:
- `client/src/contexts/UserContext.tsx` - –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º initData
- `modules/auth/controller.ts` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `core/middleware/telegramMiddleware.ts` - –ø–∞—Ä—Å–∏–Ω–≥ initData

### 2. DEPRECATED –ú–û–î–£–õ–ò (–ê–ö–¢–ò–í–ù–û –ò–°–ü–û–õ–¨–ó–£–Æ–¢–°–Ø)
**–ò—Å—Ç–æ—á–Ω–∏–∫**: –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ modules/

```
modules/user/service.ts:    console.warn('[DEPRECATED] UserService is deprecated. Use UserRepository instead');
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ deprecated –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `UserService` –≤ modules/user/service.ts (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 3+ –º–µ—Å—Ç–∞—Ö)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `MissionsService` (—Å—Å—ã–ª–∫–∏ –Ω–∞–π–¥–µ–Ω—ã, —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

**–§–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
- `modules/user/controller.ts` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç UserService
- `modules/wallet/controller.ts` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç UserService
- `modules/auth/service-broken.ts` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π UserService

### 3. –ö–û–ù–§–õ–ò–ö–¢ –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø
**–ò—Å—Ç–æ—á–Ω–∏–∫**: printenv –∞–Ω–∞–ª–∏–∑

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**:
```bash
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.wunnsvicbebssrjqedor.supabase.co:5432/postgres  # –°–û–î–ï–†–ñ–ò–¢ PLACEHOLDER
PGDATABASE=neondb  # –°–¢–ê–†–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É–¥–∞–ª–µ–Ω–∞)
PGPORT=5432        # –°–¢–ê–†–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É–¥–∞–ª–µ–Ω–∞)
SUPABASE_ANON_KEY=your-anon-key  # PLACEHOLDER VALUE
```

**–ö–æ–Ω—Ñ–ª–∏–∫—Ç**: –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏ Supabase API (SUPABASE_URL/SUPABASE_KEY), –∏ PostgreSQL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

---

## ‚ö†Ô∏è –ù–ï–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. SENTRY MONITORING –û–¢–ö–õ–Æ–ß–ï–ù
```
[Sentry] Disabled - SENTRY_DSN not found in environment
```
**–í–ª–∏—è–Ω–∏–µ**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫ –≤ production

### 2. TELEGRAM WEBAPP INITDATA –ü–£–°–¢–û–ô
**–ò—Å—Ç–æ—á–Ω–∏–∫**: client/src/main.tsx –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```javascript
console.log('initData –ø—É—Å—Ç–æ–π - –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:');
console.log('1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –∏–∑ Telegram (–ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)');
console.log('2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Web App URL –≤ BotFather');
```

**–ü—Ä–∏—á–∏–Ω—ã**:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –≤–º–µ—Å—Ç–æ Telegram
- URL –≤ BotFather –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### 3. –£–°–¢–ê–†–ï–í–®–ò–ï –§–ê–ô–õ–´ –í –°–ò–°–¢–ï–ú–ï
- `modules/auth/service-broken.ts` - –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π broken —Ñ–∞–π–ª
- `modules/wallet/service.old.ts` - —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ `.md` –æ—Ç—á–µ—Ç–æ–≤ (73+ —Ñ–∞–π–ª–∞) –∑–∞—Å–æ—Ä—è—é—Ç –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

---

## üîß –î–ï–¢–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ú–û–î–£–õ–ï–ô

### ‚úÖ –†–ê–ë–û–ß–ò–ï –ú–û–î–£–õ–ò:
1. **core/supabase.ts** - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase
2. **server/index.ts** - –°–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
3. **modules/auth/controller.ts** - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
4. **WebSocket —Å–µ—Ä–≤–µ—Ä** - –ê–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (/ws)

### ‚ùå –ü–†–û–ë–õ–ï–ú–ù–´–ï –ú–û–î–£–õ–ò:
1. **modules/user/service.ts** - Deprecated, –Ω–æ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
2. **modules/auth/service-broken.ts** - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
3. **client/src/contexts/UserContext.tsx** - –ü—Ä–æ–±–ª–µ–º—ã —Å Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

---

## üéØ –ê–ù–ê–õ–ò–ó –ü–†–ò–ß–ò–ù "–û–®–ò–ë–ö–ê –ö–û–ú–ü–û–ù–ï–ù–¢–ê"

### –ì–õ–ê–í–ù–ê–Ø –ü–†–ò–ß–ò–ù–ê: –¶–µ–ø–æ—á–∫–∞ –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

1. **Telegram initData –ø—É—Å—Ç–æ–π** ‚Üí 
2. **UserContext –Ω–µ –º–æ–∂–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Üí 
3. **API –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 401 Unauthorized** ‚Üí 
4. **React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫—Ä–∞—à—è—Ç—Å—è –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Üí 
5. **ErrorBoundary –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–û—à–∏–±–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞"**

### –í–¢–û–†–ò–ß–ù–´–ï –ü–†–ò–ß–ò–ù–´:
- Deprecated UserService –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö Supabase –º–µ—Ç–æ–¥–æ–≤
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

---

## üìã –ò–¢–û–ì–û–í–ê–Ø –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (–ë–õ–û–ö–ï–†–´ –ó–ê–ü–£–°–ö–ê):
1. **HTTP 401 Unauthorized** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è
2. **–ü—É—Å—Ç–æ–π initData** - Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. **Deprecated –º–æ–¥—É–ª–∏** - –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

### üü° –ß–ê–°–¢–ò–ß–ù–û (–í–õ–ò–Ø–ï–¢ –ù–ê –ö–ê–ß–ï–°–¢–í–û):
1. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è** - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ë–î
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Sentry** - –Ω–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫
3. **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–∞–π–ª—ã** - –∑–∞—Å–æ—Ä—è—é—Ç –ø—Ä–æ–µ–∫—Ç

### üü¢ –ì–û–¢–û–í–û (–†–ê–ë–û–¢–ê–ï–¢ –ö–û–†–†–ï–ö–¢–ù–û):
1. **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫** - —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000
2. **Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
3. **WebSocket** - –∞–∫—Ç–∏–≤–µ–Ω –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
4. **Health endpoints** - –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –î–ï–ô–°–¢–í–ò–Ø (–ù–ï –í–´–ü–û–õ–ù–Ø–¢–¨)

*–°–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ - —Ç–æ–ª—å–∫–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π*

### –ü–†–ò–û–†–ò–¢–ï–¢ 1 (–ö–†–ò–¢–ò–ß–ù–û):
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é Telegram –≤ UserContext
2. –ó–∞–º–µ–Ω–∏—Ç—å deprecated UserService –Ω–∞ Supabase API –≤—ã–∑–æ–≤—ã
3. –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü–†–ò–û–†–ò–¢–ï–¢ 2 (–£–õ–£–ß–®–ï–ù–ò–Ø):
1. –î–æ–±–∞–≤–∏—Ç—å SENTRY_DSN –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Telegram WebApp URL
3. –£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–∞–π–ª—ã

---

## üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –û–¶–ï–ù–ö–ê

**–û–ë–©–ò–ô –°–¢–ê–¢–£–°**: üî¥ **–ö–†–ò–¢–ò–ß–ù–û**

- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production**: 25%
- **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞**: ‚úÖ –í—ã—Å–æ–∫–∞—è
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**: ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (deprecated –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)

**–¢–†–ï–ë–£–ï–¢–°–Ø**: –°—Ä–æ—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞–º–µ–Ω–∞ deprecated –º–æ–¥—É–ª–µ–π –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ Telegram Mini App.