# üîß TON Boost - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã

**–î–∞—Ç–∞:** 13 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã  
**–ú–µ—Ç–æ–¥:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–∞ –¥–æ—Ö–æ–¥–æ–≤

---

## üìã –ü—Ä–æ–±–ª–µ–º–∞

–î–æ—Ö–æ–¥ TON Boost —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª—Å—è –æ—Ç –≤—Å–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (balance_ton - 10) –≤–º–µ—Å—Ç–æ —Å—É–º–º—ã –¥–µ–ø–æ–∑–∏—Ç–∞ –≤ boost –ø–∞–∫–µ—Ç. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –∑–∞–≤—ã—à–µ–Ω–∏—é –¥–æ—Ö–æ–¥–æ–≤ –≤ 165+ —Ä–∞–∑.

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. TonFarmingRepository.activateBoost()
**–§–∞–π–ª:** `modules/boost/TonFarmingRepository.ts`  
**–°—Ç—Ä–æ–∫–∏:** 246, 252, 268, 272

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `depositAmount?: number` –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä—É –º–µ—Ç–æ–¥–∞
- –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è `farming_balance` –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ boost
- –û–±–Ω–æ–≤–ª–µ–Ω —Ç–∞–∫–∂–µ fallback –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã users

```typescript
// –ë—ã–ª–æ:
async activateBoost(userId: string, packageId: number, rate: number, expiresAt?: string): Promise<boolean>

// –°—Ç–∞–ª–æ:
async activateBoost(userId: string, packageId: number, rate: number, expiresAt?: string, depositAmount?: number): Promise<boolean>

// –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ upsert:
farming_balance: depositAmount ? depositAmount.toString() : '0',
```

### 2. BoostService.purchaseWithInternalWallet()
**–§–∞–π–ª:** `modules/boost/service.ts`  
**–°—Ç—Ä–æ–∫–∞:** 333

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ü–µ—Ä–µ–¥–∞–µ–º `requiredAmount` –≤ –≤—ã–∑–æ–≤ `activateBoost`

```typescript
// –ë—ã–ª–æ:
const immediateActivation = await tonFarmingRepo.activateBoost(
  parseInt(userId),
  boostPackage.id,
  boostPackage.daily_rate / 100,
  boostPackage.duration_days
);

// –°—Ç–∞–ª–æ:
const immediateActivation = await tonFarmingRepo.activateBoost(
  parseInt(userId),
  boostPackage.id,
  boostPackage.daily_rate / 100,
  boostPackage.duration_days,
  requiredAmount // –ü–µ—Ä–µ–¥–∞–µ–º —Å—É–º–º—É –¥–µ–ø–æ–∑–∏—Ç–∞
);
```

### 3. tonBoostIncomeScheduler
**–§–∞–π–ª:** `modules/scheduler/tonBoostIncomeScheduler.ts`  
**–°—Ç—Ä–æ–∫–∏:** 120, 149

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–∑–º–µ–Ω–µ–Ω —Ä–∞—Å—á–µ—Ç `userDeposit` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `farming_balance`
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—É–º–º—ã –¥–µ–ø–æ–∑–∏—Ç–∞

```typescript
// –ë—ã–ª–æ:
const userDeposit = Math.max(0, parseFloat(userBalance.balance_ton || '0') - 10);

// –°—Ç–∞–ª–æ:
const userDeposit = Math.max(0, parseFloat(user.farming_balance || '0'));

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
logger.info(`[TON_BOOST_SCHEDULER] User ${user.user_id} (${user.boost_package_id}): +${fiveMinuteIncome.toFixed(6)} TON (–¥–µ–ø–æ–∑–∏—Ç: ${userDeposit} TON)`);
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–µ–ø–æ–∑–∏—Ç–æ–º 5 TON –∏ –±–∞–ª–∞–Ω—Å–æ–º 837 TON
- –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–∞: (837 - 10) * 0.015 = 12.4 TON/–¥–µ–Ω—å

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–µ–ø–æ–∑–∏—Ç–æ–º 5 TON
- –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–∞: 5 * 0.015 = 0.075 TON/–¥–µ–Ω—å

**–°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–≤—ã—à–µ–Ω–Ω—ã—Ö –¥–æ—Ö–æ–¥–æ–≤ –≤ 165 —Ä–∞–∑ –¥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π!**

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ boost –ø–∞–∫–µ—Ç—ã –±—É–¥—É—Ç –¥–∞–≤–∞—Ç—å –¥–æ—Ö–æ–¥ 0 TON –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–∫—É–ø–∫–∏, —Ç–∞–∫ –∫–∞–∫ –∏—Ö `farming_balance` = 0

2. **–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫:** –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

3. **–ù–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏:** –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ boost –ø–∞–∫–µ—Ç–æ–≤ –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å `farming_balance`

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç–æ–≤
3. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `farming_balance` —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø–∞–∫–µ—Ç–∞–º

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- –î–æ—Ö–æ–¥ –æ—Ç TON Boost —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—É–º–º–µ –¥–µ–ø–æ–∑–∏—Ç–∞ * –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É
- –í –ª–æ–≥–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—É–º–º–∞ –¥–µ–ø–æ–∑–∏—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ù–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç `farming_balance`