# üìã –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –í–ï–†–ò–§–ò–ö–ê–¶–ò–ò TON BOOST
**–î–∞—Ç–∞:** 14 —è–Ω–≤–∞—Ä—è 2025  
**–†–æ–ª—å:** –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞ —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏

---

## üìä –û–ë–©–ï–ï –†–ï–ó–Æ–ú–ï

–ú–æ–¥—É–ª—å TON Boost **—Ä–∞–±–æ—Ç–∞–µ—Ç**, –Ω–æ –∏–º–µ–µ—Ç —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è)
- ‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
- ‚ùå –ú–∞—Å—Å–æ–≤–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚ùå 87.5% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–º–µ—é—Ç farming_balance –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢

### 1. –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤ (User 74)
```
–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è:
- 14.01 04:21: 1 TON ‚Üí farming_balance —É–≤–µ–ª–∏—á–∏–ª—Å—è
- 14.01 04:21: 5 TON ‚Üí farming_balance —É–≤–µ–ª–∏—á–∏–ª—Å—è  
- 14.01 04:21: 25 TON ‚Üí farming_balance —É–≤–µ–ª–∏—á–∏–ª—Å—è
- 14.01 06:09: 10 TON ‚Üí farming_balance = 340 TON

–í—ã–≤–æ–¥: –õ–æ–≥–∏–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –†–ê–ë–û–¢–ê–ï–¢ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### 2. –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞
```
User 74 (farming_balance: 340 TON, rate: 0.02):
- –û–∂–∏–¥–∞–µ–º—ã–π –¥–æ—Ö–æ–¥: 340 * 0.02 * 5 / 1440 = 0.023611 TON
- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –¥–æ—Ö–æ–¥: 0.023611 TON ‚úÖ
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- metadata.original_type = 'TON_BOOST_INCOME' –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### 3. Metadata —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```
–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ 100+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
- ‚úÖ 100% –≤–∞–ª–∏–¥–Ω—ã–π JSON
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ metadata
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ "invalid input syntax for type json"
```

---

## ‚ùå –ß–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ (User 74)
```
–§–ê–ö–¢–´:
- –°—É–º–º–∞ –≤—Å–µ—Ö BOOST_PURCHASE —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: 161 TON
- –¢–µ–∫—É—â–∏–π farming_balance: 340 TON
- –ù–µ–æ–±—ä—è—Å–Ω–∏–º—ã–π –∏–∑–ª–∏—à–µ–∫: 179 TON (111% –ø–µ—Ä–µ–ø–ª–∞—Ç–∞)

–ü–†–ò–ß–ò–ù–ê: 
- –î–æ 13.01.2025 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ–ª–∏ farming_balance –ë–ï–ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –í–µ—Ä–æ—è—Ç–Ω–æ, –ø—Ä—è–º—ã–µ SQL –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü–µ—Ä–≤—ã–µ 9 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (63 TON) –Ω–µ –∏–º–µ—é—Ç metadata
```

### 2. –ú–∞—Å—Å–æ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```
–°–¢–ê–¢–ò–°–¢–ò–ö–ê:
- 32 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å farming_balance > 0
- 28 –∏–∑ –Ω–∏—Ö (87.5%) –ù–ï –∏–º–µ—é—Ç –Ω–∏ –æ–¥–Ω–æ–π BOOST_PURCHASE —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –û–±—â–∏–π "—Ñ–∞–Ω—Ç–æ–º–Ω—ã–π" –±–∞–ª–∞–Ω—Å: ~2800 TON –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏

–ü–†–ò–ú–ï–†–´:
- User 1: farming_balance = 50 TON, –ø–æ–∫—É–ø–æ–∫ = 0
- User 14-30: farming_balance = 100 TON –∫–∞–∂–¥—ã–π, –ø–æ–∫—É–ø–æ–∫ = 0
- User 48: farming_balance = 500 TON, –ø–æ–∫—É–ø–æ–∫ = 0
```

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ BOOST_PURCHASE –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
```
–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞:
- FARMING_REWARD: 1000 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- BOOST_PURCHASE: 0 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (!)

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∏–ª–∏ –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è
```

---

## üîç –ö–û–†–ù–ï–í–´–ï –ü–†–ò–ß–ò–ù–´

### 1. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ farming_balance –Ω–∞–ø—Ä—è–º—É—é
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—É–¥–∏—Ç–æ—Ä—Å–∫–∏–π —Å–ª–µ–¥ –¥–ª—è 87.5% –±–∞–ª–∞–Ω—Å–æ–≤
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ —Å—Ä–µ–¥—Å—Ç–≤

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è
- –î–æ 14.01.2025: –ª–æ–≥–∏–∫–∞ –∑–∞–º–µ—â–µ–Ω–∏—è (–Ω–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –∑–∞–º–µ–Ω—è–ª–∞ –±–∞–ª–∞–Ω—Å)
- –ü–æ—Å–ª–µ 14.01.2025: –ª–æ–≥–∏–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è (–Ω–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è)
- User 74 –ø–æ–ª—É—á–∏–ª –≤—ã–≥–æ–¥—É –æ—Ç –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º

### 3. –ü—Ä–æ–±–ª–µ–º–∞ —Å upsert –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º `onConflict` –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
- –ù–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏

---

## üìã –°–ü–ò–°–û–ö –ü–†–û–ë–õ–ï–ú–ù–´–• –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–ª—É—á–∞–∏ (farming_balance –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π):
```
User ID | farming_balance | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
--------|-----------------|------------
1       | 50.01 TON      | 0
14      | 100.04 TON     | 0
15      | 100.05 TON     | 0
16      | 100.05 TON     | 0
18      | 100.05 TON     | 0
19      | 100.04 TON     | 0
20-30   | 100.04 TON     | 0 (–∫–∞–∂–¥—ã–π)
48      | 500.00 TON     | 0
```

### –°–ª—É—á–∞–π —Å —á–∞—Å—Ç–∏—á–Ω—ã–º –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º:
```
User 74: 
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏: 161 TON
- –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: 340 TON
- –ù–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑–ª–∏—à–µ–∫: 179 TON
```

---

## üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –í–ï–†–î–ò–ö–¢

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã: ‚ö†Ô∏è 65%

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –õ–æ–≥–∏–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç –ø–æ–ª–Ω–æ–≥–æ farming_balance
- ‚úÖ –ù–µ—Ç SQL –æ—à–∏–±–æ–∫ —Å metadata

**–ß—Ç–æ –ù–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚ùå 87.5% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–º–µ—é—Ç –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–ª–∞–Ω—Å—ã
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å—Ä–µ–¥—Å—Ç–≤
- ‚ùå User 74 –∏–º–µ–µ—Ç 179 TON —Å–≤–µ—Ä—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–°—Ä–æ—á–Ω–æ**: –°–æ–∑–¥–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–æ–≤
2. **–í–∞–∂–Ω–æ**: –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞—É–¥–∏—Ç –∏ –≤—ã—è—Å–Ω–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ "—Ñ–∞–Ω—Ç–æ–º–Ω—ã—Ö" –±–∞–ª–∞–Ω—Å–æ–≤
3. **–ö—Ä–∏—Ç–∏—á–Ω–æ**: –ù–µ –¥–æ–ø—É—Å–∫–∞—Ç—å –ø—Ä—è–º—ã—Ö SQL –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π farming_balance –≤ –±—É–¥—É—â–µ–º

---

## üìù SQL –ó–ê–ü–†–û–°–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò

```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏
SELECT 
    tfd.user_id,
    tfd.farming_balance,
    COALESCE(SUM(t.amount_ton), 0) as total_purchased,
    tfd.farming_balance - COALESCE(SUM(t.amount_ton), 0) as discrepancy
FROM ton_farming_data tfd
LEFT JOIN transactions t ON tfd.user_id = t.user_id 
    AND t.type = 'BOOST_PURCHASE'
WHERE tfd.farming_balance > 0
GROUP BY tfd.user_id, tfd.farming_balance
HAVING ABS(tfd.farming_balance - COALESCE(SUM(t.amount_ton), 0)) > 0.01
ORDER BY discrepancy DESC;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–ª—è User 74
SELECT 
    created_at,
    amount_ton,
    description,
    metadata->>'boost_package_id' as package_id,
    SUM(amount_ton) OVER (ORDER BY created_at) as running_total
FROM transactions
WHERE user_id = 74 
    AND type = 'BOOST_PURCHASE'
ORDER BY created_at;
```

---

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Å—Ä–æ—á–Ω–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞—É–¥–∏—Ç–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è 87.5% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.