# üö® –ú–ò–ù–ò–ú–ê–õ–¨–ù–û-–ò–ù–í–ê–ó–ò–í–ù–û–ï –†–ï–®–ï–ù–ò–ï: –û–î–ù–ê –°–¢–†–û–ö–ê –§–ò–ö–°–ê

**–î–∞—Ç–∞:** 22 –∏—é–ª—è 2025  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í–û –ö –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ú–£ –ü–†–ò–ú–ï–ù–ï–ù–ò–Æ  

---

## üéØ –ü–†–û–ë–õ–ï–ú–ê –õ–û–ö–ê–õ–ò–ó–û–í–ê–ù–ê

**–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã:** –í `core/farming/UnifiedFarmingCalculator.ts` —Å—Ç—Ä–æ–∫–∞ 54:
```typescript
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –¥–æ 288 –ø–µ—Ä–∏–æ–¥–æ–≤ (24 —á–∞—Å–∞) ‚Üí –ø–µ—Ä–µ–ø–ª–∞—Ç—ã –¥–æ 100x!

---

## ‚ö° –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï: –û–î–ù–ê –°–¢–†–û–ö–ê

### **–í–ê–†–ò–ê–ù–¢ 1: –ü–û–õ–ù–û–ï –û–¢–ö–õ–Æ–ß–ï–ù–ò–ï –ù–ê–ö–û–ü–õ–ï–ù–ò–Ø**
```typescript
// –ë–´–õ–û (—Å—Ç—Ä–æ–∫–∞ 54):
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);

// –°–¢–ê–ù–ï–¢:
const effectivePeriods = 1; // –í—Å–µ–≥–¥–∞ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** UNI Farming –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¢–û–ß–ù–û –∫–∞–∫ TON Boost - —Å—Ç—Ä–æ–≥–æ 0.003472% –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

### **–í–ê–†–ò–ê–ù–¢ 2: –° –§–õ–ê–ì–û–ú –î–õ–Ø –û–¢–ö–ê–¢–ê**
```typescript
// –ë–´–õ–û (—Å—Ç—Ä–æ–∫–∞ 54):
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);

// –°–¢–ê–ù–ï–¢:
const useIntervalMode = process.env.UNI_FARMING_INTERVAL_MODE === 'true';
const effectivePeriods = useIntervalMode ? 1 : Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- `UNI_FARMING_INTERVAL_MODE=true` ‚Üí –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–∫–∞–∫ TON Boost)
- `UNI_FARMING_INTERVAL_MODE=false` ‚Üí –°—Ç–∞—Ä–∞—è –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞

---

## üîç –ê–ù–ê–õ–ò–ó –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–û–í: –ù–ï–¢ –î–£–ë–õ–ï–ô

### ‚úÖ **–û–°–ù–û–í–ù–´–ï –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–ò (–ê–ö–¢–ò–í–ù–´)**
1. **UNI Farming:** `core/scheduler/farmingScheduler.ts`
   - cron: `*/5 * * * *` (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
   - Singleton –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - Distributed lock: `this.isProcessing`
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª: 4.8 –º–∏–Ω—É—Ç

2. **TON Boost:** `modules/scheduler/tonBoostIncomeScheduler.ts`
   - setInterval: `5 * 60 * 1000` (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
   - Singleton –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª: 4.8 –º–∏–Ω—É—Ç

### ‚úÖ **–î–£–ë–õ–ò–†–£–Æ–©–ò–ï –°–ö–†–ò–ü–¢–´ (–û–¢–ö–õ–Æ–ß–ï–ù–´)**
- `fix-farming-scheduler.ts.disabled` ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û
- `test-farming-scheduler-once.ts.disabled` ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û

### ‚úÖ **–ó–ê–ü–£–°–ö –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–û–í**
**–§–∞–π–ª:** `server/index.ts` —Å—Ç—Ä–æ–∫–∏ 1007-1016
```typescript
const protectedFarmingScheduler = FarmingScheduler.getInstance();
protectedFarmingScheduler.start();

const protectedTonBoostScheduler = TONBoostIncomeScheduler.getInstance();
protectedTonBoostScheduler.start();
```

**–í–´–í–û–î:** –î—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–≤ –ù–ï–¢, –ø—Ä–æ–±–ª–µ–º–∞ –∏–º–µ–Ω–Ω–æ –≤ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–µ!

---

## üìä –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–û–ï –†–ï–®–ï–ù–ò–ï

### **–ü–õ–ê–ù: –í–ê–†–ò–ê–ù–¢ 2 (–° –§–õ–ê–ì–û–ú)**

#### **–®–∞–≥ 1: –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è** (1 –º–∏–Ω—É—Ç–∞)
```typescript
// –í core/farming/UnifiedFarmingCalculator.ts —Å—Ç—Ä–æ–∫–∞ 54:

// –ó–ê–ú–ï–ù–ò–¢–¨:
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);

// –ù–ê:
const useIntervalMode = process.env.UNI_FARMING_INTERVAL_MODE === 'true';
const effectivePeriods = useIntervalMode ? 1 : Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

#### **–®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è** (30 —Å–µ–∫—É–Ω–¥)
```bash
# –í Replit Secrets:
UNI_FARMING_INTERVAL_MODE=true  # –í–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
```

#### **–®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ workflow** (30 —Å–µ–∫—É–Ω–¥)
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –û–¢–ö–ê–¢

### **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç (30 —Å–µ–∫—É–Ω–¥):**
```bash
# –í Replit Secrets –∏–∑–º–µ–Ω–∏—Ç—å:
UNI_FARMING_INTERVAL_MODE=false  # –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É
```

### **–ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç (2 –º–∏–Ω—É—Ç—ã):**
```typescript
// –û—Ç–∫–∞—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É 54 –æ–±—Ä–∞—Ç–Ω–æ –∫:
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

### **–ù–∏–∫–∞–∫–∏—Ö —Ä–∏—Å–∫–æ–≤:**
- ‚úÖ –ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
- ‚úÖ –ù–ï –º–µ–Ω—è–µ—Ç—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–ï –º–µ–Ω—è—é—Ç—Å—è –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏
- ‚úÖ –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è TON Boost
- ‚úÖ –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏

---

## üìà –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### **–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø—Ä–æ–±–ª–µ–º–∞):**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç 12 —á–∞—Å–æ–≤
- –ù–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è 144 –ø–µ—Ä–∏–æ–¥–∞ (12 √ó 12)
- –ü–æ–ª—É—á–∞–µ—Ç: **144 √ó 0.003472% = 0.5%** —Å—Ä–∞–∑—É!

### **–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª—é–±–æ–µ –≤—Ä–µ–º—è
- –í—Å–µ–≥–¥–∞ —Ç–æ–ª—å–∫–æ 1 –ø–µ—Ä–∏–æ–¥
- –ü–æ–ª—É—á–∞–µ—Ç: **1 √ó 0.003472% = 0.003472%** –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª
- **–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 1% –Ω–∞ 288 –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤**

---

## üîß –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï –í–ê–†–ò–ê–ù–¢–´

### **–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π (–í–∞—Ä–∏–∞–Ω—Ç 1):**
```typescript
const effectivePeriods = 1; // –ü—Ä–æ—Å—Ç–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å
```
**–ü–ª—é—Å—ã:** –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç  
**–ú–∏–Ω—É—Å—ã:** –°–ª–æ–∂–Ω–µ–µ –æ—Ç–∫–∞—Ç–∏—Ç—å (–Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å —Å—Ç–∞—Ä—É—é —Ñ–æ—Ä–º—É–ª—É)

### **–° –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è:**
```typescript
const effectivePeriods = Math.min(periods, 1); // –ú–∞–∫—Å–∏–º—É–º 1 –ø–µ—Ä–∏–æ–¥
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–æ—Ç –∂–µ —ç—Ñ—Ñ–µ–∫—Ç, –¥—Ä—É–≥–∞—è –∑–∞–ø–∏—Å—å

### **–° –ª–∏–º–∏—Ç–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
```typescript
const maxMinutes = 10; // –ú–∞–∫—Å–∏–º—É–º 10 –º–∏–Ω—É—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è
const cappedPeriods = Math.floor(Math.min(minutesSinceLastUpdate, maxMinutes) / 5);
const effectivePeriods = Math.max(cappedPeriods, 1);
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ–±–æ–ª—å—à–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –ø—Ä–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–æ—Å—Ç–æ—è—Ö

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**–ü–†–ò–ú–ï–ù–ò–¢–¨ –í–ê–†–ò–ê–ù–¢ 2:**
1. ‚úÖ –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞ (+ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞)
2. ‚úÖ –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. ‚úÖ –ù—É–ª–µ–≤—ã–µ —Ä–∏—Å–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã
4. ‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
- `core/farming/UnifiedFarmingCalculator.ts` - 1 —Å—Ç—Ä–æ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- Replit Secrets - 1 –Ω–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

**–í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** 2-3 –º–∏–Ω—É—Ç—ã  
**–í—Ä–µ–º—è –æ—Ç–∫–∞—Ç–∞:** 30 —Å–µ–∫—É–Ω–¥  
**–†–∏—Å–∫–∏:** –ù–£–õ–ï–í–´–ï  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–µ–Ω–∞, UNI Farming —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ –∫–∞–∫ TON Boost