# ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–û–õ–ù–û–ì–û –†–ï–°–¢–ê–†–¢–ê –°–ò–°–¢–ï–ú–´

## üîÑ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –≠–¢–ê–ü–´ –û–ß–ò–°–¢–ö–ò

### 1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:
- ‚úÖ tsx server/index.ts –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã
- ‚úÖ npm/node –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã  
- ‚úÖ typescript-language-server –∑–∞–≤–µ—Ä—à–µ–Ω
- ‚úÖ –ü–æ—Ä—Ç—ã 3000, 5000, 8080 –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω—ã

### 2. –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π:
- ‚úÖ node_modules/.cache/* –æ—á–∏—â–µ–Ω–æ
- ‚úÖ /tmp/unifarm-* —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã
- ‚úÖ /tmp/websocket-* —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã
- ‚úÖ TypeScript –∫–µ—à–∏ —Å–±—Ä–æ—à–µ–Ω—ã

### 3. –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (—Ç–æ–ª—å–∫–æ LSP —Å–µ—Ä–≤–µ—Ä—ã):
```
PID 106: typescript-language-server (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å)
PID 117: tsserver.js partialSemantic (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å)  
PID 118: tsserver.js (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å)
PID 131: typingsInstaller (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å)
```

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ô –®–∞–ì: –ü–û–õ–ù–´–ô –†–ï–°–¢–ê–†–¢

### –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ä–µ—Å—Ç–∞—Ä—Ç–∞:
```bash
restart_workflow "Start application"
```

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–û–°–õ–ï –†–ï–°–¢–ê–†–¢–ê

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –±–∞–ª–∞–Ω—Å—ã –∏–∑ –ë–î
- TON –¥–µ–ø–æ–∑–∏—Ç—ã –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞—á–∏—Å–ª—è—Ç—å—Å—è (—Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
- –ù–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:
- –í—Å–µ activeConnections Map –æ—á–∏—â–µ–Ω–∞
- –ù–æ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ legacy –¥–∞–Ω–Ω—ã—Ö
- Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 3. Frontend —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- React Query –∫–µ—à –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—à–µ–Ω
- localStorage –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–±–Ω–æ–≤–∏—Ç—Å—è
- TonConnect —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è

### 4. Backend —Å–µ—Ä–≤–∏—Å—ã:
- BalanceManager —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- UnifiedTransactionService –∞–∫—Ç–∏–≤–µ–Ω
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ –∑–∞–ø—É—Å—Ç—è—Ç—Å—è —Å —á–∏—Å—Ç—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–í–ï–†–ö–ò –ü–û–°–õ–ï –†–ï–°–¢–ê–†–¢–ê

### –í –ø–µ—Ä–≤—ã–µ 5 –º–∏–Ω—É—Ç:
1. **TON –¥–µ–ø–æ–∑–∏—Ç—ã –∑–∞—á–∏—Å–ª—è—é—Ç—Å—è** - –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
2. **–ë–∞–ª–∞–Ω—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∞–∫—Ç—É–∞–ª—å–Ω—ã** –∏–∑ –ë–î
3. **WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
4. **–ù–µ—Ç –æ—à–∏–±–æ–∫ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** –≤ –∫–æ–Ω—Å–æ–ª–∏

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π TON –¥–µ–ø–æ–∑–∏—Ç ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–æ–≤
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ farming –¥–æ—Ö–æ–¥—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É referral system

## üìä –°–¢–ê–¢–£–° –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ù–´–• –§–£–ù–ö–¶–ò–ô

### ‚úÖ –ì–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞:
- `UnifiedTransactionService.updateUserBalance()` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- `BalanceManager Math.max –∑–∞—â–∏—Ç–∞` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞  
- –û–±—Ä–∞–±–æ—Ç–∫–∞ TON_DEPOSIT, FARMING_REWARD, REFERRAL_REWARD
- –í—Å–µ —Ç–∏–ø—ã –¥–æ—Ö–æ–¥–æ–≤ –∏ –∑–∞—á–∏—Å–ª–µ–Ω–∏–π

### ‚ùå –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã:
- `TransactionEnforcer` –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- `recalculateUserBalance` —Å –±–∞–≥–∞–º–∏
- `BatchBalanceProcessor` –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –§—É–Ω–∫—Ü–∏–∏ —Å rollback –ø—Ä–æ–±–ª–µ–º–∞–º–∏

## üéâ –§–ò–ù–ê–õ–¨–ù–ê–Ø –¶–ï–õ–¨

**–ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –¥–æ 29.07.2025, –Ω–æ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö rollback –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤.**

–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç:
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è TON –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –±–∞–ª–∞–Ω—Å—ã –∏–∑ –ë–î
- –°—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∞–≥–æ–≤
- –ü–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤