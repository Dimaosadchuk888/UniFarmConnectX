‚ö†Ô∏è  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217
[dotenv@17.2.0] injecting env (1) from .env (tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' })

=== –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´ –ó–ê–ö–ï–®–ò–†–û–í–ê–ù–ù–´–• JWT –¢–û–ö–ï–ù–û–í ===

–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: 2025-08-06T09:05:00.109Z
---------------------------------------------------

1. –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò –° –ù–ï–£–î–ê–ß–ù–´–ú–ò –î–ï–ü–û–ó–ò–¢–ê–ú–ò (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 48 —á–∞—Å–æ–≤):

–ù–µ—É–¥–∞—á–Ω—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

2. –ù–ï–ê–ö–¢–ò–í–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò (>24 —á–∞—Å–∞):


3. –ê–ù–ê–õ–ò–ó –ú–ï–•–ê–ù–ò–ó–ú–û–í –û–ë–ù–û–í–õ–ï–ù–ò–Ø –¢–û–ö–ï–ù–û–í:

‚úÖ –†–ê–ë–û–¢–ê–Æ–©–ò–ï –ú–ï–•–ê–ù–ò–ó–ú–´:
  1. useJwtTokenWatcher - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
  2. tokenRecoveryService:
     - attemptTokenRefresh() - 3 –ø–æ–ø—ã—Ç–∫–∏ —á–µ—Ä–µ–∑ /api/auth/refresh
     - attemptNewTokenCreation() - 3 –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —á–µ—Ä–µ–∑ Telegram initData
  3. DepositRecoveryService - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤
  4. criticalOperationGuard - –∑–∞—â–∏—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

‚ùå –í–´–Ø–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
  1. –ò–°–ü–†–ê–í–õ–ï–ù–û: JWT refresh –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª /api/v2/auth/refresh ‚Üí /api/auth/refresh ‚úÖ
  2. Telegram WebApp –∫–µ—à–∏—Ä—É–µ—Ç localStorage –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
  3. –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞ (TTL=24h) refresh –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å
  4. –ù–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞ Telegram

4. –¢–ò–ü–û–í–´–ï –°–¶–ï–ù–ê–†–ò–ò –ü–†–û–ë–õ–ï–ú:

üì± –°–¶–ï–ù–ê–†–ò–ô 1: "–î–æ–ª–≥–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ"
  –°–∏–º–ø—Ç–æ–º—ã:
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ö–æ–¥–∏–ª >24 —á–∞—Å–∞
  - JWT —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫
  - –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤–∏–¥–∏—Ç –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
  - Telegram –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –∏–∑ –∫–µ—à–∞
  - /api/auth/refresh –Ω–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–µ–∫—à–∏–π —Ç–æ–∫–µ–Ω
  - attemptNewTokenCreation() –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —á–µ—Ä–µ–∑ initData

üì± –°–¶–ï–ù–ê–†–ò–ô 2: "–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤"
  –°–∏–º–ø—Ç–æ–º—ã:
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É Telegram –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
  - –í–∏–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –æ—à–∏–±–∫–∏
  –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
  - localStorage —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
  - –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π, –Ω–æ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ user_id

üì± –°–¶–ï–ù–ê–†–ò–ô 3: "Telegram –∫–µ—à"
  –°–∏–º–ø—Ç–æ–º—ã:
  - –°–ª—É—á–∞–π–Ω—ã–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - –î–µ–ø–æ–∑–∏—Ç—ã –∏–Ω–æ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç, –∏–Ω–æ–≥–¥–∞ –Ω–µ—Ç
  –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
  - Telegram –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –∫–µ—à–∏—Ä—É–µ—Ç WebView
  - localStorage —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
  - initData –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –Ω–æ —Ç–æ–∫–µ–Ω –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π

5. –ü–†–û–í–ï–†–ö–ê –ö–û–ù–ö–†–ï–¢–ù–´–• ID (–µ—Å–ª–∏ –µ—Å—Ç—å –∂–∞–ª–æ–±—ã):


6. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞):

–î–õ–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô –° –ü–†–û–ë–õ–ï–ú–ê–ú–ò:
  1. –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã—Ç—å Telegram (—Å–≤–∞–π–ø –≤–≤–µ—Ä—Ö –Ω–∞ iOS/Android)
  2. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à Telegram:
     iOS: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–∞–Ω–Ω—ã–µ –∏ –ø–∞–º—è—Ç—å ‚Üí –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à
     Android: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–∞–Ω–Ω—ã–µ –∏ –ø–∞–º—è—Ç—å ‚Üí –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à
  3. –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ @UniFarming_Bot

–¢–ï–ö–£–©–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (—É–∂–µ –≤–Ω–µ–¥—Ä–µ–Ω—ã):
  ‚úÖ JWT refresh endpoint –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
  ‚úÖ DepositRecoveryService –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–µ–ø–æ–∑–∏—Ç—ã
  ‚úÖ TokenRecoveryService –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ initData

–ß–¢–û –î–û–õ–ñ–ù–û –ü–†–û–ò–°–•–û–î–ò–¢–¨ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò:
  1. –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞
  2. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - 3 –ø–æ–ø—ã—Ç–∫–∏ refresh + 3 –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ
  3. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —Å—Ç–∞—Ä—à–µ 25 –º–∏–Ω—É—Ç - –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  4. –ù–µ—É–¥–∞—á–Ω—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫

=== –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù ===

