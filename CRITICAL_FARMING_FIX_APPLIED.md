# ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ù–ê–ö–û–ü–ò–¢–ï–õ–¨–ù–û–ô –õ–û–ì–ò–ö–ò –ü–†–ò–ú–ï–ù–ï–ù–û

**–î–∞—Ç–∞:** 22 –∏—é–ª—è 2025  
**–í—Ä–µ–º—è:** 09:13 UTC  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í–û –ö –ê–ö–¢–ò–í–ê–¶–ò–ò  

---

## üîß –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í–ù–ï–°–ï–ù–´

### **–§–∞–π–ª:** `core/farming/UnifiedFarmingCalculator.ts`

#### **–°—Ç—Ä–æ–∫–∏ 56-58 (–±—ã–ª–æ):**
```typescript
// –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è: –º–∞–∫—Å–∏–º—É–º 24 —á–∞—Å–∞
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

#### **–°—Ç—Ä–æ–∫–∏ 56-58 (—Å—Ç–∞–ª–æ):**
```typescript
// –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è: –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–º –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–º —Ä–µ–∂–∏–º–æ–º
const useIntervalMode = process.env.UNI_FARMING_INTERVAL_MODE === 'true';
const effectivePeriods = useIntervalMode ? 1 : Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

#### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —É–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ç—Ä–æ–∫–∏ 87-97):**
```typescript
logger.info('[UnifiedFarmingCalculator] Income calculated', {
  userId: farmer.user_id || farmer.id,
  depositAmount,
  rate,
  periods: effectivePeriods,
  amount: finalAmount,
  lastUpdate: lastUpdate.toISOString(),
  now: now.toISOString(),
  mode: useIntervalMode ? 'INTERVAL' : 'ACCUMULATIVE',  // –ù–û–í–û–ï
  originalPeriods: periods  // –ù–û–í–û–ï
});
```

---

## ‚öôÔ∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–ò–°–¢–ï–ú–û–ô

### **–ê–∫—Ç–∏–≤–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞:**
```bash
# –í Replit Secrets –¥–æ–±–∞–≤–∏—Ç—å:
UNI_FARMING_INTERVAL_MODE=true
```

### **–û—Ç–∫–∞—Ç –∫ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—É:**
```bash
# –í Replit Secrets –∏–∑–º–µ–Ω–∏—Ç—å:
UNI_FARMING_INTERVAL_MODE=false
```

### **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞):**
- –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### **–í –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (–ë–´–õ–û):**
- –ü—Ä–æ—Å—Ç–æ–π 12 —á–∞—Å–æ–≤ = 144 –ø–µ—Ä–∏–æ–¥–∞
- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ: **144 √ó 0.003472% = 0.5%** —Å—Ä–∞–∑—É
- –†–∏—Å–∫ –ø–µ—Ä–µ–ø–ª–∞—Ç –¥–æ 100x

### **–í –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (–ë–£–î–ï–¢):**
- –õ—é–±–æ–π –ø—Ä–æ—Å—Ç–æ–π = 1 –ø–µ—Ä–∏–æ–¥
- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ: **1 √ó 0.003472% = 0.003472%** –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª
- –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 1% –Ω–∞ 288 –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤

---

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ 1 —Ñ–∞–π–ª –∑–∞—Ç—Ä–æ–Ω—É—Ç
- ‚úÖ 3 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–æ
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–∏–º–∞
- ‚úÖ –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏

### **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç:**
- 30 —Å–µ–∫—É–Ω–¥ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
- 2 –º–∏–Ω—É—Ç—ã —á–µ—Ä–µ–∑ –æ—Ç–∫–∞—Ç –∫–æ–¥–∞

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∂–∏–º: `INTERVAL` –∏–ª–∏ `ACCUMULATIVE`
- –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `originalPeriods` vs `effectivePeriods`

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```
   UNI_FARMING_INTERVAL_MODE=true
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å workflow** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏** –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç** —á–µ—Ä–µ–∑ 5-10 –º–∏–Ω—É—Ç

---

## üìà –ö–û–ù–¢–†–û–õ–¨ –ö–ê–ß–ï–°–¢–í–ê

### **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `mode: INTERVAL`
- ‚úÖ `effectivePeriods` –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–Ω–æ 1
- ‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ ~0.57 UNI –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–æ–ª—å—à–∏—Ö —Å–∫–∞—á–∫–æ–≤ –±–∞–ª–∞–Ω—Å–∞

### **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–±–ª–µ–º:**
- ‚ùå –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `mode: ACCUMULATIVE` (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é)
- ‚ùå `effectivePeriods` –±–æ–ª—å—à–µ 1 (—Ñ–ª–∞–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚ùå –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –±–æ–ª—å—à–µ 10 UNI –∑–∞ —Ä–∞–∑ (–æ—Ç–∫–∞—Ç!)

---

## üîÑ –ü–õ–ê–ù –û–¢–ö–ê–¢–ê

### **–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫:**

#### **–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç (30 —Å–µ–∫):**
```bash
UNI_FARMING_INTERVAL_MODE=false
```

#### **–ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç (2 –º–∏–Ω):**
```typescript
// –í UnifiedFarmingCalculator.ts —Å—Ç—Ä–æ–∫–∏ 56-58 –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:
const effectivePeriods = Math.min(periods, this.MAX_ALLOWED_PERIODS);
```

---

## ‚úÖ –ì–û–¢–û–í–û –ö –ê–ö–¢–ò–í–ê–¶–ò–ò

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—é –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º. –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±—É–¥–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∞ –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –î–æ–±–∞–≤–∏—Ç—å `UNI_FARMING_INTERVAL_MODE=true` –≤ Replit Secrets.