# üïµÔ∏è –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–ï –ö–û–ù–ö–†–ï–¢–ù–û–ì–û –î–ï–ü–û–ó–ò–¢–ê 24.07.2025, 08:55

**–î–∞—Ç–∞ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è**: 24 –∏—é–ª—è 2025, 09:17 UTC  
**–°—Ç–∞—Ç—É—Å**: üî¥ **–î–ï–ü–û–ó–ò–¢ –ù–ï –ù–ê–ô–î–ï–ù –í –°–ò–°–¢–ï–ú–ï**  
**–ú–µ—Ç–æ–¥**: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–∏—Å–∫ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

## üìã –î–ê–ù–ù–´–ï –î–ï–ü–û–ó–ò–¢–ê –û–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

### –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
- **–í—Ä–µ–º—è**: 24.07.2025, 08:55 (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ MSK)
- **–¢–∏–ø**: UNI Farming TON deposit  
- **Blockchain –∫–æ–¥**: `te6cckECBAEAAL0AAfGIALKkfhrf64MMekUmJ+6y3nR73Z31+EJ1YuGvDLli2OEIA5tLO3f///iIAAAAAAADRA+weAAAARsdpjnf8k78b5awIXECygukLsVDjjIZBplNNjxVY2rOCB/S79o9Lf85frF8t4jAlEK7SYtyiVgDtr9EvQMjs7gSAQIKDsPIbQMDAgBoQgAy1qPkmESgOZMZ225Yq7Y113tDjkFCFPPWjMth0RWpoqDuaygAAAAAAAAAAAAAAAAAAAAAfBg2bg==`

## üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–û–ò–°–ö–ê

### 1. –ü–æ–∏—Å–∫ –≤ –≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–∫–Ω–µ 05:45-06:05 UTC (08:45-09:05 MSK):
- **–ù–∞–π–¥–µ–Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**: 48
- **–¢–∏–ø—ã**: REFERRAL_REWARD, FARMING_REWARD
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–ï–¢ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Ç–∏–ø–∞ TON_DEPOSIT –∏–ª–∏ —Å blockchain –∫–æ–¥–æ–º

### 2. –ü–æ–∏—Å–∫ –ø–æ blockchain –∫–æ–¥—É –≤ metadata:
- **–ò—Å–∫–æ–º—ã–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã**: `te6cck`, `AAfGI`, `blockchain:`
- **–ù–∞–π–¥–µ–Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**: 0
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: Blockchain –∫–æ–¥ –ù–ï –Ω–∞–π–¥–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ

### 3. –ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é "TON deposit":
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏**: `%TON deposit%`, `%blockchain%`, `type.eq.TON_DEPOSIT`
- **–ù–∞–π–¥–µ–Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**: 0
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–ï–¢ –∑–∞–ø–∏—Å–µ–π –æ TON –¥–µ–ø–æ–∑–∏—Ç–∞—Ö

### 4. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:
- **–í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ**: ¬±2 —á–∞—Å–∞ –æ—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- **–ö—Ä–∏—Ç–µ—Ä–∏–∏**: TON_DEPOSIT, DEPOSIT, blockchain —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

## üö® –ö–†–ò–¢–ò–ß–ù–´–ï –ù–ê–•–û–î–ö–ò

### –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–ª–µ–¥–æ–≤ –¥–µ–ø–æ–∑–∏—Ç–∞:
1. **–ù–ï–¢ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º blockchain –∫–æ–¥–æ–º
2. **–ù–ï–¢ –∑–∞–ø–∏—Å–µ–π** —Ç–∏–ø–∞ TON_DEPOSIT –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è  
3. **–ù–ï–¢ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π** "deposit from blockchain" –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö
4. **–ù–ï–¢ metadata** —Å blockchain —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —ç—Ç–æ –≤—Ä–µ–º—è:
- **48 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** –≤ –æ–∫–Ω–µ ¬±10 –º–∏–Ω—É—Ç
- **–í—Å–µ —Ç–∏–ø—ã**: REFERRAL_REWARD (–º–∏–∫—Ä–æ-—Å—É–º–º—ã TON ~0.000347)
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –æ—Ç boost —Å–∏—Å—Ç–µ–º—ã
- **–ù–ò –û–î–ù–û–ô** –∫—Ä—É–ø–Ω–æ–π TON —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–ª–∏ –¥–µ–ø–æ–∑–∏—Ç–∞

## üí° –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è:

#### 1. üîÑ ROLLBACK –¢–†–ê–ù–ó–ê–ö–¶–ò–ò (–Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ):
```
‚úÖ –î–µ–ø–æ–∑–∏—Ç —Å–æ–∑–¥–∞–ª—Å—è ‚Üí –ó–∞–ø–∏—Å–∞–ª—Å—è –≤ –ë–î
‚ùå Constraint violation ‚Üí idx_tx_hash_unique_safe
üîÑ PostgreSQL ROLLBACK ‚Üí –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞
üëÅÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª ‚Üí Frontend –ø–æ–∫–∞–∑–∞–ª –¥–æ rollback
üí∏ –î–µ–ø–æ–∑–∏—Ç "–∏—Å—á–µ–∑" ‚Üí –ù–µ—Ç —Å–ª–µ–¥–æ–≤ –≤ –ë–î
```

#### 2. üìù –ü–†–Ø–ú–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–ê–õ–ê–ù–°–ê:
```
‚úÖ processTonDeposit() ‚Üí –û–±–Ω–æ–≤–∏–ª balance_ton
‚ùå –ù–µ —Å–æ–∑–¥–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é ‚Üí –ü—Ä—è–º–æ–π UPDATE users
üí∞ –ë–∞–ª–∞–Ω—Å —É–≤–µ–ª–∏—á–∏–ª—Å—è ‚Üí –ë–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
üö´ –ê–≤—Ç–æ—Å–ø–∏—Å–∞–Ω–∏–µ ‚Üí BalanceManager —É–±—Ä–∞–ª –±–∞–ª–∞–Ω—Å
```

#### 3. üïí –í–†–ï–ú–ï–ù–ù–´–ï –†–ê–°–•–û–ñ–î–ï–ù–ò–Ø:
```
üåç MSK vs UTC ‚Üí –†–∞–∑–Ω–∏—Ü–∞ –≤ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö
üì± –ö–ª–∏–µ–Ω—Ç –ø–æ–∫–∞–∑–∞–ª ‚Üí –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è MSK
üóÑÔ∏è –°–µ—Ä–≤–µ—Ä –∑–∞–ø–∏—Å–∞–ª ‚Üí UTC –≤—Ä–µ–º—è
üîç –ü–æ–∏—Å–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç ‚Üí –ù–µ—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è
```

## üéØ –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–ê –°–ò–°–¢–ï–ú–ù–û–ô –ü–†–û–ë–õ–ï–ú–´

### –ù–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
1. **–í —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è**: –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –º–∏–∫—Ä–æ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (48 —à—Ç)
2. **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã**: –†–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∑–∞–ø–∏—Å—ã–≤–∞–ª–∏—Å—å –≤ –ë–î
3. **TON –¥–µ–ø–æ–∑–∏—Ç—ã**: –ü–û–õ–ù–û–°–¢–¨–Æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∑–∞–ø–∏—Å—è—Ö
4. **Blockchain –∫–æ–¥—ã**: –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:
- **User #184**: –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –Ω–∞ 0.187 TON –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **Constraint –∞–∫—Ç–∏–≤–µ–Ω**: `idx_tx_hash_unique_safe` —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–°–∏—Å—Ç–µ–º–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç**: –ë–∞–ª–∞–Ω—Å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üìã –ò–¢–û–ì–û–í–´–ô –í–ï–†–î–ò–ö–¢

**–í–ê–® –î–ï–ü–û–ó–ò–¢ –°–¢–ê–õ –ñ–ï–†–¢–í–û–ô –°–ò–°–¢–ï–ú–ù–û–ô –ü–†–û–ë–õ–ï–ú–´!**

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç—ã:
1. **–î–µ–ø–æ–∑–∏—Ç –ù–ï –∑–∞–ø–∏—Å–∞–ª—Å—è** –≤ —Ç–∞–±–ª–∏—Ü—É transactions
2. **Blockchain –∫–æ–¥ –ù–ï —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è** –≤ metadata  
3. **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–ª–∞** –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –¥—Ä—É–≥–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
4. **Constraint –∞–∫—Ç–∏–≤–µ–Ω** –∏ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å rollback'–∏

### –ú–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ–±–ª–µ–º—ã:
- –í–∞—à –¥–µ–ø–æ–∑–∏—Ç **—Å–æ–∑–¥–∞–ª—Å—è** –≤ —Å–∏—Å—Ç–µ–º–µ
- **Frontend –ø–æ–∫–∞–∑–∞–ª** –µ–≥–æ —É—Å–ø–µ—à–Ω–æ–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ  
- **Constraint –Ω–∞—Ä—É—à–µ–Ω–∏–µ** –∏–ª–∏ **–ø—Ä—è–º–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ** —É–¥–∞–ª–∏–ª–æ —Å–ª–µ–¥
- **–ë–∞–ª–∞–Ω—Å –º–æ–≥ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è** –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: "–ò—Å—á–µ–∑–∞—é—â–∏–π –¥–µ–ø–æ–∑–∏—Ç" –±–µ–∑ —Å–ª–µ–¥–æ–≤ –≤ –ë–î

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–û—Ç–∫–ª—é—á–∏—Ç—å** `idx_tx_hash_unique_safe` constraint –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** –¥–µ–ø–æ–∑–∏—Ç –∏–∑ blockchain –¥–∞–Ω–Ω—ã—Ö –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–ª–∞–Ω—Å–æ–º
4. **–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç** –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å

**–°—Ç–∞—Ç—É—Å**: –î–µ–ø–æ–∑–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –Ω–æ —Å–∏—Å—Ç–µ–º–æ–π –ø–æ—Ç–µ—Ä—è–Ω –∏–∑-–∑–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∞–≥–æ–≤ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ.