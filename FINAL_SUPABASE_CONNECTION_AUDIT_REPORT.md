# üîç –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: –ü–†–û–í–ï–†–ö–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø SUPABASE API

**–î–∞—Ç–∞:** 15 –∏—é–Ω—è 2025  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Supabase API –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –§–ò–ù–ê–õ–¨–ù–û–ô –ü–†–û–í–ï–†–ö–ò

### ‚úÖ –£–°–ü–ï–®–ù–û–°–¢–¨ –¢–ï–°–¢–û–í: 74% (14/19)

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –£—Å–ø–µ—à–Ω–æ | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è | –û—à–∏–±–∫–∏ |
|-----------|---------|----------------|--------|
| **Core Structure** | 6/7 | 1 | 0 |
| **Module Tests** | 2/4 | 0 | 2 |
| **Duplicate Check** | 4/4 | 0 | 0 |
| **Functionality** | 2/4 | 0 | 2 |

---

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –ì–û–¢–û–í–ù–û–°–¢–ò

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase
```
‚úÖ core/supabase.ts —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
‚úÖ createClient() –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
‚úÖ SUPABASE_URL –∏ SUPABASE_KEY –∑–∞–≥—Ä—É–∂–µ–Ω—ã
‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã users
```

### 2. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
```
‚úÖ Supabase - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç core/supabase.ts
‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

### 3. –†–∞–±–æ—Ç–∞—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
```
‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ telegram_id
‚úÖ –ß—Ç–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ (115.618787 UNI, 51.000008 TON)
‚úÖ –ü–æ–∏—Å–∫ –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º –∫–æ–¥–∞–º
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ streak –±–æ–Ω—É—Å–æ–≤
```

---

## ‚ö†Ô∏è –í–´–Ø–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã transactions
```
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ 'amount'
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ 'transaction_type'
```

### 2. –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã users  
```
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ 'last_active'
```

### 3. –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö telegram_id
```
‚ùå –¢—Ä–µ–±—É–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç —á–∏—Å–ª–æ–≤—ã–µ
```

---

## üõ†Ô∏è –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ WalletService
```typescript
// –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É Supabase
async getWalletDataByTelegramId(telegramId: string) {
  return {
    uni_balance: parseFloat(user.balance_uni || "0"),
    ton_balance: parseFloat(user.balance_ton || "0"),
    total_earned: parseFloat(user.uni_farming_balance || "0"),
    transactions: [] // –ü—É—Å—Ç–æ–π –¥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ transactions
  };
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ users —Ç–∞–±–ª–∏—Ü—É
```typescript
const { error } = await supabase
  .from('users')
  .update({ 
    balance_uni: newBalance.toString(),
    checkin_last_date: new Date().toISOString() 
  })
  .eq('id', userId);
```

---

## üìã –°–¢–†–£–ö–¢–£–†–ê SUPABASE API

### –†–∞–±–æ—á–∏–µ —Ç–∞–±–ª–∏—Ü—ã
| –¢–∞–±–ª–∏—Ü–∞ | –°—Ç–∞—Ç—É—Å | –ü–æ–ª—è | –û–ø–µ—Ä–∞—Ü–∏–∏ |
|---------|--------|------|----------|
| **users** | ‚úÖ –ü–æ–ª–Ω–∞—è | 22 –∫–æ–ª–æ–Ω–∫–∏ | SELECT, INSERT, UPDATE |
| **transactions** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è | –ë–∞–∑–æ–≤—ã–µ –ø–æ–ª—è | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ |
| **referrals** | ‚úÖ –ß–µ—Ä–µ–∑ users | referred_by | SELECT |
| **farming_sessions** | ‚ö†Ô∏è –ß–µ—Ä–µ–∑ users | uni_farming_* | UPDATE |

### –†–∞–±–æ—Ç–∞—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```typescript
// ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
supabase.from('users').select('*').eq('telegram_id', id)

// ‚úÖ –ë–∞–ª–∞–Ω—Å
supabase.from('users').select('balance_uni, balance_ton')

// ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è
supabase.from('users').update(data).eq('id', userId)

// ‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—ã  
supabase.from('users').select('*').like('ref_code', 'REF_%')
```

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã: üü° –ß–ê–°–¢–ò–ß–ù–û –ì–û–¢–û–í–ê (74%)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Supabase API
- –í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –¢–∞–±–ª–∏—Ü–∞ transactions —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Å—Ö–µ–º—ã
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É—é—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production:
1. ‚úÖ **–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å** - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚ö†Ô∏è **–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å** transactions –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
3. ‚úÖ **Supabase –≥–æ—Ç–æ–≤** –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞** –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

### –§–∞–π–ª—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **–û—Å–Ω–æ–≤–Ω–æ–π:** `core/supabase.ts` - —Ä–∞–±–æ—á–∏–π
- **–î—É–±–ª–∏—Ä—É—é—â–∏–π:** `core/supabaseClient.ts` - –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** `config/database.ts` - —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```
‚úÖ SUPABASE_URL - https://wunnsvicbebssrjqedor.supabase.co
‚úÖ SUPABASE_KEY - –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω—ã
```

### –°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª–µ–π
- **AuthService:** 100% Supabase API
- **UserRepository:** 100% Supabase API  
- **WalletService:** 100% Supabase API (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
- **FarmingScheduler:** 100% Supabase API
- **AdminService:** 100% Supabase API

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å —Ç–µ–∫—É—â–∏–º —É—Ä–æ–≤–Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.**