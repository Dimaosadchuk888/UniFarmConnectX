# üîß –û–¢–ß–ï–¢ –ü–ï–†–ï–ü–†–û–í–ï–†–ö–ò –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò TON-–î–ï–ü–û–ó–ò–¢–ê
üìÖ –î–∞—Ç–∞: 19 –∏—é–ª—è 2025, 17:25 –ú–°–ö  
üéØ –°—Ç–∞—Ç—É—Å: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ö–û–î–ê  
‚ö†Ô∏è –¶–µ–ª—å: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–≤–æ–¥–æ–≤ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–ª–∞–Ω–∞ —Ä–µ—à–µ–Ω–∏—è

---

## üìå –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï –ü–†–û–í–ï–†–ö–ò

### ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:

1. **üìå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ TON-–Ω–æ–¥–µ: –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**
   - üìà –ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª: –ù–ï–¢ –∏–º–ø–æ—Ä—Ç–æ–≤ TonClient, TonWeb, TonAPI
   - üìà –ù–ï–¢ –≤—ã–∑–æ–≤–æ–≤ emulateExternalMessage() –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
   - üìà –ù–ï–¢ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ TON blockchain network

2. **üìå –õ–æ–∂–Ω–∞—è —ç–º—É–ª—è—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û** 
   - üìà –§—É–Ω–∫—Ü–∏—è `emulateTonTransaction()` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - üìà –ù–ï–¢ –≤—ã–∑–æ–≤–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ API —ç–º—É–ª—è—Ü–∏–∏ blockchain
   - üìà –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true` –ø–æ—Å–ª–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

3. **üìå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è: –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**
   - üìà –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ gas (0.01 TON) –≤ –∫–æ—à–µ–ª—å–∫–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
   - üìà –ù–ï–¢ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ TON API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ wallet

4. **üìå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è: –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**
   - üìà –§—É–Ω–∫—Ü–∏—è `isValidTonAddress()` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
   - üìà –ù–ï–¢ –∑–∞–ø—Ä–æ—Å–∞ –∫ blockchain –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞

---

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó

### 1. –ê–ù–ê–õ–ò–ó –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö TON-–ù–û–î–ï

**–†–ï–ó–£–õ–¨–¢–ê–¢: ‚ùå –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –û–¢–°–£–¢–°–¢–í–£–ï–¢**

```typescript
// –ù–ê–ô–î–ï–ù–û –≤ client/src/services/tonConnectService.ts:
// - –ò–º–ø–æ—Ä—Ç—ã: TonConnectUI, TonConnect (UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
// - –ù–ï –ù–ê–ô–î–ï–ù–û: TonClient, TonWeb, TonApiClient
// - –ù–ï –ù–ê–ô–î–ï–ù–û: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ mainnet/testnet –Ω–æ–¥–µ
```

### 2. –ê–ù–ê–õ–ò–ó –≠–ú–£–õ–Ø–¶–ò–ò –¢–†–ê–ù–ó–ê–ö–¶–ò–ô

**–†–ï–ó–£–õ–¨–¢–ê–¢: ‚ùå –õ–û–ñ–ù–ê–Ø –≠–ú–£–õ–Ø–¶–ò–Ø**

```typescript
// client/src/services/tonConnectService.ts:254-297
async function emulateTonTransaction(tonConnectUI: TonConnectUI, transaction: any): Promise<boolean> {
  // ‚ùå –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
  // - –ü—Ä–æ–≤–µ—Ä–∫–∞ messages[]
  // - –ü—Ä–æ–≤–µ—Ä–∫–∞ address (—Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
  // - –ü—Ä–æ–≤–µ—Ä–∫–∞ amount (NaN)
  // - –ü—Ä–æ–≤–µ—Ä–∫–∞ validUntil
  
  // ‚ùå –ù–ï–¢ –†–ï–ê–õ–¨–ù–û–ô –≠–ú–£–õ–Ø–¶–ò–ò:
  // - –ù–ï–¢ –≤—ã–∑–æ–≤–∞ tonClient.runGetMethod()
  // - –ù–ï–¢ emulateExternalMessage()
  // - –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ gas_limit
  // - –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ contract state
  
  return true; // ‚ùå –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—Ö
}
```

### 3. –ê–ù–ê–õ–ò–ó –ü–†–û–í–ï–†–ö–ò –ë–ê–õ–ê–ù–°–ê

**–†–ï–ó–£–õ–¨–¢–ê–¢: ‚ùå –ü–†–û–í–ï–†–ö–ê –ë–ê–õ–ê–ù–°–ê –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–ê**

```typescript
// client/src/components/wallet/TonDepositCard.tsx:
// ‚ùå –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ:
// - isConnected (–ø–æ–¥–∫–ª—é—á–µ–Ω –ª–∏ –∫–æ—à–µ–ª–µ–∫)
// - amount > 0.1 (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–µ–ø–æ–∑–∏—Ç–∞)

// ‚ùå –ù–ï –ü–†–û–í–ï–†–Ø–ï–¢–°–Ø:
// - –ë–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
// - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è gas (0.01+ TON)
// - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ –≤ blockchain
```

### 4. –ê–ù–ê–õ–ò–ó –í–ê–õ–ò–î–ê–¶–ò–ò –ê–î–†–ï–°–ê

**–†–ï–ó–£–õ–¨–¢–ê–¢: ‚ùå –¢–û–õ–¨–ö–û –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê**

```typescript
// modules/wallet/controller.ts:54-65
private async isValidTonAddress(address: string): Promise<boolean> {
  // ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ @ton/core
  const parsed = Address.parse(address);
  
  // ‚ùå –ù–ï–¢ –ü–†–û–í–ï–†–ö–ò –í BLOCKCHAIN:
  // - –ù–ï–¢ –∑–∞–ø—Ä–æ—Å–∞ –∫ TON API
  // - –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞
  // - –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
}
```

---

## üîß –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–´–ô –ü–õ–ê–ù –†–ï–®–ï–ù–ò–Ø

### –í–ê–†–ò–ê–ù–¢ 1: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° TONAPI
```typescript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º—É TON API
import { TonApiClient } from '@ton-api/client';

const tonAPI = new TonApiClient({
  baseUrl: 'https://tonapi.io',
  apiKey: process.env.TON_API_KEY
});

async function realEmulateTransaction(transaction) {
  // –†–µ–∞–ª—å–Ω–∞—è —ç–º—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ TON API
  const result = await tonAPI.emulateMessageToWallet({
    boc: transaction.boc
  });
  return result.success;
}
```

### –í–ê–†–ò–ê–ù–¢ 2: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° TON-WEB
```typescript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TonWeb
import TonWeb from 'tonweb';

const tonweb = new TonWeb(new TonWeb.HttpProvider('https://toncenter.com/api/v2/jsonRPC'));

async function checkWalletBalance(address: string) {
  const balance = await tonweb.getBalance(address);
  return TonWeb.utils.fromNano(balance);
}
```

### –í–ê–†–ò–ê–ù–¢ 3: –ü–†–Ø–ú–ê–Ø –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° @TON/TON
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ @ton/ton
import { TonClient, WalletContractV4, Address } from '@ton/ton';

const client = new TonClient({
  endpoint: 'https://toncenter.com/api/v2/jsonRPC'
});

async function emulateTransaction(transaction) {
  const result = await client.emulateTransaction(transaction);
  return result.success;
}
```

---

## üìã –¢–†–ï–ë–£–ï–ú–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –£–°–¢–ê–ù–û–í–ö–ê –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô
```bash
npm install @ton/ton tonapi-sdk-js
# –∏–ª–∏
npm install tonweb @ton-community/ton-api-client
```

### 2. –ü–†–û–í–ï–†–ö–ò –î–õ–Ø –í–ù–ï–î–†–ï–ù–ò–Ø

**A. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è:**
```typescript
async function checkSenderBalance(address: string, requiredAmount: string): Promise<boolean> {
  const balance = await getTonBalance(address);
  const required = parseFloat(requiredAmount) + 0.01; // +gas
  return parseFloat(balance) >= required;
}
```

**B. –≠–º—É–ª—è—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:**
```typescript
async function realEmulateTransaction(transaction: any): Promise<{success: boolean, error?: string}> {
  const result = await tonClient.emulateTransaction(transaction);
  return {
    success: result.success,
    error: result.error?.message
  };
}
```

**C. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–∞:**
```typescript
async function checkAddressActive(address: string): Promise<boolean> {
  const state = await tonClient.getAddressState(address);
  return state.state === 'active';
}
```

---

## ‚è≥ –û–¶–ï–ù–ö–ê –í–†–ï–ú–ï–ù–ò –í–ù–ï–î–†–ï–ù–ò–Ø

- **üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è TON API**: 2-3 —á–∞—Å–∞
- **üîß –†–µ–∞–ª—å–Ω–∞—è —ç–º—É–ª—è—Ü–∏—è**: 1-2 —á–∞—Å–∞  
- **üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–æ–≤**: 1 —á–∞—Å
- **üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: 2-3 —á–∞—Å–∞
- **üìä –ò–¢–û–ì–û**: 6-9 —á–∞—Å–æ–≤

---

## üö® –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

**‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê**: –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ TON blockchain –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –∏–º–∏—Ç–∞—Ü–∏—é —ç–º—É–ª—è—Ü–∏–∏.

**‚ö†Ô∏è –£–†–û–í–ï–ù–¨ –ì–û–¢–û–í–ù–û–°–¢–ò**: 15% (—Ç–æ–ª—å–∫–æ UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

**üéØ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–û–ï –†–ï–®–ï–ù–ò–ï**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TonAPI –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π —ç–º—É–ª—è—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

---

*–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω: 19 –∏—é–ª—è 2025, 17:25 –ú–°–ö*  
*–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤ –∫ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—é –ø–ª–∞–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π*