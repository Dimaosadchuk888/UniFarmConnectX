# üéØ –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–´–ô –î–ò–ê–ì–ù–û–ó: User #25 TON –¥–µ–ø–æ–∑–∏—Ç

**–°—Ç–∞—Ç—É—Å:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞  

## üìä –ö–õ–Æ–ß–ï–í–´–ï –§–ê–ö–¢–´

### 1. Environment Analysis
- **–¢–µ–∫—É—â–µ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:** Replit Preview (development)
- **Database:** Supabase (—Å–æ–≥–ª–∞—Å–Ω–æ .env.example –∏ core/supabase.ts)
- **–ê–∫—Ç–∏–≤–Ω—ã–π User:** ID 184 (—Ç–µ—Å—Ç–æ–≤—ã–π, ref_code: REF_1752755835358_yjrusv)
- **–ü—Ä–æ–±–ª–µ–º–Ω—ã–π User:** ID 25 (production, ref_code: REF_1750079004411_nddfp2)

### 2. Database Configuration
```
–ò–∑ .env.example:
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_KEY=your-supabase-anon-key-here

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç: core/supabase.ts –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
```

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Results
- **User 25 –≤ –ª–æ–≥–∞—Ö:** –ù–ï –ù–ê–ô–î–ï–ù ‚ùå
- **Ref_code REF_1750079004411_nddfp2:** –ù–ï –ù–ê–ô–î–ï–ù ‚ùå  
- **Hash —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:** –ù–∞–π–¥–µ–Ω —Ç–æ–ª—å–∫–æ –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–∞—Ö

## üîç –¢–û–ß–ö–ê –†–ê–ó–†–´–í–ê –õ–û–ö–ê–õ–ò–ó–û–í–ê–ù–ê

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—á–∞—Å—Ç–æ–∫: `modules/wallet/controller.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** API endpoint `/api/v2/wallet/balance?user_id=25` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ User

```typescript
// –û–∂–∏–¥–∞–µ–º—ã–π flow –¥–ª—è User #25:
1. Frontend ‚Üí GET /api/v2/wallet/balance?user_id=25
2. WalletController.getBalance() ‚Üí –ø–æ–∏—Å–∫ User #25 –≤ –ë–î
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: User NOT FOUND ‚Üí 404/error response  
4. Frontend ‚Üí balanceService –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
5. UI ‚Üí –±–∞–ª–∞–Ω—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```

### –¶–µ–ø–æ—á–∫–∞ —Ä–∞–∑—Ä—ã–≤–∞:
```
‚úÖ TON –¥–µ–ø–æ–∑–∏—Ç —É—Å–ø–µ—à–µ–Ω (Production blockchain)
‚úÖ –ê–¥–º–∏–Ω –ø–æ–ª—É—á–∏–ª —Å—Ä–µ–¥—Å—Ç–≤–∞ (Production backend) 
‚ùå User #25 –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢ –≤ Preview –ë–î
‚ùå API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –¥–ª—è User #25
‚ùå Frontend –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–ª–∞–Ω—Å
‚ùå UI –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```

## üìã –ú–ï–¢–û–î–´/–§–ê–ô–õ–´ –ì–î–ï –ü–†–û–ò–°–•–û–î–ò–¢ –†–ê–ó–†–´–í

### 1. **modules/wallet/controller.ts** - getBalance()
```typescript
// –ö–æ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è balance –¥–ª—è User #25:
// User –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ Preview –ë–î ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç error
```

### 2. **client/src/services/balanceService.ts** - refreshBalance()
```typescript
// –ü–æ–ª—É—á–∞–µ—Ç 404/error –¥–ª—è User #25
// –ù–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –±–∞–ª–∞–Ω—Å–∞
```

### 3. **client/src/contexts/userContext.tsx** - refreshBalance()
```typescript
// SET_BALANCE action –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
// UI –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

## üéØ –ö–û–ù–ö–†–ï–¢–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –ß—Ç–æ –¥–æ–ª–∂–Ω–æ —Å—Ä–∞–±–æ—Ç–∞—Ç—å:
```
User #25 TON deposit (Production) ‚Üí
BalanceManager.addBalance() ‚Üí 
WebSocket notification ‚Üí
Frontend balance refresh ‚Üí
UI update
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏:
```
User #25 TON deposit (Production) ‚Üí ‚úÖ
User #25 –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢ (Preview –ë–î) ‚Üí ‚ùå
API error for User #25 ‚Üí ‚ùå  
No balance data ‚Üí ‚ùå
No UI update ‚Üí ‚ùå
```

## üí° –†–ï–®–ï–ù–ò–ï (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞)

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. **–£–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º URL** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–µ Preview domain)
2. **–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞** browser (localStorage, sessionStorage)
3. **–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Production environment**

### –î–ª—è —Å–∏—Å—Ç–µ–º—ã:
1. **User #25 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ç–æ–π –∂–µ –ë–î** —á—Ç–æ –∏ frontend
2. **Environment sync** –º–µ–∂–¥—É backend –∏ frontend
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å production –ë–î** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ User #25

## üìÑ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê:** User #25 –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–µ–∫—É—â–µ–π –ë–î (Preview environment), –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –¥–µ–ø–æ–∑–∏—Ç –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω –≤ Production environment.

**–§–ê–ô–õ/–ú–ï–¢–û–î –†–ê–ó–†–´–í–ê:** `modules/wallet/controller.ts` ‚Üí getBalance() –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ User #25

**–¢–ò–ü –ü–†–û–ë–õ–ï–ú–´:** Environment mismatch, –Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∫–æ–¥–∞

**–°–¢–ê–¢–£–°:** ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ç–æ—á–∫–∞ —Ä–∞–∑—Ä—ã–≤–∞ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞